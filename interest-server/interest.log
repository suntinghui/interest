2019-11-20 14:57:53.291  INFO 95128 --- [restartedMain] com.interest.WhSpringBootApplication     : No active profile set, falling back to default profiles: default
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleCommentDao' and 'com.interest.dao.master.ArticleCommentDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleDao' and 'com.interest.dao.master.ArticleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'emailDao' and 'com.interest.dao.master.EmailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'interestDao' and 'com.interest.dao.master.InterestDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'menuDao' and 'com.interest.dao.master.MenuDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'msgRecordsDao' and 'com.interest.dao.master.MsgRecordsDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'postCardDao' and 'com.interest.dao.master.PostCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'relationDao' and 'com.interest.dao.master.RelationDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'replyCardDao' and 'com.interest.dao.master.ReplyCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'roleDao' and 'com.interest.dao.master.RoleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDao' and 'com.interest.dao.master.UserDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDetailDao' and 'com.interest.dao.master.UserDetailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userGithubDao' and 'com.interest.dao.master.UserGithubDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userQQDao' and 'com.interest.dao.master.UserQQDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowDjqdatjDao' and 'com.interest.dao.rainbow.RainbowDjqdatjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowKcqktjDao' and 'com.interest.dao.rainbow.RainbowKcqktjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowParamDao' and 'com.interest.dao.rainbow.RainbowParamDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRbbxhDao' and 'com.interest.dao.rainbow.RainbowRbbxhDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRxstjDao' and 'com.interest.dao.rainbow.RainbowRxstjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowSrtjDao' and 'com.interest.dao.rainbow.RainbowSrtjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:54.898  WARN 95128 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowYjzbDao' and 'com.interest.dao.rainbow.RainbowYjzbDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:57:55.460  INFO 95128 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2019-11-20 14:57:55.460  INFO 95128 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.
2019-11-20 14:57:55.569  INFO 95128 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 94ms. Found 0 repository interfaces.
2019-11-20 14:57:56.162  INFO 95128 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ceed9656-147b-39fe-b78a-60d556f9d2a8
2019-11-20 14:57:56.521  INFO 95128 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$791a66f9] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 14:57:56.786  INFO 95128 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$953469f6] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 14:57:57.441 ERROR 95128 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 14:57:57.784  INFO 95128 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8812 (http)
2019-11-20 14:57:57.800 ERROR 95128 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 14:57:57.815  INFO 95128 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-11-20 14:57:57.815  INFO 95128 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/9.0.12
2019-11-20 14:57:57.831 ERROR 95128 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 14:57:58.049  INFO 95128 --- [restartedMain] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring embedded WebApplicationContext
2019-11-20 14:57:58.049  INFO 95128 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 4726 ms
2019-11-20 14:57:59.017  WARN 95128 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'masterDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 14:57:59.344  WARN 95128 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'rainbowDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'webMvcMetricsFilter' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'formContentFilter' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] .s.DelegatingFilterProxyRegistrationBean : Mapping filter: 'springSecurityFilterChain' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpTraceFilter' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'corsFilter' to: [/*]
2019-11-20 14:57:59.812  INFO 95128 --- [restartedMain] o.s.b.w.servlet.ServletRegistrationBean  : Servlet dispatcherServlet mapped to [/]
2019-11-20 14:58:00.514  INFO 95128 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2019-11-20 14:58:01.466  WARN 95128 --- [restartedMain] o.s.s.o.p.t.s.JwtAccessTokenConverter    : Unable to create an RSA verifier from verifierKey (ignoreable if using MAC)
2019-11-20 14:58:02.449  INFO 95128 --- [restartedMain] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2019-11-20 14:58:02.636  INFO 95128 --- [restartedMain] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2019-11-20 14:58:03.197  INFO 95128 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: OrRequestMatcher [requestMatchers=[Ant [pattern='/oauth/token'], Ant [pattern='/oauth/token_key'], Ant [pattern='/oauth/check_token']]], [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1d8bab3e, org.springframework.security.web.context.SecurityContextPersistenceFilter@13d8e93c, org.springframework.security.web.header.HeaderWriterFilter@7759d097, org.springframework.security.web.authentication.logout.LogoutFilter@63b89715, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@790c03da, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@690fd415, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7985ded3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@215f0453, org.springframework.security.web.session.SessionManagementFilter@4a0c4286, org.springframework.security.web.access.ExceptionTranslationFilter@530ed77c, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@bc5c3cf]
2019-11-20 14:58:03.213  INFO 95128 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfiguration$NotOAuthRequestMatcher@4abd6a0f, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@63a6367, org.springframework.security.web.context.SecurityContextPersistenceFilter@674ec7f5, org.springframework.security.web.header.HeaderWriterFilter@3cc22418, org.springframework.web.filter.CorsFilter@2e94f7d0, org.springframework.security.web.authentication.logout.LogoutFilter@327f7c8e, org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter@3ebdd348, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@779fd559, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5ad0cd56, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@8471c8d, org.springframework.security.web.session.SessionManagementFilter@86c057f, org.springframework.security.web.access.ExceptionTranslationFilter@7c3d9f8a, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@22bc79c3]
2019-11-20 14:58:03.229  INFO 95128 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3861167a, org.springframework.security.web.context.SecurityContextPersistenceFilter@3a8f061b, org.springframework.security.web.header.HeaderWriterFilter@7f1d67c8, org.springframework.security.web.authentication.logout.LogoutFilter@69aad5c, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@4ed39f6b, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@68d7969c, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@1c4e9e28, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@c27abc8, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1890bea3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4e34720d, org.springframework.security.web.session.SessionManagementFilter@601214b1, org.springframework.security.web.access.ExceptionTranslationFilter@6e3b14a6, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@6ea9444a]
2019-11-20 14:58:03.634  INFO 95128 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2019-11-20 14:58:03.931  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Loaded jar:file:/C:/Users/SunTH/.m2/repository/com/atomikos/transactions/4.0.6/transactions-4.0.6.jar!/transactions-defaults.properties
2019-11-20 14:58:03.931  WARN 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Thanks for using Atomikos! Evaluate http://www.atomikos.com/Main/ExtremeTransactions for advanced features and professional support
or register at http://www.atomikos.com/Main/RegisterYourDownload to disable this message and receive FREE tips & advice
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_max_wait_time_on_shutdown = 9223372036854775807
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.allow_subtransactions = true
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.recovery_delay = 10000
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.automatic_resource_registration = true
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_max_retries = 5
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.client_demarcation = false
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.threaded_2pc = false
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.serial_jta_transactions = true
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_dir = E:\workspace\javaEE\interest\interest-server\transaction-logs
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.rmi_export_class = none
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_actives = 50
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.checkpoint_interval = 500
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.enable_logging = true
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_name = tmlog
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_timeout = 300000
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.trust_client_tm = false
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.factory.initial = com.sun.jndi.rmi.registry.RegistryContextFactory
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.tm_unique_name = 192.168.1.31.tm
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.forget_orphaned_log_entries_delay = 86400000
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_retry_interval = 10000
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.provider.url = rmi://localhost:1099
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.force_shutdown_on_vm_exit = false
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_jta_timeout = 10000
2019-11-20 14:58:03.946  INFO 95128 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Using default (local) logging and recovery...
2019-11-20 14:58:04.071  INFO 95128 --- [restartedMain] c.a.d.xa.XATransactionalResource         : masterDataSource: refreshed XAResource
2019-11-20 14:58:04.165  INFO 95128 --- [restartedMain] c.a.d.xa.XATransactionalResource         : rainbowDataSource: refreshed XAResource
2019-11-20 14:58:04.711  INFO 95128 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService 'taskScheduler'
2019-11-20 14:58:05.584  INFO 95128 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2019-11-20 14:58:05.771  INFO 95128 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2019-11-20 14:58:05.865  INFO 95128 --- [restartedMain] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2019-11-20 14:58:06.271  INFO 95128 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: getArticleUsingGET_1
2019-11-20 14:58:06.364  INFO 95128 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadPictureUsingPOST_1
2019-11-20 14:58:06.458  INFO 95128 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_1
2019-11-20 14:58:06.583  INFO 95128 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_2
2019-11-20 14:58:06.707 ERROR 95128 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 14:58:06.707 ERROR 95128 --- [restartedMain] org.apache.catalina.util.LifecycleBase   : Failed to start component [Connector[HTTP/1.1-8812]]

org.apache.catalina.LifecycleException: Protocol handler start failed
	at org.apache.catalina.connector.Connector.startInternal(Connector.java:960) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardService.addConnector(StandardService.java:225) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.addPreviouslyRemovedConnectors(TomcatWebServer.java:259) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.start(TomcatWebServer.java:197) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.startWebServer(ServletWebServerApplicationContext.java:300) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.finishRefresh(ServletWebServerApplicationContext.java:162) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549) [spring-context-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:140) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:775) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:316) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1260) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1248) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at com.interest.WhSpringBootApplication.main(WhSpringBootApplication.java:21) [classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) [spring-boot-devtools-2.1.0.RELEASE.jar:2.1.0.RELEASE]
Caused by: java.net.BindException: Address already in use: bind
	at sun.nio.ch.Net.bind0(Native Method) ~[na:1.8.0_151]
	at sun.nio.ch.Net.bind(Net.java:433) ~[na:1.8.0_151]
	at sun.nio.ch.Net.bind(Net.java:425) ~[na:1.8.0_151]
	at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:223) ~[na:1.8.0_151]
	at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74) ~[na:1.8.0_151]
	at org.apache.tomcat.util.net.NioEndpoint.initServerSocket(NioEndpoint.java:236) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.util.net.NioEndpoint.bind(NioEndpoint.java:210) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.util.net.AbstractEndpoint.start(AbstractEndpoint.java:1108) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.coyote.AbstractProtocol.start(AbstractProtocol.java:550) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.connector.Connector.startInternal(Connector.java:957) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	... 19 common frames omitted

2019-11-20 14:58:06.723  INFO 95128 --- [restartedMain] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2019-11-20 14:58:06.723  WARN 95128 --- [restartedMain] o.a.c.loader.WebappClassLoaderBase       : The web application [interest] appears to have started a thread named [lettuce-eventExecutorLoop-1-1] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 sun.misc.Unsafe.park(Native Method)
 java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)
 java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078)
 java.util.concurrent.LinkedBlockingQueue.poll(LinkedBlockingQueue.java:467)
 io.netty.util.concurrent.SingleThreadEventExecutor.takeTask(SingleThreadEventExecutor.java:251)
 io.netty.util.concurrent.DefaultEventExecutor.run(DefaultEventExecutor.java:64)
 io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
 io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
 java.lang.Thread.run(Thread.java:748)
2019-11-20 14:58:06.723  WARN 95128 --- [restartedMain] o.a.c.loader.WebappClassLoaderBase       : The web application [interest] appears to have started a thread named [Atomikos:1] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.lang.Object.wait(Native Method)
 com.atomikos.timing.PooledAlarmTimer.doWait(PooledAlarmTimer.java:105)
 com.atomikos.timing.PooledAlarmTimer.run(PooledAlarmTimer.java:71)
 java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
 java.lang.Thread.run(Thread.java:748)
2019-11-20 14:58:06.723  WARN 95128 --- [restartedMain] o.a.c.loader.WebappClassLoaderBase       : The web application [interest] appears to have started a thread named [Atomikos:2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.lang.Object.wait(Native Method)
 com.atomikos.timing.PooledAlarmTimer.doWait(PooledAlarmTimer.java:105)
 com.atomikos.timing.PooledAlarmTimer.run(PooledAlarmTimer.java:71)
 java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
 java.lang.Thread.run(Thread.java:748)
2019-11-20 14:58:06.739  INFO 95128 --- [restartedMain] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2019-11-20 14:58:06.739 ERROR 95128 --- [restartedMain] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The Tomcat connector configured to listen on port 8812 failed to start. The port may already be in use or the connector may be misconfigured.

Action:

Verify the connector's configuration, identify and stop any process that's listening on port 8812, or configure this application to listen on another port.

2019-11-20 14:58:06.785  INFO 95128 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Shutting down ExecutorService 'taskScheduler'
2019-11-20 14:58:06.801  INFO 95128 --- [restartedMain] c.a.icatch.imp.TransactionServiceImp     : Transaction Service: Entering shutdown (false, 9223372036854775807)...
2019-11-20 14:58:06.817  INFO 95128 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2019-11-20 14:58:06.817  INFO 95128 --- [restartedMain] c.a.datasource.pool.ConnectionPool       : atomikos connection pool 'rainbowDataSource': destroying pool...
2019-11-20 14:58:06.817  INFO 95128 --- [restartedMain] c.a.datasource.pool.ConnectionPool       : atomikos connection pool 'masterDataSource': destroying pool...
2019-11-20 14:58:41.759  INFO 91484 --- [restartedMain] com.interest.WhSpringBootApplication     : No active profile set, falling back to default profiles: default
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleCommentDao' and 'com.interest.dao.master.ArticleCommentDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleDao' and 'com.interest.dao.master.ArticleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'emailDao' and 'com.interest.dao.master.EmailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'interestDao' and 'com.interest.dao.master.InterestDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'menuDao' and 'com.interest.dao.master.MenuDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'msgRecordsDao' and 'com.interest.dao.master.MsgRecordsDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'postCardDao' and 'com.interest.dao.master.PostCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'relationDao' and 'com.interest.dao.master.RelationDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'replyCardDao' and 'com.interest.dao.master.ReplyCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'roleDao' and 'com.interest.dao.master.RoleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDao' and 'com.interest.dao.master.UserDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDetailDao' and 'com.interest.dao.master.UserDetailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userGithubDao' and 'com.interest.dao.master.UserGithubDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userQQDao' and 'com.interest.dao.master.UserQQDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowDjqdatjDao' and 'com.interest.dao.rainbow.RainbowDjqdatjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowKcqktjDao' and 'com.interest.dao.rainbow.RainbowKcqktjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowParamDao' and 'com.interest.dao.rainbow.RainbowParamDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRbbxhDao' and 'com.interest.dao.rainbow.RainbowRbbxhDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRxstjDao' and 'com.interest.dao.rainbow.RainbowRxstjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowSrtjDao' and 'com.interest.dao.rainbow.RainbowSrtjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.308  WARN 91484 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowYjzbDao' and 'com.interest.dao.rainbow.RainbowYjzbDao' mapperInterface. Bean already defined with the same name!
2019-11-20 14:58:43.869  INFO 91484 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2019-11-20 14:58:43.869  INFO 91484 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.
2019-11-20 14:58:43.963  INFO 91484 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 78ms. Found 0 repository interfaces.
2019-11-20 14:58:44.493  INFO 91484 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ceed9656-147b-39fe-b78a-60d556f9d2a8
2019-11-20 14:58:44.868  INFO 91484 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$8cc57e54] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 14:58:45.183  INFO 91484 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$a8df8151] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 14:58:45.810 ERROR 91484 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 14:58:46.184  INFO 91484 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8812 (http)
2019-11-20 14:58:46.200 ERROR 91484 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 14:58:46.215  INFO 91484 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-11-20 14:58:46.215  INFO 91484 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/9.0.12
2019-11-20 14:58:46.231 ERROR 91484 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 14:58:46.480  INFO 91484 --- [restartedMain] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring embedded WebApplicationContext
2019-11-20 14:58:46.480  INFO 91484 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 4690 ms
2019-11-20 14:58:47.403  WARN 91484 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'masterDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 14:58:47.699  WARN 91484 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'rainbowDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 14:58:48.167  INFO 91484 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'webMvcMetricsFilter' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'formContentFilter' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] .s.DelegatingFilterProxyRegistrationBean : Mapping filter: 'springSecurityFilterChain' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpTraceFilter' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'corsFilter' to: [/*]
2019-11-20 14:58:48.183  INFO 91484 --- [restartedMain] o.s.b.w.servlet.ServletRegistrationBean  : Servlet dispatcherServlet mapped to [/]
2019-11-20 14:58:48.777  INFO 91484 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2019-11-20 14:58:49.556  WARN 91484 --- [restartedMain] o.s.s.o.p.t.s.JwtAccessTokenConverter    : Unable to create an RSA verifier from verifierKey (ignoreable if using MAC)
2019-11-20 14:58:50.523  INFO 91484 --- [restartedMain] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2019-11-20 14:58:50.679  INFO 91484 --- [restartedMain] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2019-11-20 14:58:51.178  INFO 91484 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: OrRequestMatcher [requestMatchers=[Ant [pattern='/oauth/token'], Ant [pattern='/oauth/token_key'], Ant [pattern='/oauth/check_token']]], [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@22fbb686, org.springframework.security.web.context.SecurityContextPersistenceFilter@16cac2f9, org.springframework.security.web.header.HeaderWriterFilter@69688415, org.springframework.security.web.authentication.logout.LogoutFilter@61ca7ca4, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@705117e2, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@224d92e4, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@557822fc, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@53d257c7, org.springframework.security.web.session.SessionManagementFilter@6896e5e4, org.springframework.security.web.access.ExceptionTranslationFilter@7a5c315e, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@312ade8c]
2019-11-20 14:58:51.194  INFO 91484 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfiguration$NotOAuthRequestMatcher@1909fb69, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@78911b59, org.springframework.security.web.context.SecurityContextPersistenceFilter@2079b29d, org.springframework.security.web.header.HeaderWriterFilter@1041c589, org.springframework.web.filter.CorsFilter@4f3d215e, org.springframework.security.web.authentication.logout.LogoutFilter@6e7e6526, org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter@63abf17a, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@39267d3e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@27558a1e, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@66683005, org.springframework.security.web.session.SessionManagementFilter@2bec41cb, org.springframework.security.web.access.ExceptionTranslationFilter@41eb05a1, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@47083826]
2019-11-20 14:58:51.210  INFO 91484 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@a8d2441, org.springframework.security.web.context.SecurityContextPersistenceFilter@1180352, org.springframework.security.web.header.HeaderWriterFilter@bba9f75, org.springframework.security.web.authentication.logout.LogoutFilter@23d401f8, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@193c3c84, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@4e0d0a89, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@1bdfbb13, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1a4b164a, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@45556341, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@637f7cf0, org.springframework.security.web.session.SessionManagementFilter@6c1b250, org.springframework.security.web.access.ExceptionTranslationFilter@236d66, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@58293d4e]
2019-11-20 14:58:51.584  INFO 91484 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2019-11-20 14:58:51.865  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Loaded jar:file:/C:/Users/SunTH/.m2/repository/com/atomikos/transactions/4.0.6/transactions-4.0.6.jar!/transactions-defaults.properties
2019-11-20 14:58:51.865  WARN 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Thanks for using Atomikos! Evaluate http://www.atomikos.com/Main/ExtremeTransactions for advanced features and professional support
or register at http://www.atomikos.com/Main/RegisterYourDownload to disable this message and receive FREE tips & advice
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_max_wait_time_on_shutdown = 9223372036854775807
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.allow_subtransactions = true
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.recovery_delay = 10000
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.automatic_resource_registration = true
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_max_retries = 5
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.client_demarcation = false
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.threaded_2pc = false
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.serial_jta_transactions = true
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_dir = E:\workspace\javaEE\interest\interest-server\transaction-logs
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.rmi_export_class = none
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_actives = 50
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.checkpoint_interval = 500
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.enable_logging = true
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_name = tmlog
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_timeout = 300000
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.trust_client_tm = false
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.factory.initial = com.sun.jndi.rmi.registry.RegistryContextFactory
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.tm_unique_name = 192.168.1.31.tm
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.forget_orphaned_log_entries_delay = 86400000
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_retry_interval = 10000
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.provider.url = rmi://localhost:1099
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.force_shutdown_on_vm_exit = false
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_jta_timeout = 10000
2019-11-20 14:58:51.880  INFO 91484 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Using default (local) logging and recovery...
2019-11-20 14:58:51.974  INFO 91484 --- [restartedMain] c.a.d.xa.XATransactionalResource         : masterDataSource: refreshed XAResource
2019-11-20 14:58:52.068  INFO 91484 --- [restartedMain] c.a.d.xa.XATransactionalResource         : rainbowDataSource: refreshed XAResource
2019-11-20 14:58:52.582  INFO 91484 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService 'taskScheduler'
2019-11-20 14:58:53.316  INFO 91484 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2019-11-20 14:58:53.347  INFO 91484 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2019-11-20 14:58:53.440  INFO 91484 --- [restartedMain] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2019-11-20 14:58:53.674  INFO 91484 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: getArticleUsingGET_1
2019-11-20 14:58:53.768  INFO 91484 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadPictureUsingPOST_1
2019-11-20 14:58:53.830  INFO 91484 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_1
2019-11-20 14:58:53.955  INFO 91484 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_2
2019-11-20 14:58:54.080  INFO 91484 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8812 (http) with context path '/interest'
2019-11-20 14:58:54.080  INFO 91484 --- [restartedMain] com.interest.WhSpringBootApplication     : Started WhSpringBootApplication in 14.071 seconds (JVM running for 15.091)
2019-11-20 15:01:19.501  INFO 91484 --- [http-nio-8812-exec-9] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring DispatcherServlet 'dispatcherServlet'
2019-11-20 15:01:19.501  INFO 91484 --- [http-nio-8812-exec-9] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2019-11-20 15:01:19.519  INFO 91484 --- [http-nio-8812-exec-9] o.s.web.servlet.DispatcherServlet        : Completed initialization in 18 ms
2019-11-20 15:01:21.128  INFO 91484 --- [http-nio-8812-exec-9] io.lettuce.core.EpollProvider            : Starting without optional epoll library
2019-11-20 15:01:21.128  INFO 91484 --- [http-nio-8812-exec-9] io.lettuce.core.KqueueProvider           : Starting without optional kqueue library
2019-11-20 15:01:23.226  INFO 91484 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.sys.MenuController|menuList], request param: []
2019-11-20 15:01:23.226  INFO 91484 --- [http-nio-8812-exec-10] c.i.a.handler.InterestLogAspect          : [com.interest.controller.sys.UserController|userGet], request param: []
2019-11-20 15:01:23.441  INFO 91484 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.sys.MenuController|menuList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=7}
2019-11-20 15:01:23.503  INFO 91484 --- [http-nio-8812-exec-10] c.i.a.handler.InterestLogAspect          : [com.interest.controller.sys.UserController|userGet], request param: [], result : ResponseWrapper{status='2000', message='success', data=UserEntity(id=1, loginName=admin, name=管理员, password={bcrypt}$2a$10$D8E4cuanLviCCe/ASqBC7OZ84JYOH8IT4/y4JLAV/Pm/AdhzPcy2., usertype=1, email=595691924@qq.com, headimg=http://thirdqq.qlogo.cn/qqapp/101512648/1C47A2C639D3A89E573AC2BF46FBEF63/40, url=http://www.baidu.com, createTime=1531704654140, githubid=null, qqid=null)}
2019-11-20 15:01:25.372  INFO 91484 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: []
2019-11-20 15:01:25.376  INFO 91484 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: []
2019-11-20 15:01:25.385 DEBUG 91484 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.shopTypeList     : ==>  Preparing: select DICT_Value as paramKey,DICT_Name as paramValue from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' 
2019-11-20 15:01:25.398 DEBUG 91484 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.shopTypeList     : ==> Parameters: 
2019-11-20 15:01:25.417 DEBUG 91484 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.shopTypeList     : <==      Total: 14
2019-11-20 15:01:25.419  INFO 91484 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:01:25.419 DEBUG 91484 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.areaList   : ==>  Preparing: select DISTINCT SHOP_Area as paramKey, SHOP_Area as paramValue from study.t_shop_sub_info 
2019-11-20 15:01:25.420 DEBUG 91484 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.areaList   : ==> Parameters: 
2019-11-20 15:01:25.433 DEBUG 91484 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.areaList   : <==      Total: 14
2019-11-20 15:01:25.435  INFO 91484 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:01:25.681  INFO 91484 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: []
2019-11-20 15:01:25.682  INFO 91484 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: []
2019-11-20 15:01:25.682 DEBUG 91484 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.channelList      : ==>  Preparing: select DISTINCT ATOP_Uid as paramKey, ATOP_Title as paramValue from netfiance_db.t_shop_agent_top 
2019-11-20 15:01:25.683 DEBUG 91484 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.channelList      : ==> Parameters: 
2019-11-20 15:01:25.685  INFO 91484 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: []
2019-11-20 15:01:25.700  INFO 91484 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:01:25.896 DEBUG 91484 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.channelList      : <==      Total: 27
2019-11-20 15:01:25.897  INFO 91484 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=27}
2019-11-20 15:01:25.897 DEBUG 91484 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.deviceTypeList   : ==>  Preparing: select DISTINCT DDI_Type as paramKey , DDI_Type as paramValue from t_device_device_info 
2019-11-20 15:01:25.898 DEBUG 91484 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.deviceTypeList   : ==> Parameters: 
2019-11-20 15:01:25.908 DEBUG 91484 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.deviceTypeList   : <==      Total: 6
2019-11-20 15:01:25.909  INFO 91484 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=6}
2019-11-20 15:01:25.911 DEBUG 91484 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.shopList   : ==>  Preparing: select SHOP_No as paramKey, SHOP_Title as paramValue from netfiance_db.t_shop_shop_info 
2019-11-20 15:01:25.914 DEBUG 91484 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.shopList   : ==> Parameters: 
2019-11-20 15:01:25.957 DEBUG 91484 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.shopList   : <==      Total: 462
2019-11-20 15:01:25.958  INFO 91484 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=462}
2019-11-20 15:01:25.958 DEBUG 91484 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? limit ?,?; 
2019-11-20 15:01:25.960 DEBUG 91484 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 0(Integer), 10(Integer)
2019-11-20 15:01:26.213 DEBUG 91484 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 10
2019-11-20 15:01:26.216 DEBUG 91484 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:01:26.218 DEBUG 91484 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:01:26.256 DEBUG 91484 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:01:26.257  INFO 91484 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', totalCount=392, dataSize=10}
2019-11-20 15:01:27.922  INFO 91484 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"M3051500100043","shopValue":"10893","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:01:27.927 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:01:27.929 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:01:27.939 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:01:27.941 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:01:27.942 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 10893(String)
2019-11-20 15:01:28.154 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:01:28.156 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:01:28.159 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:01:28.481 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:01:28.484 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:01:28.488 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 10893(String), M3051500100043(String)
2019-11-20 15:01:28.510 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:01:28.512 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No 设备编号,first_sub.SHOP_No 网点编号,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:01:28.513 DEBUG 91484 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:01:28.641 ERROR 91484 --- [http-nio-8812-exec-8] o.a.c.c.C.[.[.[.[dispatcherServlet]      : Servlet.service() for servlet [dispatcherServlet] in context with path [/interest] threw exception [Request processing failed; nested exception is org.springframework.dao.DataIntegrityViolationException: 
### Error querying database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'DDI_No' in group statement is ambiguous
### The error may exist in file [E:\workspace\javaEE\interest\interest-server\target\classes\mybatis\mapper\rainbow\RainbowDjqdatjMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select first_sub.DDI_No 设备编号,first_sub.SHOP_No 网点编号,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数   from   (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type   from study.t_device_sub_info a left join t_device_device_info b   on a.DDI_No = b.DDI_No   left join netfiance_db.t_shop_shop_info d   on d.SHOP_No = a.SHOP_No   left join netfiance_db.t_shop_agent_list e   on d.SHOP_AGUid = e.AGNT_Uid   left join netfiance_db.t_shop_agent_top f   on e.AGNT_ATUid = f.ATOP_Uid   left join study.t_shop_sub_info g   on a.SHOP_No = g.SHOP_No   left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t   on t.DICT_Value = d.SHOP_Class   where a.DSI_Anti is null         and g.SHOP_No = ?            and a.DDI_No = ?                        #and b.DDI_Type = '{{设备类型}}'   #and f.ATOP_Title = {{选择渠道}}   #and a.DDI_No = '{{设备编码}}'   #and g.SHOP_Area = '{{ 所属地区 }}'   #and d.SHOP_No = '{{ 所属门店 }}'   #and t.DICT_Name = '{{ 网点类型 }}'   order by dt) first_sub             #每台机器在网点真实开启时间    left join    (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid   from t_shop_order_info e left join t_device_device_info b   on e.ODER_DUid = b.DDI_Uid   left join study.t_device_sub_info a   on b.DDI_No = a.DDI_No   where date(e.CreateDate)>=? and date(e.CreateDate) <=?   and e.ODER_State = 0   and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail   on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt    where first_sub.dt <=?   group by DDI_No,SHOP_No,启用时间
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'DDI_No' in group statement is ambiguous
; Column 'DDI_No' in group statement is ambiguous; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'DDI_No' in group statement is ambiguous] with root cause

java.sql.SQLIntegrityConstraintViolationException: Column 'DDI_No' in group statement is ambiguous
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:115) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:95) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:960) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:388) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.PreparedStatementWrapper.execute(PreparedStatementWrapper.java:535) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.4.6.jar:3.4.6]
	at com.sun.proxy.$Proxy230.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:63) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:79) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:63) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141) ~[mybatis-3.4.6.jar:3.4.6]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433) ~[mybatis-spring-1.3.2.jar:1.3.2]
	at com.sun.proxy.$Proxy129.selectList(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230) ~[mybatis-spring-1.3.2.jar:1.3.2]
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:139) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:76) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:59) ~[mybatis-3.4.6.jar:3.4.6]
	at com.sun.proxy.$Proxy140.yyzt3_jqhkzrs(Unknown Source) ~[na:na]
	at com.interest.service.impl.RainbowDjqdatjServiceImpl.jqsxxx_detail(RainbowDjqdatjServiceImpl.java:43) ~[classes/:na]
	at com.interest.controller.rainbow.RainbowDjqdatjController.jqsxxx_detail(RainbowDjqdatjController.java:49) ~[classes/:na]
	at com.interest.controller.rainbow.RainbowDjqdatjController$$FastClassBySpringCGLIB$$77a924f7.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at com.interest.annotation.handler.InterestLogAspect.printLog(InterestLogAspect.java:40) ~[classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.AspectJAfterThrowingAdvice.invoke(AspectJAfterThrowingAdvice.java:62) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at com.interest.controller.rainbow.RainbowDjqdatjController$$EnhancerBySpringCGLIB$$9550a4a6.jqsxxx_detail(<generated>) ~[classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:215) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:142) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:998) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:890) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:875) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.boot.actuate.web.trace.servlet.HttpTraceFilter.doFilterInternal(HttpTraceFilter.java:90) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:127) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:91) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:170) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(OAuth2AuthenticationProcessingFilter.java:176) ~[spring-security-oauth2-2.3.3.RELEASE.jar:na]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:66) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:357) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:270) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:154) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:122) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:107) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:770) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_151]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_151]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_151]

2019-11-20 15:03:52.688  INFO 96684 --- [restartedMain] com.interest.WhSpringBootApplication     : No active profile set, falling back to default profiles: default
2019-11-20 15:03:54.627  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleCommentDao' and 'com.interest.dao.master.ArticleCommentDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.627  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleDao' and 'com.interest.dao.master.ArticleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.627  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'emailDao' and 'com.interest.dao.master.EmailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.627  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'interestDao' and 'com.interest.dao.master.InterestDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.628  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'menuDao' and 'com.interest.dao.master.MenuDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.628  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'msgRecordsDao' and 'com.interest.dao.master.MsgRecordsDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.628  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'postCardDao' and 'com.interest.dao.master.PostCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.628  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'relationDao' and 'com.interest.dao.master.RelationDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.628  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'replyCardDao' and 'com.interest.dao.master.ReplyCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.628  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'roleDao' and 'com.interest.dao.master.RoleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.628  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDao' and 'com.interest.dao.master.UserDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDetailDao' and 'com.interest.dao.master.UserDetailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userGithubDao' and 'com.interest.dao.master.UserGithubDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userQQDao' and 'com.interest.dao.master.UserQQDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowDjqdatjDao' and 'com.interest.dao.rainbow.RainbowDjqdatjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowKcqktjDao' and 'com.interest.dao.rainbow.RainbowKcqktjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowParamDao' and 'com.interest.dao.rainbow.RainbowParamDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRbbxhDao' and 'com.interest.dao.rainbow.RainbowRbbxhDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.629  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRxstjDao' and 'com.interest.dao.rainbow.RainbowRxstjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.630  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowSrtjDao' and 'com.interest.dao.rainbow.RainbowSrtjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:54.630  WARN 96684 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowYjzbDao' and 'com.interest.dao.rainbow.RainbowYjzbDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:03:55.224  INFO 96684 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2019-11-20 15:03:55.227  INFO 96684 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.
2019-11-20 15:03:55.327  INFO 96684 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 83ms. Found 0 repository interfaces.
2019-11-20 15:03:56.012  INFO 96684 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ceed9656-147b-39fe-b78a-60d556f9d2a8
2019-11-20 15:03:56.458  INFO 96684 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$fb874198] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:03:56.733  INFO 96684 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$17a14495] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:03:57.374 ERROR 96684 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:03:57.728  INFO 96684 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8812 (http)
2019-11-20 15:03:57.744 ERROR 96684 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:03:57.755  INFO 96684 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-11-20 15:03:57.755  INFO 96684 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/9.0.12
2019-11-20 15:03:57.771 ERROR 96684 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:03:58.023  INFO 96684 --- [restartedMain] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring embedded WebApplicationContext
2019-11-20 15:03:58.023  INFO 96684 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 5311 ms
2019-11-20 15:03:59.102  WARN 96684 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'masterDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:03:59.435  WARN 96684 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'rainbowDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:03:59.928  INFO 96684 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2019-11-20 15:03:59.929  INFO 96684 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'webMvcMetricsFilter' to: [/*]
2019-11-20 15:03:59.929  INFO 96684 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2019-11-20 15:03:59.929  INFO 96684 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'formContentFilter' to: [/*]
2019-11-20 15:03:59.929  INFO 96684 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2019-11-20 15:03:59.930  INFO 96684 --- [restartedMain] .s.DelegatingFilterProxyRegistrationBean : Mapping filter: 'springSecurityFilterChain' to: [/*]
2019-11-20 15:03:59.930  INFO 96684 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpTraceFilter' to: [/*]
2019-11-20 15:03:59.930  INFO 96684 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'corsFilter' to: [/*]
2019-11-20 15:03:59.930  INFO 96684 --- [restartedMain] o.s.b.w.servlet.ServletRegistrationBean  : Servlet dispatcherServlet mapped to [/]
2019-11-20 15:04:00.680  INFO 96684 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2019-11-20 15:04:01.522  WARN 96684 --- [restartedMain] o.s.s.o.p.t.s.JwtAccessTokenConverter    : Unable to create an RSA verifier from verifierKey (ignoreable if using MAC)
2019-11-20 15:04:02.651  INFO 96684 --- [restartedMain] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2019-11-20 15:04:02.855  INFO 96684 --- [restartedMain] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2019-11-20 15:04:03.483  INFO 96684 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: OrRequestMatcher [requestMatchers=[Ant [pattern='/oauth/token'], Ant [pattern='/oauth/token_key'], Ant [pattern='/oauth/check_token']]], [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@737420dc, org.springframework.security.web.context.SecurityContextPersistenceFilter@1bf16595, org.springframework.security.web.header.HeaderWriterFilter@5047f873, org.springframework.security.web.authentication.logout.LogoutFilter@112df587, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@6d10d6f0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@495a7dd9, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@686151f6, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5050d704, org.springframework.security.web.session.SessionManagementFilter@5a0b673, org.springframework.security.web.access.ExceptionTranslationFilter@6f1a5fa1, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@123bf418]
2019-11-20 15:04:03.505  INFO 96684 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfiguration$NotOAuthRequestMatcher@392e3112, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6d182712, org.springframework.security.web.context.SecurityContextPersistenceFilter@768c6d43, org.springframework.security.web.header.HeaderWriterFilter@61393854, org.springframework.web.filter.CorsFilter@5da8e5a, org.springframework.security.web.authentication.logout.LogoutFilter@3d0dc3d6, org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter@6efb410e, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@fb4ad9f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2767dfa5, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2e75c4f5, org.springframework.security.web.session.SessionManagementFilter@207740e7, org.springframework.security.web.access.ExceptionTranslationFilter@31391f02, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@45c743f9]
2019-11-20 15:04:03.516  INFO 96684 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3cbf8ba0, org.springframework.security.web.context.SecurityContextPersistenceFilter@bb0d09f, org.springframework.security.web.header.HeaderWriterFilter@2a5d2d47, org.springframework.security.web.authentication.logout.LogoutFilter@7b7943e8, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@241eb76b, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@14e3c898, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@42055652, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2766dd3c, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6412fb82, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@13f10496, org.springframework.security.web.session.SessionManagementFilter@74f08e26, org.springframework.security.web.access.ExceptionTranslationFilter@538ffeb3, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@4477566b]
2019-11-20 15:04:03.970  INFO 96684 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2019-11-20 15:04:04.238  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Loaded jar:file:/C:/Users/SunTH/.m2/repository/com/atomikos/transactions/4.0.6/transactions-4.0.6.jar!/transactions-defaults.properties
2019-11-20 15:04:04.245  WARN 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Thanks for using Atomikos! Evaluate http://www.atomikos.com/Main/ExtremeTransactions for advanced features and professional support
or register at http://www.atomikos.com/Main/RegisterYourDownload to disable this message and receive FREE tips & advice
2019-11-20 15:04:04.254  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_max_wait_time_on_shutdown = 9223372036854775807
2019-11-20 15:04:04.254  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.allow_subtransactions = true
2019-11-20 15:04:04.254  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.recovery_delay = 10000
2019-11-20 15:04:04.255  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.automatic_resource_registration = true
2019-11-20 15:04:04.255  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_max_retries = 5
2019-11-20 15:04:04.255  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.client_demarcation = false
2019-11-20 15:04:04.255  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.threaded_2pc = false
2019-11-20 15:04:04.255  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.serial_jta_transactions = true
2019-11-20 15:04:04.255  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_dir = E:\workspace\javaEE\interest\interest-server\transaction-logs
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.rmi_export_class = none
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_actives = 50
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.checkpoint_interval = 500
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.enable_logging = true
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_name = tmlog
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_timeout = 300000
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.trust_client_tm = false
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.factory.initial = com.sun.jndi.rmi.registry.RegistryContextFactory
2019-11-20 15:04:04.256  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.tm_unique_name = 192.168.1.31.tm
2019-11-20 15:04:04.257  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.forget_orphaned_log_entries_delay = 86400000
2019-11-20 15:04:04.257  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_retry_interval = 10000
2019-11-20 15:04:04.257  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.provider.url = rmi://localhost:1099
2019-11-20 15:04:04.257  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.force_shutdown_on_vm_exit = false
2019-11-20 15:04:04.257  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_jta_timeout = 10000
2019-11-20 15:04:04.258  INFO 96684 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Using default (local) logging and recovery...
2019-11-20 15:04:04.358  INFO 96684 --- [restartedMain] c.a.d.xa.XATransactionalResource         : masterDataSource: refreshed XAResource
2019-11-20 15:04:04.454  INFO 96684 --- [restartedMain] c.a.d.xa.XATransactionalResource         : rainbowDataSource: refreshed XAResource
2019-11-20 15:04:05.153  INFO 96684 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService 'taskScheduler'
2019-11-20 15:04:05.951  INFO 96684 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2019-11-20 15:04:05.998  INFO 96684 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2019-11-20 15:04:06.081  INFO 96684 --- [restartedMain] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2019-11-20 15:04:06.359  INFO 96684 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: getArticleUsingGET_1
2019-11-20 15:04:06.445  INFO 96684 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadPictureUsingPOST_1
2019-11-20 15:04:06.523  INFO 96684 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_1
2019-11-20 15:04:06.693  INFO 96684 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_2
2019-11-20 15:04:06.821  INFO 96684 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8812 (http) with context path '/interest'
2019-11-20 15:04:06.824  INFO 96684 --- [restartedMain] com.interest.WhSpringBootApplication     : Started WhSpringBootApplication in 16.075 seconds (JVM running for 17.159)
2019-11-20 15:04:33.725  INFO 96684 --- [http-nio-8812-exec-3] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring DispatcherServlet 'dispatcherServlet'
2019-11-20 15:04:33.725  INFO 96684 --- [http-nio-8812-exec-3] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2019-11-20 15:04:33.754  INFO 96684 --- [http-nio-8812-exec-3] o.s.web.servlet.DispatcherServlet        : Completed initialization in 28 ms
2019-11-20 15:04:33.990  INFO 96684 --- [http-nio-8812-exec-3] io.lettuce.core.EpollProvider            : Starting without optional epoll library
2019-11-20 15:04:33.994  INFO 96684 --- [http-nio-8812-exec-3] io.lettuce.core.KqueueProvider           : Starting without optional kqueue library
2019-11-20 15:04:34.721  INFO 96684 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:04:34.721  INFO 96684 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: []
2019-11-20 15:04:34.721  INFO 96684 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: []
2019-11-20 15:04:34.721  INFO 96684 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: []
2019-11-20 15:04:34.727  INFO 96684 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: []
2019-11-20 15:04:34.727  INFO 96684 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: []
2019-11-20 15:04:34.801 DEBUG 96684 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowParamDao.shopList   : ==>  Preparing: select SHOP_No as paramKey, SHOP_Title as paramValue from netfiance_db.t_shop_shop_info 
2019-11-20 15:04:34.835 DEBUG 96684 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowParamDao.shopList   : ==> Parameters: 
2019-11-20 15:04:34.900 DEBUG 96684 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowParamDao.shopList   : <==      Total: 462
2019-11-20 15:04:34.904 DEBUG 96684 --- [http-nio-8812-exec-7] c.i.d.r.RainbowParamDao.channelList      : ==>  Preparing: select DISTINCT ATOP_Uid as paramKey, ATOP_Title as paramValue from netfiance_db.t_shop_agent_top 
2019-11-20 15:04:34.904  INFO 96684 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=462}
2019-11-20 15:04:34.904 DEBUG 96684 --- [http-nio-8812-exec-7] c.i.d.r.RainbowParamDao.channelList      : ==> Parameters: 
2019-11-20 15:04:35.125 DEBUG 96684 --- [http-nio-8812-exec-7] c.i.d.r.RainbowParamDao.channelList      : <==      Total: 27
2019-11-20 15:04:35.126 DEBUG 96684 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowParamDao.areaList   : ==>  Preparing: select DISTINCT SHOP_Area as paramKey, SHOP_Area as paramValue from study.t_shop_sub_info 
2019-11-20 15:04:35.126  INFO 96684 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=27}
2019-11-20 15:04:35.126 DEBUG 96684 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowParamDao.areaList   : ==> Parameters: 
2019-11-20 15:04:35.137 DEBUG 96684 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowParamDao.areaList   : <==      Total: 14
2019-11-20 15:04:35.137  INFO 96684 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:04:35.138 DEBUG 96684 --- [http-nio-8812-exec-4] c.i.d.r.RainbowParamDao.shopTypeList     : ==>  Preparing: select DICT_Value as paramKey,DICT_Name as paramValue from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' 
2019-11-20 15:04:35.138 DEBUG 96684 --- [http-nio-8812-exec-4] c.i.d.r.RainbowParamDao.shopTypeList     : ==> Parameters: 
2019-11-20 15:04:35.149 DEBUG 96684 --- [http-nio-8812-exec-4] c.i.d.r.RainbowParamDao.shopTypeList     : <==      Total: 14
2019-11-20 15:04:35.150  INFO 96684 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:04:35.150 DEBUG 96684 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.deviceTypeList   : ==>  Preparing: select DISTINCT DDI_Type as paramKey , DDI_Type as paramValue from t_device_device_info 
2019-11-20 15:04:35.150 DEBUG 96684 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.deviceTypeList   : ==> Parameters: 
2019-11-20 15:04:35.159 DEBUG 96684 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.deviceTypeList   : <==      Total: 6
2019-11-20 15:04:35.160  INFO 96684 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=6}
2019-11-20 15:04:35.160 DEBUG 96684 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? limit ?,?; 
2019-11-20 15:04:35.162 DEBUG 96684 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 0(Integer), 10(Integer)
2019-11-20 15:04:35.688 DEBUG 96684 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 10
2019-11-20 15:04:35.690 DEBUG 96684 --- [http-nio-8812-exec-8] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:04:35.692 DEBUG 96684 --- [http-nio-8812-exec-8] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:04:35.740 DEBUG 96684 --- [http-nio-8812-exec-8] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:04:35.740  INFO 96684 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', totalCount=392, dataSize=10}
2019-11-20 15:04:37.982  INFO 96684 --- [http-nio-8812-exec-9] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"M3051500100043","shopValue":"10893","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:04:37.985 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:04:37.988 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:04:37.999 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:04:38.000 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:04:38.001 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 10893(String)
2019-11-20 15:04:38.236 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:04:38.237 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:04:38.238 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:04:38.250 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:04:38.251 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:04:38.252 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 10893(String), M3051500100043(String)
2019-11-20 15:04:38.274 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:04:38.275 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:04:38.277 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:04:39.134 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 1
2019-11-20 15:04:39.136 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, dt 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:04:39.138 DEBUG 96684 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:04:39.272 ERROR 96684 --- [http-nio-8812-exec-9] o.a.c.c.C.[.[.[.[dispatcherServlet]      : Servlet.service() for servlet [dispatcherServlet] in context with path [/interest] threw exception [Request processing failed; nested exception is org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'dt' in 'field list'
### The error may exist in file [E:\workspace\javaEE\interest\interest-server\target\classes\mybatis\mapper\rainbow\RainbowDjqdatjMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select DDI_No 机器编号, SHOP_No 网点编号, dt 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数   from   (   select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user,   case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1   when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1   when first_sub.draw_dt <? then 0   when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1   when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1   when first_sub.dt>? then 0 end as 搜索时段内天数   from   (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type   from study.t_device_sub_info a left join t_device_device_info b   on a.DDI_No = b.DDI_No   left join netfiance_db.t_shop_shop_info d   on d.SHOP_No = a.SHOP_No   left join netfiance_db.t_shop_agent_list e   on d.SHOP_AGUid = e.AGNT_Uid   left join netfiance_db.t_shop_agent_top f   on e.AGNT_ATUid = f.ATOP_Uid   left join study.t_shop_sub_info g   on a.SHOP_No = g.SHOP_No   left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t   on t.DICT_Value = d.SHOP_Class   where a.DSI_Anti is null          and d.SHOP_No = ?            and a.DDI_No = ?                        #and b.DDI_Type = '{{设备类型}}'   #and f.ATOP_Title = {{选择渠道}}   #and a.DDI_No = '{{设备编码}}'   #and g.SHOP_Area = '{{ 所属地区 }}'   #and d.SHOP_No = '{{ 所属门店 }}'   #and t.DICT_Name = '{{ 网点类型 }}'   order by dt) first_sub             #每台机器在网点真实开启时间    left join    (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid   from t_shop_order_info e left join t_device_device_info b   on e.ODER_DUid = b.DDI_Uid   left join study.t_device_sub_info a   on b.DDI_No = a.DDI_No   where date(e.CreateDate)>=? and date(e.CreateDate) <=?   and e.ODER_State = 0   and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail   on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt    where first_sub.dt <=?   group by DDI_No,SHOP_No,启用时间   )t
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'dt' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'dt' in 'field list'] with root cause

java.sql.SQLSyntaxErrorException: Unknown column 'dt' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:95) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:960) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:388) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at com.mysql.cj.jdbc.PreparedStatementWrapper.execute(PreparedStatementWrapper.java:535) ~[mysql-connector-java-8.0.11.jar:8.0.11]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.4.6.jar:3.4.6]
	at com.sun.proxy.$Proxy229.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:63) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:79) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:63) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141) ~[mybatis-3.4.6.jar:3.4.6]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433) ~[mybatis-spring-1.3.2.jar:1.3.2]
	at com.sun.proxy.$Proxy129.selectList(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230) ~[mybatis-spring-1.3.2.jar:1.3.2]
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:139) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:76) ~[mybatis-3.4.6.jar:3.4.6]
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:59) ~[mybatis-3.4.6.jar:3.4.6]
	at com.sun.proxy.$Proxy140.yyzt3_jqrjgcrs(Unknown Source) ~[na:na]
	at com.interest.service.impl.RainbowDjqdatjServiceImpl.jqsxxx_detail(RainbowDjqdatjServiceImpl.java:44) ~[classes/:na]
	at com.interest.controller.rainbow.RainbowDjqdatjController.jqsxxx_detail(RainbowDjqdatjController.java:49) ~[classes/:na]
	at com.interest.controller.rainbow.RainbowDjqdatjController$$FastClassBySpringCGLIB$$77a924f7.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at com.interest.annotation.handler.InterestLogAspect.printLog(InterestLogAspect.java:40) ~[classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.aspectj.AspectJAfterThrowingAdvice.invoke(AspectJAfterThrowingAdvice.java:62) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688) ~[spring-aop-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at com.interest.controller.rainbow.RainbowDjqdatjController$$EnhancerBySpringCGLIB$$50c6c157.jqsxxx_detail(<generated>) ~[classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:215) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:142) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:998) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:890) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:875) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.boot.actuate.web.trace.servlet.HttpTraceFilter.doFilterInternal(HttpTraceFilter.java:90) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:127) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:91) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:170) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(OAuth2AuthenticationProcessingFilter.java:176) ~[spring-security-oauth2-2.3.3.RELEASE.jar:na]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:66) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178) ~[spring-security-web-5.1.1.RELEASE.jar:5.1.1.RELEASE]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:357) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:270) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:154) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:122) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:107) ~[spring-boot-actuator-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199) ~[tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:770) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_151]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_151]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.12.jar:9.0.12]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_151]

2019-11-20 15:06:29.362  INFO 93452 --- [restartedMain] com.interest.WhSpringBootApplication     : No active profile set, falling back to default profiles: default
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleCommentDao' and 'com.interest.dao.master.ArticleCommentDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleDao' and 'com.interest.dao.master.ArticleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'emailDao' and 'com.interest.dao.master.EmailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'interestDao' and 'com.interest.dao.master.InterestDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'menuDao' and 'com.interest.dao.master.MenuDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'msgRecordsDao' and 'com.interest.dao.master.MsgRecordsDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'postCardDao' and 'com.interest.dao.master.PostCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'relationDao' and 'com.interest.dao.master.RelationDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'replyCardDao' and 'com.interest.dao.master.ReplyCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'roleDao' and 'com.interest.dao.master.RoleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDao' and 'com.interest.dao.master.UserDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDetailDao' and 'com.interest.dao.master.UserDetailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userGithubDao' and 'com.interest.dao.master.UserGithubDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userQQDao' and 'com.interest.dao.master.UserQQDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowDjqdatjDao' and 'com.interest.dao.rainbow.RainbowDjqdatjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowKcqktjDao' and 'com.interest.dao.rainbow.RainbowKcqktjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowParamDao' and 'com.interest.dao.rainbow.RainbowParamDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRbbxhDao' and 'com.interest.dao.rainbow.RainbowRbbxhDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRxstjDao' and 'com.interest.dao.rainbow.RainbowRxstjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowSrtjDao' and 'com.interest.dao.rainbow.RainbowSrtjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.016  WARN 93452 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowYjzbDao' and 'com.interest.dao.rainbow.RainbowYjzbDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:06:31.515  INFO 93452 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2019-11-20 15:06:31.515  INFO 93452 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.
2019-11-20 15:06:31.609  INFO 93452 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 78ms. Found 0 repository interfaces.
2019-11-20 15:06:32.170  INFO 93452 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ceed9656-147b-39fe-b78a-60d556f9d2a8
2019-11-20 15:06:32.592  INFO 93452 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$5190eac3] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:06:32.872  INFO 93452 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$6daaedc0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:06:33.528 ERROR 93452 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:06:33.855  INFO 93452 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8812 (http)
2019-11-20 15:06:33.886 ERROR 93452 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:06:33.886  INFO 93452 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-11-20 15:06:33.886  INFO 93452 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/9.0.12
2019-11-20 15:06:33.902 ERROR 93452 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:06:34.152  INFO 93452 --- [restartedMain] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring embedded WebApplicationContext
2019-11-20 15:06:34.152  INFO 93452 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 4758 ms
2019-11-20 15:06:35.166  WARN 93452 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'masterDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:06:35.478  WARN 93452 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'rainbowDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'webMvcMetricsFilter' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'formContentFilter' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] .s.DelegatingFilterProxyRegistrationBean : Mapping filter: 'springSecurityFilterChain' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpTraceFilter' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'corsFilter' to: [/*]
2019-11-20 15:06:35.977  INFO 93452 --- [restartedMain] o.s.b.w.servlet.ServletRegistrationBean  : Servlet dispatcherServlet mapped to [/]
2019-11-20 15:06:36.648  INFO 93452 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2019-11-20 15:06:37.506  WARN 93452 --- [restartedMain] o.s.s.o.p.t.s.JwtAccessTokenConverter    : Unable to create an RSA verifier from verifierKey (ignoreable if using MAC)
2019-11-20 15:06:38.504  INFO 93452 --- [restartedMain] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2019-11-20 15:06:38.660  INFO 93452 --- [restartedMain] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2019-11-20 15:06:39.222  INFO 93452 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: OrRequestMatcher [requestMatchers=[Ant [pattern='/oauth/token'], Ant [pattern='/oauth/token_key'], Ant [pattern='/oauth/check_token']]], [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6129fe67, org.springframework.security.web.context.SecurityContextPersistenceFilter@76252553, org.springframework.security.web.header.HeaderWriterFilter@707bc8f9, org.springframework.security.web.authentication.logout.LogoutFilter@12d07513, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@39a17e5b, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@339bc9e4, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@44d1228f, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@1e7e923c, org.springframework.security.web.session.SessionManagementFilter@714b9b4b, org.springframework.security.web.access.ExceptionTranslationFilter@6156b5f0, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@1db868f7]
2019-11-20 15:06:39.253  INFO 93452 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfiguration$NotOAuthRequestMatcher@718b9004, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6712c56e, org.springframework.security.web.context.SecurityContextPersistenceFilter@55ced61b, org.springframework.security.web.header.HeaderWriterFilter@125632d9, org.springframework.web.filter.CorsFilter@6b326790, org.springframework.security.web.authentication.logout.LogoutFilter@39434445, org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter@2c1b7fdd, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4637136f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6554318a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@503a921e, org.springframework.security.web.session.SessionManagementFilter@349d0ad7, org.springframework.security.web.access.ExceptionTranslationFilter@1c41e568, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@d19b3e7]
2019-11-20 15:06:39.253  INFO 93452 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4627ad33, org.springframework.security.web.context.SecurityContextPersistenceFilter@33fb193c, org.springframework.security.web.header.HeaderWriterFilter@40a16231, org.springframework.security.web.authentication.logout.LogoutFilter@5791fecb, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@3e2afac8, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@2df2b8f5, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@7f47c873, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6393d61, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4d42777d, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@16d281e9, org.springframework.security.web.session.SessionManagementFilter@6de1a636, org.springframework.security.web.access.ExceptionTranslationFilter@7218fde7, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@7cf8a420]
2019-11-20 15:06:39.627  INFO 93452 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2019-11-20 15:06:39.861  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Loaded jar:file:/C:/Users/SunTH/.m2/repository/com/atomikos/transactions/4.0.6/transactions-4.0.6.jar!/transactions-defaults.properties
2019-11-20 15:06:39.877  WARN 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Thanks for using Atomikos! Evaluate http://www.atomikos.com/Main/ExtremeTransactions for advanced features and professional support
or register at http://www.atomikos.com/Main/RegisterYourDownload to disable this message and receive FREE tips & advice
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_max_wait_time_on_shutdown = 9223372036854775807
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.allow_subtransactions = true
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.recovery_delay = 10000
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.automatic_resource_registration = true
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_max_retries = 5
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.client_demarcation = false
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.threaded_2pc = false
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.serial_jta_transactions = true
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_dir = E:\workspace\javaEE\interest\interest-server\transaction-logs
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.rmi_export_class = none
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_actives = 50
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.checkpoint_interval = 500
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.enable_logging = true
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_name = tmlog
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_timeout = 300000
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.trust_client_tm = false
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.factory.initial = com.sun.jndi.rmi.registry.RegistryContextFactory
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.tm_unique_name = 192.168.1.31.tm
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.forget_orphaned_log_entries_delay = 86400000
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_retry_interval = 10000
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.provider.url = rmi://localhost:1099
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.force_shutdown_on_vm_exit = false
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_jta_timeout = 10000
2019-11-20 15:06:39.877  INFO 93452 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Using default (local) logging and recovery...
2019-11-20 15:06:39.970  INFO 93452 --- [restartedMain] c.a.d.xa.XATransactionalResource         : masterDataSource: refreshed XAResource
2019-11-20 15:06:40.064  INFO 93452 --- [restartedMain] c.a.d.xa.XATransactionalResource         : rainbowDataSource: refreshed XAResource
2019-11-20 15:06:40.672  INFO 93452 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService 'taskScheduler'
2019-11-20 15:06:41.452  INFO 93452 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2019-11-20 15:06:41.515  INFO 93452 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2019-11-20 15:06:41.608  INFO 93452 --- [restartedMain] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2019-11-20 15:06:41.874  INFO 93452 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: getArticleUsingGET_1
2019-11-20 15:06:41.952  INFO 93452 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadPictureUsingPOST_1
2019-11-20 15:06:42.061  INFO 93452 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_1
2019-11-20 15:06:42.217  INFO 93452 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_2
2019-11-20 15:06:42.373  INFO 93452 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8812 (http) with context path '/interest'
2019-11-20 15:06:42.373  INFO 93452 --- [restartedMain] com.interest.WhSpringBootApplication     : Started WhSpringBootApplication in 14.867 seconds (JVM running for 15.886)
2019-11-20 15:06:48.513  INFO 93452 --- [http-nio-8812-exec-1] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring DispatcherServlet 'dispatcherServlet'
2019-11-20 15:06:48.513  INFO 93452 --- [http-nio-8812-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2019-11-20 15:06:48.528  INFO 93452 --- [http-nio-8812-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 15 ms
2019-11-20 15:06:48.683  INFO 93452 --- [http-nio-8812-exec-1] io.lettuce.core.EpollProvider            : Starting without optional epoll library
2019-11-20 15:06:48.685  INFO 93452 --- [http-nio-8812-exec-1] io.lettuce.core.KqueueProvider           : Starting without optional kqueue library
2019-11-20 15:06:49.257  INFO 93452 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"M3051500100043","shopValue":"10893","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:06:49.416 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:06:49.443 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:06:49.469 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:06:49.472 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:06:49.473 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 10893(String)
2019-11-20 15:06:49.698 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:06:49.701 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:06:49.703 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:06:49.714 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:06:49.715 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:06:49.716 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 10893(String), M3051500100043(String)
2019-11-20 15:06:49.738 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:06:49.739 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:06:49.741 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:06:50.607 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 1
2019-11-20 15:06:50.609 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:06:50.610 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:06:51.485 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:06:51.489 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:06:51.493 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:06:51.812 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:06:51.816 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:06:51.820 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:06:52.682 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:06:52.685 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:06:52.688 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:06:52.701 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 0
2019-11-20 15:06:52.704 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:06:52.706 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: M3051500100043(String), 10893(String)
2019-11-20 15:06:52.717 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 1
2019-11-20 15:06:52.719 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:06:52.720 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:06:52.730 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 1
2019-11-20 15:06:52.731 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:06:52.733 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:06:52.752 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:06:52.753 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:06:52.754 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:06:52.869 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 0
2019-11-20 15:06:52.870 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:06:52.872 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:06:52.907 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:06:52.908 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:06:52.909 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: M3051500100043(String), 10893(String)
2019-11-20 15:06:52.921 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 0
2019-11-20 15:06:52.923 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:06:52.925 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: M3051500100043(String), 10893(String)
2019-11-20 15:06:52.963 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:06:52.965 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:06:52.966 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 10893(String), M3051500100043(String)
2019-11-20 15:06:52.978 DEBUG 93452 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 0
2019-11-20 15:06:52.978  INFO 93452 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"M3051500100043","shopValue":"10893","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[{机器获客总人数=12, SHOP_No=10893, DDI_Type=M, DDI_No=M3051500100043, 启用时间=2019-10-08}], yyzt3_jqrjxgcrs=[{新用户总数=0, 搜索时段内天数=44, 机器日均新购彩人数=0.0000, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], sbjyxx_tk=[], mdsxxx=[{人均消费=, 门店每日人流量=0, 门店类型=建材店, 网点名称=贵杰榆林建材经销部, 所属区域经理=佟贵杰(13683181296), 距公司距离=, 所属区域=顺义区, 详细地址=顺义区北小营镇榆林村, 所属商圈=, 网点编号=10893}], sbjyxx_xs=[{设备编号=M3051500100043, 累计订单数（单）=65, 累计销售额（元）=585, 累计销售票数（张）=117, 启用时间=2019-10-08, 网点编号=10893}], sbjyxx_drxs=[], yyzt1=[{所属渠道=风锐, 合作类型=托管自营, 设备编号=M3051500100043, 目前门店状态=运营中, 网点申请时间=2019-08-14 00:00:00.0, 设备启用时间=2019-10-08, 网点编号=10893}], sbwhtj3=[], yyzt2=[{日均开机时长（小时）=4.7, 累计开机天数=29, 月均关机天数=7.5000, 设备累计开机时间（时）=137.3, 启用时间=2019-10-08, 累计关机天数=15, 机器编号=M3051500100043, 网点编号=10893}], sbjyxx_tkddbl=[{退款订单比率=0.0000, 设备编号=M3051500100043, 启用时间=2019-10-08, 网点编号=10893}], yyzt3_jqrjfgrs=[{搜索时段内天数=44, 复购用户总数=12, 机器日均复购人数=0.2727, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], sbwhtj5=[{票仓=1, 加仓次数=3, 设备=M3051500100043}], sbwhtj4=[{设备编码=M3051500100043, 机头编号=1, 实时余量=9, 仓内票种=5倍惊喜, 网点编码=10893, 票种金额=5, 启用时间=2019-10-08}], sbjyxx_drpzxl=[], jqsxxx=[{设备位置=顺义区北小营镇榆林村, 设备类型=M, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=0.2727, 查询时段内运营天数=44, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], sbjyxx_drtk=[]}}
2019-11-20 15:07:23.631  INFO 93452 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"48826"}]
2019-11-20 15:07:23.635 DEBUG 93452 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? limit ?,?; 
2019-11-20 15:07:23.636 DEBUG 93452 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 48826(String), 0(Integer), 10(Integer)
2019-11-20 15:07:23.645 DEBUG 93452 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 1
2019-11-20 15:07:23.648 DEBUG 93452 --- [http-nio-8812-exec-2] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:07:23.649 DEBUG 93452 --- [http-nio-8812-exec-2] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 48826(String)
2019-11-20 15:07:23.657 DEBUG 93452 --- [http-nio-8812-exec-2] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:07:23.658  INFO 93452 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"48826"}], result : ResponseWrapper{status='2000', message='success', totalCount=1, dataSize=1}
2019-11-20 15:07:25.127  INFO 93452 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200002","shopValue":"48826","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:07:25.129 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:07:25.130 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200002(String), 48826(String)
2019-11-20 15:07:25.141 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:07:25.142 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:07:25.143 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 48826(String)
2019-11-20 15:07:25.359 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:07:25.363 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:07:25.366 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200002(String), 48826(String)
2019-11-20 15:07:25.381 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:07:25.383 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:07:25.384 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 48826(String), D1012400200002(String)
2019-11-20 15:07:25.408 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:07:25.409 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:07:25.410 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 48826(String), D1012400200002(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:07:26.263 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 1
2019-11-20 15:07:26.264 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:07:26.266 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 48826(String), D1012400200002(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:07:27.166 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:07:27.170 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:07:27.173 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 48826(String), D1012400200002(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:07:27.482 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:07:27.484 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:07:27.488 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 48826(String), D1012400200002(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:07:28.359 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:07:28.362 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:07:28.364 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200002(String), 48826(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:07:28.380 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 1
2019-11-20 15:07:28.382 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:07:28.385 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200002(String), 48826(String)
2019-11-20 15:07:28.397 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:07:28.400 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:07:28.402 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200002(String), 48826(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:07:28.414 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:07:28.416 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:07:28.418 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200002(String), 48826(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:07:28.437 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:07:28.440 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:07:28.441 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200002(String), 48826(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:07:28.598 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:07:28.599 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:07:28.600 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200002(String), 48826(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:07:28.677 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:07:28.678 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:07:28.679 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200002(String), 48826(String)
2019-11-20 15:07:28.691 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:07:28.692 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:07:28.693 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200002(String), 48826(String)
2019-11-20 15:07:28.708 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:07:28.709 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:07:28.710 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 48826(String), D1012400200002(String)
2019-11-20 15:07:28.722 DEBUG 93452 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 1
2019-11-20 15:07:28.723  INFO 93452 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200002","shopValue":"48826","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[{机器获客总人数=33, SHOP_No=48826, DDI_Type=D, DDI_No=D1012400200002, 启用时间=2019-10-08}], yyzt3_jqrjxgcrs=[{新用户总数=19, 搜索时段内天数=44, 机器日均新购彩人数=0.4318, 启用时间=2019-10-08, 机器编号=D1012400200002, 网点编号=48826}], sbjyxx_tk=[{启动时间=2019-10-08, 累计退款订单数=7, 设备编号=D1012400200002, 累计退款人数=6, 累计退款额=70.0, 网点编号=48826}], mdsxxx=[{人均消费=, 门店每日人流量=0, 门店类型=移动营业厅, 网点名称=通州云景东路营业厅, 所属区域经理=, 距公司距离=, 所属区域=, 详细地址=通州区云景东路439号一至三层, 所属商圈=, 网点编号=48826}], sbjyxx_xs=[{设备编号=D1012400200002, 累计订单数（单）=269, 累计销售额（元）=3080, 累计销售票数（张）=504, 启用时间=2019-10-08, 网点编号=48826}], sbjyxx_drxs=[{设备编号=D1012400200002, 当日订单数（单）=2, 启用时间=2019-10-08, 网点编号=48826, 当日销售额（元）=10, 当日销售票数（张）=2, 当日最大订单额度=5}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200002, 目前门店状态=运营中, 设备启用时间=2019-10-08, 网点编号=48826}], sbwhtj3=[{出库日期=2019-11-08 17:31:34, 姓名=紫霞，我来了, 加仓时间=2019-11-11 13:59:49, 出库包裹号=PN6777d367e0d2dd4a24, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200002, 加票张数=300, 启用时间=2019-10-08, 网点编号=48826, 加票额度（元）=1500}], yyzt2=[{日均开机时长（小时）=8.9, 累计开机天数=43, 月均关机天数=0.5000, 设备累计开机时间（时）=382.5, 启用时间=2019-10-08, 累计关机天数=1, 机器编号=D1012400200002, 网点编号=48826}], sbjyxx_tkddbl=[{退款订单比率=0.0260, 设备编号=D1012400200002, 启用时间=2019-10-08, 网点编号=48826}], yyzt3_jqrjfgrs=[{搜索时段内天数=44, 复购用户总数=19, 机器日均复购人数=0.4318, 启用时间=2019-10-08, 机器编号=D1012400200002, 网点编号=48826}], sbwhtj5=[{票仓=1, 加仓次数=3, 设备=D1012400200002}, {票仓=2, 加仓次数=5, 设备=D1012400200002}], sbwhtj4=[{设备编码=D1012400200002, 机头编号=1, 实时余量=35, 仓内票种=中国龙10元, 网点编码=48826, 票种金额=10, 启用时间=2019-10-08}, {设备编码=D1012400200002, 机头编号=2, 实时余量=135, 仓内票种=7乐无穷, 网点编码=48826, 票种金额=5, 启用时间=2019-10-08}], sbjyxx_drpzxl=[{累计销售张数=2, 票种单价=5, 设备编号=D1012400200002, 累计销售金额=10, 票种名称=7乐无穷, 启用时间=2019-10-08, 网点编号=48826}], jqsxxx=[{设备位置=通州区云景东路439号一至三层, 设备类型=D, 启用时间=2019-10-08, 机器编号=D1012400200002, 网点编号=48826}], yyzt3_jqrjgcrs=[{累计购彩人数=33, 机器日均购彩人数=0.7500, 查询时段内运营天数=44, 启用时间=2019-10-08, 机器编号=D1012400200002, 网点编号=48826}], sbjyxx_drtk=[]}}
2019-11-20 15:11:38.913  INFO 93452 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}]
2019-11-20 15:11:38.915 DEBUG 93452 --- [http-nio-8812-exec-4] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? limit ?,?; 
2019-11-20 15:11:38.915 DEBUG 93452 --- [http-nio-8812-exec-4] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String), 0(Integer), 10(Integer)
2019-11-20 15:11:38.931 DEBUG 93452 --- [http-nio-8812-exec-4] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 1
2019-11-20 15:11:38.933 DEBUG 93452 --- [http-nio-8812-exec-4] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:11:38.933 DEBUG 93452 --- [http-nio-8812-exec-4] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String)
2019-11-20 15:11:38.943 DEBUG 93452 --- [http-nio-8812-exec-4] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:11:38.943  INFO 93452 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}], result : ResponseWrapper{status='2000', message='success', totalCount=1, dataSize=1}
2019-11-20 15:11:40.280  INFO 93452 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:11:40.282 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:11:40.283 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:11:40.294 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:11:40.295 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:11:40.295 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 43056(String)
2019-11-20 15:11:40.510 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:11:40.513 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:11:40.515 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:11:40.828 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:11:40.828 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:11:40.829 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:11:40.849 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:11:40.850 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:11:40.851 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:11:40.861 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 0
2019-11-20 15:11:40.863 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:11:40.865 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:11:41.719 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:11:41.722 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:11:41.725 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:11:42.040 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:11:42.042 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:11:42.045 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:11:42.921 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:11:42.923 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:11:42.925 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:11:42.938 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 2
2019-11-20 15:11:42.940 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:11:42.941 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:11:42.953 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:11:42.955 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:11:42.957 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:11:42.968 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:11:42.969 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:11:42.970 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:11:42.987 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:11:42.988 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:11:42.995 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:11:43.018 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:11:43.020 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:11:43.020 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:11:43.041 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:11:43.042 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:11:43.042 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:11:43.054 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:11:43.056 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:11:43.057 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:11:43.070 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:11:43.072 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:11:43.073 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:11:43.087 DEBUG 93452 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 2
2019-11-20 15:11:43.088  INFO 93452 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[], yyzt3_jqrjxgcrs=[{新用户总数=10, 搜索时段内天数=2, 机器日均新购彩人数=5.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tk=[{启动时间=2019-11-19, 累计退款订单数=2, 设备编号=D1012400200188, 累计退款人数=1, 累计退款额=10.0, 网点编号=43056}], mdsxxx=[{门店类型=移动营业厅, 网点名称=东大桥营业厅, 详细地址=北京市朝阳区工体东路18号中复大厦一层, 网点编号=43056}], sbjyxx_xs=[{设备编号=D1012400200188, 累计订单数（单）=26, 累计销售额（元）=280, 累计销售票数（张）=35, 启用时间=2019-11-19, 网点编号=43056}], sbjyxx_drxs=[{设备编号=D1012400200188, 当日订单数（单）=14, 启用时间=2019-11-19, 网点编号=43056, 当日销售额（元）=165, 当日销售票数（张）=20, 当日最大订单额度=30}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200188, 目前门店状态=运营中, 设备启用时间=2019-11-19, 网点编号=43056}], sbwhtj3=[{出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=好运十倍, 票种面额（元）=10, 设备=D1012400200188, 加票张数=150, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1500}, {出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200188, 加票张数=200, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1000}], yyzt2=[{日均开机时长（小时）=6.1, 累计开机天数=2, 月均关机天数=0.0000, 设备累计开机时间（时）=12.2, 启用时间=2019-11-19, 累计关机天数=0, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tkddbl=[{退款订单比率=0.0769, 设备编号=D1012400200188, 启用时间=2019-11-19, 网点编号=43056}], yyzt3_jqrjfgrs=[{搜索时段内天数=2, 复购用户总数=6, 机器日均复购人数=3.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbwhtj5=[{票仓=1, 加仓次数=1, 设备=D1012400200188}, {票仓=2, 加仓次数=1, 设备=D1012400200188}], sbwhtj4=[{设备编码=D1012400200188, 机头编号=1, 实时余量=129, 仓内票种=好运十倍, 网点编码=43056, 票种金额=10, 启用时间=2019-11-19}, {设备编码=D1012400200188, 机头编号=2, 实时余量=186, 仓内票种=7乐无穷, 网点编码=43056, 票种金额=5, 启用时间=2019-11-19}], sbjyxx_drpzxl=[{累计销售张数=7, 票种单价=5, 设备编号=D1012400200188, 累计销售金额=35, 票种名称=7乐无穷, 启用时间=2019-11-19, 网点编号=43056}, {累计销售张数=13, 票种单价=10, 设备编号=D1012400200188, 累计销售金额=130, 票种名称=好运十倍, 启用时间=2019-11-19, 网点编号=43056}], jqsxxx=[{设备位置=北京市朝阳区工体东路18号中复大厦一层, 设备类型=D, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=6.0000, 查询时段内运营天数=2, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_drtk=[]}}
2019-11-20 15:20:46.770  INFO 100696 --- [restartedMain] com.interest.WhSpringBootApplication     : No active profile set, falling back to default profiles: default
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleCommentDao' and 'com.interest.dao.master.ArticleCommentDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleDao' and 'com.interest.dao.master.ArticleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'emailDao' and 'com.interest.dao.master.EmailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'interestDao' and 'com.interest.dao.master.InterestDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'menuDao' and 'com.interest.dao.master.MenuDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'msgRecordsDao' and 'com.interest.dao.master.MsgRecordsDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'postCardDao' and 'com.interest.dao.master.PostCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'relationDao' and 'com.interest.dao.master.RelationDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'replyCardDao' and 'com.interest.dao.master.ReplyCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'roleDao' and 'com.interest.dao.master.RoleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDao' and 'com.interest.dao.master.UserDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDetailDao' and 'com.interest.dao.master.UserDetailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userGithubDao' and 'com.interest.dao.master.UserGithubDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userQQDao' and 'com.interest.dao.master.UserQQDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowDjqdatjDao' and 'com.interest.dao.rainbow.RainbowDjqdatjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowKcqktjDao' and 'com.interest.dao.rainbow.RainbowKcqktjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowParamDao' and 'com.interest.dao.rainbow.RainbowParamDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRbbxhDao' and 'com.interest.dao.rainbow.RainbowRbbxhDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRxstjDao' and 'com.interest.dao.rainbow.RainbowRxstjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowSrtjDao' and 'com.interest.dao.rainbow.RainbowSrtjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:48.532  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowYjzbDao' and 'com.interest.dao.rainbow.RainbowYjzbDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:20:49.016  INFO 100696 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2019-11-20 15:20:49.016  INFO 100696 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.
2019-11-20 15:20:49.110  INFO 100696 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 78ms. Found 0 repository interfaces.
2019-11-20 15:20:49.734  INFO 100696 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ceed9656-147b-39fe-b78a-60d556f9d2a8
2019-11-20 15:20:50.077  INFO 100696 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$dcfad5a3] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:20:50.326  INFO 100696 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$f914d8a0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:20:50.950 ERROR 100696 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:20:51.294  INFO 100696 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8812 (http)
2019-11-20 15:20:51.309 ERROR 100696 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:20:51.325  INFO 100696 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-11-20 15:20:51.325  INFO 100696 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/9.0.12
2019-11-20 15:20:51.340 ERROR 100696 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:20:51.590  INFO 100696 --- [restartedMain] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring embedded WebApplicationContext
2019-11-20 15:20:51.590  INFO 100696 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 4789 ms
2019-11-20 15:20:52.620  WARN 100696 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'masterDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:20:52.963  WARN 100696 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'rainbowDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'webMvcMetricsFilter' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'formContentFilter' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] .s.DelegatingFilterProxyRegistrationBean : Mapping filter: 'springSecurityFilterChain' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpTraceFilter' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'corsFilter' to: [/*]
2019-11-20 15:20:53.446  INFO 100696 --- [restartedMain] o.s.b.w.servlet.ServletRegistrationBean  : Servlet dispatcherServlet mapped to [/]
2019-11-20 15:20:54.086  INFO 100696 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2019-11-20 15:20:54.944  WARN 100696 --- [restartedMain] o.s.s.o.p.t.s.JwtAccessTokenConverter    : Unable to create an RSA verifier from verifierKey (ignoreable if using MAC)
2019-11-20 15:20:55.833  INFO 100696 --- [restartedMain] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2019-11-20 15:20:55.989  INFO 100696 --- [restartedMain] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2019-11-20 15:20:56.535  INFO 100696 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: OrRequestMatcher [requestMatchers=[Ant [pattern='/oauth/token'], Ant [pattern='/oauth/token_key'], Ant [pattern='/oauth/check_token']]], [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@63ff4d64, org.springframework.security.web.context.SecurityContextPersistenceFilter@3f93151c, org.springframework.security.web.header.HeaderWriterFilter@6c821917, org.springframework.security.web.authentication.logout.LogoutFilter@30d511f9, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@2f0f7080, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@54740fc2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@753a776d, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@195fcdca, org.springframework.security.web.session.SessionManagementFilter@66bd86b6, org.springframework.security.web.access.ExceptionTranslationFilter@506f6864, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@20a63943]
2019-11-20 15:20:56.566  INFO 100696 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfiguration$NotOAuthRequestMatcher@58d0c423, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@fe2ffdb, org.springframework.security.web.context.SecurityContextPersistenceFilter@6a9cc5a7, org.springframework.security.web.header.HeaderWriterFilter@da089a9, org.springframework.web.filter.CorsFilter@5ddf7a79, org.springframework.security.web.authentication.logout.LogoutFilter@2ab335f9, org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter@2e1366d1, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7a9702bf, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@73f32185, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@be42c82, org.springframework.security.web.session.SessionManagementFilter@71451b91, org.springframework.security.web.access.ExceptionTranslationFilter@2817019a, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@4c474c8c]
2019-11-20 15:20:56.582  INFO 100696 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7a22a9fb, org.springframework.security.web.context.SecurityContextPersistenceFilter@1f102d6, org.springframework.security.web.header.HeaderWriterFilter@1499b812, org.springframework.security.web.authentication.logout.LogoutFilter@36711cda, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@7f356ef1, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@653a8caf, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@59e27417, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@768faae6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2f0fc50d, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@d74cb3c, org.springframework.security.web.session.SessionManagementFilter@4b6033f0, org.springframework.security.web.access.ExceptionTranslationFilter@7540592f, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@78ab7919]
2019-11-20 15:20:56.956  INFO 100696 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Loaded jar:file:/C:/Users/SunTH/.m2/repository/com/atomikos/transactions/4.0.6/transactions-4.0.6.jar!/transactions-defaults.properties
2019-11-20 15:20:57.222  WARN 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Thanks for using Atomikos! Evaluate http://www.atomikos.com/Main/ExtremeTransactions for advanced features and professional support
or register at http://www.atomikos.com/Main/RegisterYourDownload to disable this message and receive FREE tips & advice
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_max_wait_time_on_shutdown = 9223372036854775807
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.allow_subtransactions = true
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.recovery_delay = 10000
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.automatic_resource_registration = true
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_max_retries = 5
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.client_demarcation = false
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.threaded_2pc = false
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.serial_jta_transactions = true
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_dir = E:\workspace\javaEE\interest\interest-server\transaction-logs
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.rmi_export_class = none
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_actives = 50
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.checkpoint_interval = 500
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.enable_logging = true
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_name = tmlog
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_timeout = 300000
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.trust_client_tm = false
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.factory.initial = com.sun.jndi.rmi.registry.RegistryContextFactory
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.tm_unique_name = 192.168.1.31.tm
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.forget_orphaned_log_entries_delay = 86400000
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_retry_interval = 10000
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.provider.url = rmi://localhost:1099
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.force_shutdown_on_vm_exit = false
2019-11-20 15:20:57.222  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_jta_timeout = 10000
2019-11-20 15:20:57.237  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Using default (local) logging and recovery...
2019-11-20 15:20:57.331  INFO 100696 --- [restartedMain] c.a.d.xa.XATransactionalResource         : masterDataSource: refreshed XAResource
2019-11-20 15:20:57.440  INFO 100696 --- [restartedMain] c.a.d.xa.XATransactionalResource         : rainbowDataSource: refreshed XAResource
2019-11-20 15:20:57.986  INFO 100696 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService 'taskScheduler'
2019-11-20 15:20:58.688  INFO 100696 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2019-11-20 15:20:58.735  INFO 100696 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2019-11-20 15:20:58.844  INFO 100696 --- [restartedMain] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2019-11-20 15:20:59.094  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: getArticleUsingGET_1
2019-11-20 15:20:59.172  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadPictureUsingPOST_1
2019-11-20 15:20:59.281  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_1
2019-11-20 15:20:59.421  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_2
2019-11-20 15:20:59.562  INFO 100696 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8812 (http) with context path '/interest'
2019-11-20 15:20:59.562  INFO 100696 --- [restartedMain] com.interest.WhSpringBootApplication     : Started WhSpringBootApplication in 14.586 seconds (JVM running for 15.627)
2019-11-20 15:21:05.684  INFO 100696 --- [http-nio-8812-exec-1] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring DispatcherServlet 'dispatcherServlet'
2019-11-20 15:21:05.684  INFO 100696 --- [http-nio-8812-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2019-11-20 15:21:05.702  INFO 100696 --- [http-nio-8812-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 18 ms
2019-11-20 15:21:05.876  INFO 100696 --- [http-nio-8812-exec-1] io.lettuce.core.EpollProvider            : Starting without optional epoll library
2019-11-20 15:21:05.877  INFO 100696 --- [http-nio-8812-exec-1] io.lettuce.core.KqueueProvider           : Starting without optional kqueue library
2019-11-20 15:21:06.486  INFO 100696 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:21:06.672 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:21:06.703 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:21:06.726 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:21:06.729 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:21:06.730 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 43056(String)
2019-11-20 15:21:06.957 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:21:06.960 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:21:06.961 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:21:06.971 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:21:06.973 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:21:06.974 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:21:06.997 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:21:06.998 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:21:07.000 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:21:07.010 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 0
2019-11-20 15:21:07.011 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:21:07.013 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:21:07.898 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:21:07.900 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:21:07.901 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:21:08.215 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:21:08.218 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:21:08.221 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:21:09.095 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:21:09.098 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:21:09.101 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:21:09.116 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 2
2019-11-20 15:21:09.119 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:21:09.121 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:21:09.134 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:21:09.137 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:21:09.139 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:21:09.150 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:21:09.152 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:21:09.154 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:21:09.169 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:21:09.172 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:21:09.174 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:21:09.200 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:21:09.202 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:21:09.205 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:21:09.227 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:21:09.229 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:21:09.231 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:21:09.245 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:21:09.250 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:21:09.252 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:21:09.268 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:21:09.274 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() #默认为当日 and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:21:09.276 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:21:09.290 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 2
2019-11-20 15:21:09.292  INFO 100696 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[], yyzt3_jqrjxgcrs=[{新用户总数=10, 搜索时段内天数=2, 机器日均新购彩人数=5.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tk=[{启动时间=2019-11-19, 累计退款订单数=2, 设备编号=D1012400200188, 累计退款人数=1, 累计退款额=10.0, 网点编号=43056}], mdsxxx=[{门店类型=移动营业厅, 网点名称=东大桥营业厅, 详细地址=北京市朝阳区工体东路18号中复大厦一层, 网点编号=43056}], sbjyxx_xs=[{设备编号=D1012400200188, 累计订单数（单）=26, 累计销售额（元）=280, 累计销售票数（张）=35, 启用时间=2019-11-19, 网点编号=43056}], sbjyxx_drxs=[{设备编号=D1012400200188, 当日订单数（单）=14, 启用时间=2019-11-19, 网点编号=43056, 当日销售额（元）=165, 当日销售票数（张）=20, 当日最大订单额度=30}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200188, 目前门店状态=运营中, 设备启用时间=2019-11-19, 网点编号=43056}], sbwhtj3=[{出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=好运十倍, 票种面额（元）=10, 设备=D1012400200188, 加票张数=150, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1500}, {出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200188, 加票张数=200, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1000}], yyzt2=[{日均开机时长（小时）=6.2, 累计开机天数=2, 月均关机天数=0.0000, 设备累计开机时间（时）=12.4, 启用时间=2019-11-19, 累计关机天数=0, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tkddbl=[{退款订单比率=0.0769, 设备编号=D1012400200188, 启用时间=2019-11-19, 网点编号=43056}], yyzt3_jqrjfgrs=[{搜索时段内天数=2, 复购用户总数=6, 机器日均复购人数=3.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbwhtj5=[{票仓=1, 加仓次数=1, 设备=D1012400200188}, {票仓=2, 加仓次数=1, 设备=D1012400200188}], sbwhtj4=[{设备编码=D1012400200188, 机头编号=1, 实时余量=129, 仓内票种=好运十倍, 网点编码=43056, 票种金额=10, 启用时间=2019-11-19}, {设备编码=D1012400200188, 机头编号=2, 实时余量=186, 仓内票种=7乐无穷, 网点编码=43056, 票种金额=5, 启用时间=2019-11-19}], sbjyxx_drpzxl=[{累计销售张数=7, 票种单价=5, 设备编号=D1012400200188, 累计销售金额=35, 票种名称=7乐无穷, 启用时间=2019-11-19, 网点编号=43056}, {累计销售张数=13, 票种单价=10, 设备编号=D1012400200188, 累计销售金额=130, 票种名称=好运十倍, 启用时间=2019-11-19, 网点编号=43056}], jqsxxx=[{设备位置=北京市朝阳区工体东路18号中复大厦一层, 设备类型=D, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=6.0000, 查询时段内运营天数=2, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_drtk=[]}}
2019-11-20 15:22:03.875  INFO 100696 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:22:03.877 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:22:03.877 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:22:03.887 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:22:03.888 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:22:03.889 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 43056(String)
2019-11-20 15:22:04.111 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:22:04.114 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:22:04.117 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:22:04.452 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:22:04.455 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:22:04.457 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:22:04.480 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:22:04.481 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:22:04.483 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:04.492 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 0
2019-11-20 15:22:04.493 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:22:04.496 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:05.353 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:22:05.356 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:22:05.359 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:05.695 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:22:05.698 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:22:05.701 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:06.582 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:22:06.584 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:22:06.587 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:06.600 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 2
2019-11-20 15:22:06.602 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:22:06.604 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:22:06.616 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:22:06.618 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:22:06.620 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:06.870 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:22:06.871 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:22:06.872 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:06.887 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:22:06.888 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:22:06.888 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:06.913 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:22:06.915 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:22:06.917 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:06.939 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:22:06.941 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:22:06.942 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:22:06.955 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:22:06.956 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:22:06.957 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:22:06.970 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:22:06.972 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() #默认为当日 and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:22:06.973 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:22:06.985 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 2
2019-11-20 15:22:06.986  INFO 100696 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[], yyzt3_jqrjxgcrs=[{新用户总数=10, 搜索时段内天数=2, 机器日均新购彩人数=5.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tk=[{启动时间=2019-11-19, 累计退款订单数=2, 设备编号=D1012400200188, 累计退款人数=1, 累计退款额=10.0, 网点编号=43056}], mdsxxx=[{门店类型=移动营业厅, 网点名称=东大桥营业厅, 详细地址=北京市朝阳区工体东路18号中复大厦一层, 网点编号=43056}], sbjyxx_xs=[{设备编号=D1012400200188, 累计订单数（单）=26, 累计销售额（元）=280, 累计销售票数（张）=35, 启用时间=2019-11-19, 网点编号=43056}], sbjyxx_drxs=[{设备编号=D1012400200188, 当日订单数（单）=14, 启用时间=2019-11-19, 网点编号=43056, 当日销售额（元）=165, 当日销售票数（张）=20, 当日最大订单额度=30}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200188, 目前门店状态=运营中, 设备启用时间=2019-11-19, 网点编号=43056}], sbwhtj3=[{出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=好运十倍, 票种面额（元）=10, 设备=D1012400200188, 加票张数=150, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1500}, {出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200188, 加票张数=200, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1000}], yyzt2=[{日均开机时长（小时）=6.3, 累计开机天数=2, 月均关机天数=0.0000, 设备累计开机时间（时）=12.5, 启用时间=2019-11-19, 累计关机天数=0, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tkddbl=[{退款订单比率=0.0769, 设备编号=D1012400200188, 启用时间=2019-11-19, 网点编号=43056}], yyzt3_jqrjfgrs=[{搜索时段内天数=2, 复购用户总数=6, 机器日均复购人数=3.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbwhtj5=[{票仓=1, 加仓次数=1, 设备=D1012400200188}, {票仓=2, 加仓次数=1, 设备=D1012400200188}], sbwhtj4=[{设备编码=D1012400200188, 机头编号=1, 实时余量=129, 仓内票种=好运十倍, 网点编码=43056, 票种金额=10, 启用时间=2019-11-19}, {设备编码=D1012400200188, 机头编号=2, 实时余量=186, 仓内票种=7乐无穷, 网点编码=43056, 票种金额=5, 启用时间=2019-11-19}], sbjyxx_drpzxl=[{累计销售张数=7, 票种单价=5, 设备编号=D1012400200188, 累计销售金额=35, 票种名称=7乐无穷, 启用时间=2019-11-19, 网点编号=43056}, {累计销售张数=13, 票种单价=10, 设备编号=D1012400200188, 累计销售金额=130, 票种名称=好运十倍, 启用时间=2019-11-19, 网点编号=43056}], jqsxxx=[{设备位置=北京市朝阳区工体东路18号中复大厦一层, 设备类型=D, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=6.0000, 查询时段内运营天数=2, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_drtk=[]}}
2019-11-20 15:22:29.720  INFO 100696 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:22:29.721 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:22:29.721 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:22:29.732 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:22:29.733 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:22:29.733 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 43056(String)
2019-11-20 15:22:29.947 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:22:29.949 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:22:29.952 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:22:29.963 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:22:29.965 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:22:29.967 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:22:29.991 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:22:29.993 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:22:29.995 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:30.005 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 0
2019-11-20 15:22:30.007 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:22:30.010 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:30.877 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:22:30.880 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:22:30.883 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:31.192 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:22:31.195 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:22:31.197 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:22:32.099 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:22:32.102 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:22:32.103 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:32.115 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 2
2019-11-20 15:22:32.117 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:22:32.118 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:22:32.129 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:22:32.131 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:22:32.133 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:32.143 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:22:32.145 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:22:32.146 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:32.161 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:22:32.162 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:22:32.162 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:32.183 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:22:32.184 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:22:32.184 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:22:32.204 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:22:32.205 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:22:32.205 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:22:32.218 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:22:32.219 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:22:32.219 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:22:32.232 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:22:32.234 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() #默认为当日 and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:22:32.235 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:22:32.248 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 2
2019-11-20 15:22:32.250  INFO 100696 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[], yyzt3_jqrjxgcrs=[{新用户总数=10, 搜索时段内天数=2, 机器日均新购彩人数=5.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tk=[{启动时间=2019-11-19, 累计退款订单数=2, 设备编号=D1012400200188, 累计退款人数=1, 累计退款额=10.0, 网点编号=43056}], mdsxxx=[{门店类型=移动营业厅, 网点名称=东大桥营业厅, 详细地址=北京市朝阳区工体东路18号中复大厦一层, 网点编号=43056}], sbjyxx_xs=[{设备编号=D1012400200188, 累计订单数（单）=26, 累计销售额（元）=280, 累计销售票数（张）=35, 启用时间=2019-11-19, 网点编号=43056}], sbjyxx_drxs=[{设备编号=D1012400200188, 当日订单数（单）=14, 启用时间=2019-11-19, 网点编号=43056, 当日销售额（元）=165, 当日销售票数（张）=20, 当日最大订单额度=30}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200188, 目前门店状态=运营中, 设备启用时间=2019-11-19, 网点编号=43056}], sbwhtj3=[{出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=好运十倍, 票种面额（元）=10, 设备=D1012400200188, 加票张数=150, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1500}, {出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200188, 加票张数=200, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1000}], yyzt2=[{日均开机时长（小时）=6.3, 累计开机天数=2, 月均关机天数=0.0000, 设备累计开机时间（时）=12.5, 启用时间=2019-11-19, 累计关机天数=0, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tkddbl=[{退款订单比率=0.0769, 设备编号=D1012400200188, 启用时间=2019-11-19, 网点编号=43056}], yyzt3_jqrjfgrs=[{搜索时段内天数=2, 复购用户总数=6, 机器日均复购人数=3.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbwhtj5=[{票仓=1, 加仓次数=1, 设备=D1012400200188}, {票仓=2, 加仓次数=1, 设备=D1012400200188}], sbwhtj4=[{设备编码=D1012400200188, 机头编号=1, 实时余量=129, 仓内票种=好运十倍, 网点编码=43056, 票种金额=10, 启用时间=2019-11-19}, {设备编码=D1012400200188, 机头编号=2, 实时余量=186, 仓内票种=7乐无穷, 网点编码=43056, 票种金额=5, 启用时间=2019-11-19}], sbjyxx_drpzxl=[{累计销售张数=7, 票种单价=5, 设备编号=D1012400200188, 累计销售金额=35, 票种名称=7乐无穷, 启用时间=2019-11-19, 网点编号=43056}, {累计销售张数=13, 票种单价=10, 设备编号=D1012400200188, 累计销售金额=130, 票种名称=好运十倍, 启用时间=2019-11-19, 网点编号=43056}], jqsxxx=[{设备位置=北京市朝阳区工体东路18号中复大厦一层, 设备类型=D, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=6.0000, 查询时段内运营天数=2, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_drtk=[]}}
2019-11-20 15:25:59.103  INFO 100696 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: []
2019-11-20 15:25:59.118 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.areaList   : ==>  Preparing: select DISTINCT SHOP_Area as paramKey, SHOP_Area as paramValue from study.t_shop_sub_info 
2019-11-20 15:25:59.118 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.areaList   : ==> Parameters: 
2019-11-20 15:25:59.128 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.areaList   : <==      Total: 14
2019-11-20 15:25:59.129  INFO 100696 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:25:59.141  INFO 100696 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: []
2019-11-20 15:25:59.142 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.shopTypeList     : ==>  Preparing: select DICT_Value as paramKey,DICT_Name as paramValue from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' 
2019-11-20 15:25:59.143 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.shopTypeList     : ==> Parameters: 
2019-11-20 15:25:59.153 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.shopTypeList     : <==      Total: 14
2019-11-20 15:25:59.154  INFO 100696 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:25:59.377  INFO 100696 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: []
2019-11-20 15:25:59.381 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowParamDao.shopList   : ==>  Preparing: select SHOP_No as paramKey, SHOP_Title as paramValue from netfiance_db.t_shop_shop_info 
2019-11-20 15:25:59.381 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowParamDao.shopList   : ==> Parameters: 
2019-11-20 15:25:59.382  INFO 100696 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: []
2019-11-20 15:25:59.383  INFO 100696 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: []
2019-11-20 15:25:59.385  INFO 100696 --- [http-nio-8812-exec-9] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:25:59.414 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowParamDao.shopList   : <==      Total: 462
2019-11-20 15:25:59.415  INFO 100696 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=462}
2019-11-20 15:25:59.415 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowParamDao.deviceTypeList   : ==>  Preparing: select DISTINCT DDI_Type as paramKey , DDI_Type as paramValue from t_device_device_info 
2019-11-20 15:25:59.415 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowParamDao.deviceTypeList   : ==> Parameters: 
2019-11-20 15:25:59.424 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowParamDao.deviceTypeList   : <==      Total: 6
2019-11-20 15:25:59.425  INFO 100696 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=6}
2019-11-20 15:25:59.425 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowParamDao.channelList      : ==>  Preparing: select DISTINCT ATOP_Uid as paramKey, ATOP_Title as paramValue from netfiance_db.t_shop_agent_top 
2019-11-20 15:25:59.425 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowParamDao.channelList      : ==> Parameters: 
2019-11-20 15:25:59.639 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowParamDao.channelList      : <==      Total: 27
2019-11-20 15:25:59.639  INFO 100696 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=27}
2019-11-20 15:25:59.640 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? limit ?,?; 
2019-11-20 15:25:59.640 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 0(Integer), 10(Integer)
2019-11-20 15:25:59.888 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 10
2019-11-20 15:25:59.890 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:25:59.890 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:25:59.930 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:25:59.931  INFO 100696 --- [http-nio-8812-exec-9] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', totalCount=392, dataSize=10}
2019-11-20 15:26:12.402  INFO 100696 --- [http-nio-8812-exec-10] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}]
2019-11-20 15:26:12.403 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? limit ?,?; 
2019-11-20 15:26:12.404 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String), 0(Integer), 10(Integer)
2019-11-20 15:26:12.412 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 1
2019-11-20 15:26:12.413 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:26:12.414 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String)
2019-11-20 15:26:12.421 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:26:12.422  INFO 100696 --- [http-nio-8812-exec-10] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}], result : ResponseWrapper{status='2000', message='success', totalCount=1, dataSize=1}
2019-11-20 15:26:24.595  INFO 100696 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:26:24.596 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:26:24.596 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:26:24.605 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:26:24.606 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:26:24.607 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 43056(String)
2019-11-20 15:26:24.817 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:26:24.818 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:26:24.819 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:26:24.828 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:26:24.830 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:26:24.830 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:26:24.850 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:26:24.851 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:26:24.851 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:26:24.862 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 0
2019-11-20 15:26:24.863 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:26:24.863 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:26:25.730 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:26:25.731 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:26:25.732 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:26:26.046 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:26:26.047 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:26:26.048 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:26:26.900 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:26:26.901 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:26:26.902 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:26:26.912 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 2
2019-11-20 15:26:26.913 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:26:26.914 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:26:26.924 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:26:26.925 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:26:26.925 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:26:26.935 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:26:26.936 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:26:26.936 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:26:26.953 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:26:26.954 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:26:26.955 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:26:26.975 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:26:26.976 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:26:26.976 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:26:26.997 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:26:26.998 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:26:26.998 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:26:27.011 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:26:27.012 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:26:27.012 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:26:27.026 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:26:27.027 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() #默认为当日 and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:26:27.027 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:26:27.041 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 2
2019-11-20 15:26:27.041  INFO 100696 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[], yyzt3_jqrjxgcrs=[{新用户总数=10, 搜索时段内天数=2, 机器日均新购彩人数=5.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tk=[{启动时间=2019-11-19, 累计退款订单数=2, 设备编号=D1012400200188, 累计退款人数=1, 累计退款额=10.0, 网点编号=43056}], mdsxxx=[{门店类型=移动营业厅, 网点名称=东大桥营业厅, 详细地址=北京市朝阳区工体东路18号中复大厦一层, 网点编号=43056}], sbjyxx_xs=[{设备编号=D1012400200188, 累计订单数（单）=26, 累计销售额（元）=280, 累计销售票数（张）=35, 启用时间=2019-11-19, 网点编号=43056}], sbjyxx_drxs=[{设备编号=D1012400200188, 当日订单数（单）=14, 启用时间=2019-11-19, 网点编号=43056, 当日销售额（元）=165, 当日销售票数（张）=20, 当日最大订单额度=30}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200188, 目前门店状态=运营中, 设备启用时间=2019-11-19, 网点编号=43056}], sbwhtj3=[{出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=好运十倍, 票种面额（元）=10, 设备=D1012400200188, 加票张数=150, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1500}, {出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200188, 加票张数=200, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1000}], yyzt2=[{日均开机时长（小时）=6.3, 累计开机天数=2, 月均关机天数=0.0000, 设备累计开机时间（时）=12.5, 启用时间=2019-11-19, 累计关机天数=0, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tkddbl=[{退款订单比率=0.0769, 设备编号=D1012400200188, 启用时间=2019-11-19, 网点编号=43056}], yyzt3_jqrjfgrs=[{搜索时段内天数=2, 复购用户总数=6, 机器日均复购人数=3.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbwhtj5=[{票仓=1, 加仓次数=1, 设备=D1012400200188}, {票仓=2, 加仓次数=1, 设备=D1012400200188}], sbwhtj4=[{设备编码=D1012400200188, 机头编号=1, 实时余量=129, 仓内票种=好运十倍, 网点编码=43056, 票种金额=10, 启用时间=2019-11-19}, {设备编码=D1012400200188, 机头编号=2, 实时余量=186, 仓内票种=7乐无穷, 网点编码=43056, 票种金额=5, 启用时间=2019-11-19}], sbjyxx_drpzxl=[{累计销售张数=7, 票种单价=5, 设备编号=D1012400200188, 累计销售金额=35, 票种名称=7乐无穷, 启用时间=2019-11-19, 网点编号=43056}, {累计销售张数=13, 票种单价=10, 设备编号=D1012400200188, 累计销售金额=130, 票种名称=好运十倍, 启用时间=2019-11-19, 网点编号=43056}], jqsxxx=[{设备位置=北京市朝阳区工体东路18号中复大厦一层, 设备类型=D, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=6.0000, 查询时段内运营天数=2, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_drtk=[]}}
2019-11-20 15:26:57.458  INFO 100696 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: []
2019-11-20 15:26:57.459 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.areaList   : ==>  Preparing: select DISTINCT SHOP_Area as paramKey, SHOP_Area as paramValue from study.t_shop_sub_info 
2019-11-20 15:26:57.459 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.areaList   : ==> Parameters: 
2019-11-20 15:26:57.468 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.areaList   : <==      Total: 14
2019-11-20 15:26:57.469  INFO 100696 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:26:57.484  INFO 100696 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: []
2019-11-20 15:26:57.485 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.shopTypeList     : ==>  Preparing: select DICT_Value as paramKey,DICT_Name as paramValue from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' 
2019-11-20 15:26:57.485 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.shopTypeList     : ==> Parameters: 
2019-11-20 15:26:57.494 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.shopTypeList     : <==      Total: 14
2019-11-20 15:26:57.495  INFO 100696 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:26:57.747  INFO 100696 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: []
2019-11-20 15:26:57.749  INFO 100696 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: []
2019-11-20 15:26:57.750 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.shopList   : ==>  Preparing: select SHOP_No as paramKey, SHOP_Title as paramValue from netfiance_db.t_shop_shop_info 
2019-11-20 15:26:57.751 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.shopList   : ==> Parameters: 
2019-11-20 15:26:57.753  INFO 100696 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:26:57.753  INFO 100696 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: []
2019-11-20 15:26:57.774 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.rainbow.RainbowParamDao.shopList   : <==      Total: 462
2019-11-20 15:26:57.775  INFO 100696 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=462}
2019-11-20 15:26:57.775 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.deviceTypeList   : ==>  Preparing: select DISTINCT DDI_Type as paramKey , DDI_Type as paramValue from t_device_device_info 
2019-11-20 15:26:57.775 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.deviceTypeList   : ==> Parameters: 
2019-11-20 15:26:57.783 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowParamDao.deviceTypeList   : <==      Total: 6
2019-11-20 15:26:57.784  INFO 100696 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=6}
2019-11-20 15:26:57.784 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.channelList      : ==>  Preparing: select DISTINCT ATOP_Uid as paramKey, ATOP_Title as paramValue from netfiance_db.t_shop_agent_top 
2019-11-20 15:26:57.784 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.channelList      : ==> Parameters: 
2019-11-20 15:26:58.006 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowParamDao.channelList      : <==      Total: 27
2019-11-20 15:26:58.006  INFO 100696 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=27}
2019-11-20 15:26:58.006 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? limit ?,?; 
2019-11-20 15:26:58.006 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 0(Integer), 10(Integer)
2019-11-20 15:26:58.266 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 10
2019-11-20 15:26:58.267 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:26:58.267 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:26:58.307 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:26:58.308  INFO 100696 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', totalCount=392, dataSize=10}
2019-11-20 15:27:03.538  INFO 100696 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}]
2019-11-20 15:27:03.539 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? limit ?,?; 
2019-11-20 15:27:03.539 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String), 0(Integer), 10(Integer)
2019-11-20 15:27:03.549 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 1
2019-11-20 15:27:03.550 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:27:03.551 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String)
2019-11-20 15:27:03.559 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:27:03.560  INFO 100696 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}], result : ResponseWrapper{status='2000', message='success', totalCount=1, dataSize=1}
2019-11-20 15:27:05.449  INFO 100696 --- [http-nio-8812-exec-9] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:27:05.450 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:27:05.450 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:27:05.460 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:27:05.462 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:27:05.462 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 43056(String)
2019-11-20 15:27:05.677 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:27:05.678 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:27:05.679 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:27:05.690 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:27:05.691 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:27:05.692 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:27:05.713 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:27:05.714 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:27:05.714 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:05.724 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 0
2019-11-20 15:27:05.725 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:27:05.726 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:06.618 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:27:06.619 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:27:06.620 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:06.947 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:27:06.948 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:27:06.949 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:07.829 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:27:07.830 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:27:07.830 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:07.841 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 2
2019-11-20 15:27:07.842 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:27:07.843 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:27:07.853 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:27:07.854 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:27:07.855 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:07.865 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:27:07.866 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:27:07.866 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:07.879 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:27:07.880 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:27:07.881 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:07.904 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:27:07.905 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:27:07.906 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:07.927 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:27:07.928 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:27:07.928 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:27:07.939 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:27:07.940 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:27:07.940 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:27:07.953 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:27:07.954 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() #默认为当日 and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:27:07.954 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:27:07.964 DEBUG 100696 --- [http-nio-8812-exec-9] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 2
2019-11-20 15:27:07.964  INFO 100696 --- [http-nio-8812-exec-9] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[], yyzt3_jqrjxgcrs=[{新用户总数=10, 搜索时段内天数=2, 机器日均新购彩人数=5.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tk=[{启动时间=2019-11-19, 累计退款订单数=2, 设备编号=D1012400200188, 累计退款人数=1, 累计退款额=10.0, 网点编号=43056}], mdsxxx=[{门店类型=移动营业厅, 网点名称=东大桥营业厅, 详细地址=北京市朝阳区工体东路18号中复大厦一层, 网点编号=43056}], sbjyxx_xs=[{设备编号=D1012400200188, 累计订单数（单）=26, 累计销售额（元）=280, 累计销售票数（张）=35, 启用时间=2019-11-19, 网点编号=43056}], sbjyxx_drxs=[{设备编号=D1012400200188, 当日订单数（单）=14, 启用时间=2019-11-19, 网点编号=43056, 当日销售额（元）=165, 当日销售票数（张）=20, 当日最大订单额度=30}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200188, 目前门店状态=运营中, 设备启用时间=2019-11-19, 网点编号=43056}], sbwhtj3=[{出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=好运十倍, 票种面额（元）=10, 设备=D1012400200188, 加票张数=150, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1500}, {出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200188, 加票张数=200, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1000}], yyzt2=[{日均开机时长（小时）=6.3, 累计开机天数=2, 月均关机天数=0.0000, 设备累计开机时间（时）=12.5, 启用时间=2019-11-19, 累计关机天数=0, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tkddbl=[{退款订单比率=0.0769, 设备编号=D1012400200188, 启用时间=2019-11-19, 网点编号=43056}], yyzt3_jqrjfgrs=[{搜索时段内天数=2, 复购用户总数=6, 机器日均复购人数=3.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbwhtj5=[{票仓=1, 加仓次数=1, 设备=D1012400200188}, {票仓=2, 加仓次数=1, 设备=D1012400200188}], sbwhtj4=[{设备编码=D1012400200188, 机头编号=1, 实时余量=129, 仓内票种=好运十倍, 网点编码=43056, 票种金额=10, 启用时间=2019-11-19}, {设备编码=D1012400200188, 机头编号=2, 实时余量=186, 仓内票种=7乐无穷, 网点编码=43056, 票种金额=5, 启用时间=2019-11-19}], sbjyxx_drpzxl=[{累计销售张数=7, 票种单价=5, 设备编号=D1012400200188, 累计销售金额=35, 票种名称=7乐无穷, 启用时间=2019-11-19, 网点编号=43056}, {累计销售张数=13, 票种单价=10, 设备编号=D1012400200188, 累计销售金额=130, 票种名称=好运十倍, 启用时间=2019-11-19, 网点编号=43056}], jqsxxx=[{设备位置=北京市朝阳区工体东路18号中复大厦一层, 设备类型=D, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=6.0000, 查询时段内运营天数=2, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_drtk=[]}}
2019-11-20 15:27:49.292  INFO 100696 --- [http-nio-8812-exec-10] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: []
2019-11-20 15:27:49.292 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.rainbow.RainbowParamDao.areaList   : ==>  Preparing: select DISTINCT SHOP_Area as paramKey, SHOP_Area as paramValue from study.t_shop_sub_info 
2019-11-20 15:27:49.293 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.rainbow.RainbowParamDao.areaList   : ==> Parameters: 
2019-11-20 15:27:49.301 DEBUG 100696 --- [http-nio-8812-exec-10] c.i.d.rainbow.RainbowParamDao.areaList   : <==      Total: 14
2019-11-20 15:27:49.301  INFO 100696 --- [http-nio-8812-exec-10] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|areaList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:27:49.315  INFO 100696 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: []
2019-11-20 15:27:49.315 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowParamDao.shopTypeList     : ==>  Preparing: select DICT_Value as paramKey,DICT_Name as paramValue from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' 
2019-11-20 15:27:49.316 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowParamDao.shopTypeList     : ==> Parameters: 
2019-11-20 15:27:49.324 DEBUG 100696 --- [http-nio-8812-exec-1] c.i.d.r.RainbowParamDao.shopTypeList     : <==      Total: 14
2019-11-20 15:27:49.325  INFO 100696 --- [http-nio-8812-exec-1] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=14}
2019-11-20 15:27:49.577  INFO 100696 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: []
2019-11-20 15:27:49.577 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.shopList   : ==>  Preparing: select SHOP_No as paramKey, SHOP_Title as paramValue from netfiance_db.t_shop_shop_info 
2019-11-20 15:27:49.578 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.shopList   : ==> Parameters: 
2019-11-20 15:27:49.579  INFO 100696 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: []
2019-11-20 15:27:49.579  INFO 100696 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: []
2019-11-20 15:27:49.584  INFO 100696 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:27:49.598 DEBUG 100696 --- [http-nio-8812-exec-2] c.i.d.rainbow.RainbowParamDao.shopList   : <==      Total: 462
2019-11-20 15:27:49.599  INFO 100696 --- [http-nio-8812-exec-2] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|shopList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=462}
2019-11-20 15:27:49.599 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.deviceTypeList   : ==>  Preparing: select DISTINCT DDI_Type as paramKey , DDI_Type as paramValue from t_device_device_info 
2019-11-20 15:27:49.599 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.deviceTypeList   : ==> Parameters: 
2019-11-20 15:27:49.608 DEBUG 100696 --- [http-nio-8812-exec-3] c.i.d.r.RainbowParamDao.deviceTypeList   : <==      Total: 6
2019-11-20 15:27:49.608  INFO 100696 --- [http-nio-8812-exec-3] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|deviceTypeList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=6}
2019-11-20 15:27:49.608 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.r.RainbowParamDao.channelList      : ==>  Preparing: select DISTINCT ATOP_Uid as paramKey, ATOP_Title as paramValue from netfiance_db.t_shop_agent_top 
2019-11-20 15:27:49.608 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.r.RainbowParamDao.channelList      : ==> Parameters: 
2019-11-20 15:27:49.828 DEBUG 100696 --- [http-nio-8812-exec-4] c.i.d.r.RainbowParamDao.channelList      : <==      Total: 27
2019-11-20 15:27:49.829  INFO 100696 --- [http-nio-8812-exec-4] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowParamController|channelList], request param: [], result : ResponseWrapper{status='2000', message='success', dataSize=27}
2019-11-20 15:27:49.829 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? limit ?,?; 
2019-11-20 15:27:49.829 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 0(Integer), 10(Integer)
2019-11-20 15:27:50.079 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 10
2019-11-20 15:27:50.079 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:27:50.079 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:50.117 DEBUG 100696 --- [http-nio-8812-exec-5] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:27:50.118  INFO 100696 --- [http-nio-8812-exec-5] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', totalCount=392, dataSize=10}
2019-11-20 15:27:51.465  INFO 100696 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"M3051500100043","shopValue":"10893","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:27:51.465 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:27:51.466 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:27:51.475 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:27:51.475 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:27:51.476 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 10893(String)
2019-11-20 15:27:51.690 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:27:51.691 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:27:51.692 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), M3051500100043(String), 10893(String)
2019-11-20 15:27:51.703 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:27:51.704 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:27:51.704 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 10893(String), M3051500100043(String)
2019-11-20 15:27:51.725 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:27:51.726 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:27:51.726 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:52.579 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 1
2019-11-20 15:27:52.580 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:27:52.580 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:53.467 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:27:53.468 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:27:53.469 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:53.777 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:27:53.778 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:27:53.778 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 10893(String), M3051500100043(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:27:54.659 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:27:54.660 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:27:54.661 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:54.672 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 0
2019-11-20 15:27:54.672 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:27:54.672 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: M3051500100043(String), 10893(String)
2019-11-20 15:27:54.682 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 1
2019-11-20 15:27:54.682 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:27:54.682 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:54.692 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 1
2019-11-20 15:27:54.693 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:27:54.693 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:54.712 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:27:54.713 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:27:54.713 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:54.836 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 0
2019-11-20 15:27:54.837 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:27:54.837 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: M3051500100043(String), 10893(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:27:54.874 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:27:54.875 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:27:54.876 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: M3051500100043(String), 10893(String)
2019-11-20 15:27:54.886 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 0
2019-11-20 15:27:54.887 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:27:54.887 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: M3051500100043(String), 10893(String)
2019-11-20 15:27:54.929 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:27:54.930 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() #默认为当日 and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:27:54.930 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 10893(String), M3051500100043(String)
2019-11-20 15:27:54.943 DEBUG 100696 --- [http-nio-8812-exec-6] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 0
2019-11-20 15:27:54.943  INFO 100696 --- [http-nio-8812-exec-6] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"M3051500100043","shopValue":"10893","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[{机器获客总人数=12, SHOP_No=10893, DDI_Type=M, DDI_No=M3051500100043, 启用时间=2019-10-08}], yyzt3_jqrjxgcrs=[{新用户总数=0, 搜索时段内天数=44, 机器日均新购彩人数=0.0000, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], sbjyxx_tk=[], mdsxxx=[{人均消费=, 门店每日人流量=0, 门店类型=建材店, 网点名称=贵杰榆林建材经销部, 所属区域经理=佟贵杰(13683181296), 距公司距离=, 所属区域=顺义区, 详细地址=顺义区北小营镇榆林村, 所属商圈=, 网点编号=10893}], sbjyxx_xs=[{设备编号=M3051500100043, 累计订单数（单）=65, 累计销售额（元）=585, 累计销售票数（张）=117, 启用时间=2019-10-08, 网点编号=10893}], sbjyxx_drxs=[], yyzt1=[{所属渠道=风锐, 合作类型=托管自营, 设备编号=M3051500100043, 目前门店状态=运营中, 网点申请时间=2019-08-14 00:00:00.0, 设备启用时间=2019-10-08, 网点编号=10893}], sbwhtj3=[], yyzt2=[{日均开机时长（小时）=4.7, 累计开机天数=29, 月均关机天数=7.5000, 设备累计开机时间（时）=137.3, 启用时间=2019-10-08, 累计关机天数=15, 机器编号=M3051500100043, 网点编号=10893}], sbjyxx_tkddbl=[{退款订单比率=0.0000, 设备编号=M3051500100043, 启用时间=2019-10-08, 网点编号=10893}], yyzt3_jqrjfgrs=[{搜索时段内天数=44, 复购用户总数=12, 机器日均复购人数=0.2727, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], sbwhtj5=[{票仓=1, 加仓次数=3, 设备=M3051500100043}], sbwhtj4=[{设备编码=M3051500100043, 机头编号=1, 实时余量=9, 仓内票种=5倍惊喜, 网点编码=10893, 票种金额=5, 启用时间=2019-10-08}], sbjyxx_drpzxl=[], jqsxxx=[{设备位置=顺义区北小营镇榆林村, 设备类型=M, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=0.2727, 查询时段内运营天数=44, 启用时间=2019-10-08, 机器编号=M3051500100043, 网点编号=10893}], sbjyxx_drtk=[]}}
2019-11-20 15:28:07.468  INFO 100696 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}]
2019-11-20 15:28:07.469 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号, DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? limit ?,?; 
2019-11-20 15:28:07.469 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String), 0(Integer), 10(Integer)
2019-11-20 15:28:07.478 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.RainbowDjqdatjDao.jqsxxx_list    : <==      Total: 1
2019-11-20 15:28:07.479 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : ==>  Preparing: select count(a.DDI_No) from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:28:07.480 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 43056(String)
2019-11-20 15:28:07.488 DEBUG 100696 --- [http-nio-8812-exec-7] c.i.d.r.R.jqsxxx_list_count              : <==      Total: 1
2019-11-20 15:28:07.489  INFO 100696 --- [http-nio-8812-exec-7] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx], request param: [10, 0, {"startDate":"2019-01-01","endDate":"2019-11-20","shopValue":"43056"}], result : ResponseWrapper{status='2000', message='success', totalCount=1, dataSize=1}
2019-11-20 15:28:09.465  INFO 100696 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}]
2019-11-20 15:28:09.466 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==>  Preparing: select a.DDI_No 机器编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 启用时间,c.SHOP_Address 设备位置,b.DDI_Type 设备类型 from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info c on a.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_Uid = d.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and a.DDI_No = ? and a.SHOP_No = ? #and a.DDI_No = '{{设备编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' LIMIT 1 
2019-11-20 15:28:09.466 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:28:09.476 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.jqsxxx   : <==      Total: 1
2019-11-20 15:28:09.476 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==>  Preparing: select a.SHOP_No 网点编号,a.SHOP_Title 网点名称,a.SHOP_Address 详细地址,c.SHOP_Area 所属区域,a.SHOP_Position GIS位置,t.DICT_Name 门店类型,c.SHOP_Traffic 门店每日人流量,c.SHOP_Consume 人均消费,c.SHOP_Distance 距公司距离,c.SHOP_ShoppingCenter 所属商圈,c.SHOP_OpenTime 网点开门时间,c.SHOP_CloseTime 网点关门时间,c.SHOP_AreaManager 所属区域经理,c.SHOP_Withdraw 撤店时间 from netfiance_db.t_shop_shop_info a left join study.t_shop_sub_info c on a.SHOP_Uid = c.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON a.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join t_device_device_info d on d.DDI_SPUid = a.SHOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = a.SHOP_Class where 1=1 and a.SHOP_No = ? #where a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and d.DDI_Type = '{{ 设备类型 }}' #and a.SHOP_No = '{{ 网点编号 }}' #and date(a.CreateDate) >='{{ 起始时间 }}' and date(a.CreateDate) <='{{ 截止时间 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and c.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:28:09.477 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : ==> Parameters: 43056(String)
2019-11-20 15:28:09.690 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.mdsxxx   : <==      Total: 1
2019-11-20 15:28:09.691 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==>  Preparing: select a.DDI_No 设备编号,a.SHOP_No 网点编号,DATE_FORMAT(a.DSI_Try, '%Y-%m-%d') 设备启用时间,d.SHOP_Apply 网点申请时间,a.DSI_Withdraw 设备撤出时间, m.DICT_Name 设备目前状态,t.DICT_Name '目前门店状态',g.ATOP_Title 所属渠道,q.DICT_Name 合作类型 from study.t_device_sub_info a left join netfiance_db.t_shop_shop_info b on a.SHOP_No = b.SHOP_No left join t_device_device_info c on c.DDI_No = a.DDI_No left join study.t_shop_sub_info d on a.SHOP_No = d.SHOP_No left join netfiance_db.t_shop_device_list n on n.DVLS_Uid = c.DDI_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON b.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) m on m.DICT_Value = n.DVLS_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_state' ) t on t.DICT_Value = b.SHOP_State left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = b.SHOP_Class left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_type' ) q on q.DICT_Value = b.SHOP_Type where 1=1 and date(a.DSI_Try) >= ? and date(a.DSI_Try) <= ? and c.DDI_No = ? and a.SHOP_No = ? #and a.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and c.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' 
2019-11-20 15:28:09.691 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : ==> Parameters: 2019-01-01(String), 2019-11-20(String), D1012400200188(String), 43056(String)
2019-11-20 15:28:09.700 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt1  : <==      Total: 1
2019-11-20 15:28:09.701 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==>  Preparing: select b.DDI_No 机器编号,c.SHOP_No 网点编号,date(e.DSI_Try) 启用时间,round(sum(a.DOL_Length)/60, 1) 设备累计开机时间（时）,count(distinct(date(a.DOL_Start))) 累计开机天数,round(sum(a.DOL_Length)/60/count(distinct(date(a.DOL_Start))),1) '日均开机时长（小时）', timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))) '累计关机天数',(timestampdiff(day,date(e.DSI_Try),curdate())+1-count(distinct(date(a.DOL_Start))))/(timestampdiff(month,date(e.DSI_Try),curdate())+1) '月均关机天数' from t_device_online_list a left join t_device_device_info b on a.DOL_DUid = b.DDI_Uid left join study.t_device_sub_info e on b.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info c on e.SHOP_No = c.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON c.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info d on c.SHOP_No = d.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = c.SHOP_Class where DOL_Length <> 0 and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and c.SHOP_No = ? and b.DDI_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and d.SHOP_Area = '{{ 所属地区 }}' group by SHOP_Title,b.DDI_No,启用时间 
2019-11-20 15:28:09.701 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:28:09.721 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.dao.rainbow.RainbowDjqdatjDao.yyzt2  : <==      Total: 1
2019-11-20 15:28:09.722 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==>  Preparing: select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 机器获客总人数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and g.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 
2019-11-20 15:28:09.722 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : ==> Parameters: 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:28:09.732 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.yyzt3_jqhkzrs  : <==      Total: 0
2019-11-20 15:28:09.754 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==>  Preparing: select DDI_No 机器编号, SHOP_No 网点编号, 启用时间, tol_user 累计购彩人数, 搜索时段内天数 查询时段内运营天数,tol_user/搜索时段内天数 机器日均购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) tol_user, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and g.SHOP_Area = '{{ 所属地区 }}' #and d.SHOP_No = '{{ 所属门店 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:28:09.755 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjgcrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:28:10.687 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjgcrs                 : <==      Total: 1
2019-11-20 15:28:10.688 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,新用户总数,搜索时段内天数,新用户总数/搜索时段内天数 机器日均新购彩人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 新用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate <= h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:28:10.688 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjxgcrs                : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:28:11.037 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjxgcrs                : <==      Total: 1
2019-11-20 15:28:11.037 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==>  Preparing: select DDI_No 机器编号,SHOP_No 网点编号, 启用时间,复购用户总数, 搜索时段内天数,复购用户总数/搜索时段内天数 机器日均复购人数 from ( select first_sub.DDI_No,first_sub.SHOP_No,first_sub.dt 启用时间,DDI_Type,ifnull(count(distinct(ODER_USUid)),0) 复购用户总数, case when first_sub.dt>=? and first_sub.draw_dt>=? then datediff(?,first_sub.dt)+1 when first_sub.dt>=? and first_sub.draw_dt <? then datediff(first_sub.draw_dt,first_sub.dt)+1 when first_sub.draw_dt <? then 0 when first_sub.dt <? and first_sub.draw_dt >= ? and first_sub.draw_dt < ? then datediff(first_sub.draw_dt,?)+1 when first_sub.dt <? and first_sub.draw_dt >=? then datediff(?,?)+1 when first_sub.dt>? then 0 end as 搜索时段内天数 #需判断查询起始时间、截止时间，与设备开启时间、撤机时间之间的关系 from (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,ifnull(date(a.DSI_Withdraw),now()) draw_dt,b.DDI_Type from study.t_device_sub_info a left join t_device_device_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info d on d.SHOP_No = a.SHOP_No left join netfiance_db.t_shop_agent_list e on d.SHOP_AGUid = e.AGNT_Uid left join netfiance_db.t_shop_agent_top f on e.AGNT_ATUid = f.ATOP_Uid left join study.t_shop_sub_info g on a.SHOP_No = g.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = d.SHOP_Class where a.DSI_Anti is null and d.SHOP_No = ? and a.DDI_No = ? #and b.DDI_Type = '{{设备类型}}' #and f.ATOP_Title = {{选择渠道}} #and a.DDI_No = '{{设备编码}}' #and d.SHOP_No = '{{ 所属门店 }}' #and g.SHOP_Area = '{{ 所属地区 }}' #and t.DICT_Name = '{{ 网点类型 }}' order by dt) first_sub #每台机器在网点真实开启时间 left join (select a.DDI_No,a.SHOP_No,date(a.DSI_Try) dt,e.ODER_Uid,e.ODER_USUid from t_shop_order_info e left join t_device_device_info b on e.ODER_DUid = b.DDI_Uid left join study.t_device_sub_info a on b.DDI_No = a.DDI_No left join t_customer_user_info h on e.ODER_USUid = h.USER_Uid where date(e.CreateDate)>=? and date(e.CreateDate) <=? and e.ODER_State = 0 and e.CreateDate > h.CreateDate and e.CreateDate >= a.DSI_Try and (e.CreateDate <= a.DSI_Withdraw or a.DSI_Withdraw is null) ) order_detail on first_sub.DDI_No = order_detail.DDI_No and first_sub.SHOP_No = order_detail.SHOP_No and first_sub.dt = order_detail.dt where first_sub.dt <=? group by DDI_No,SHOP_No,启用时间 )t 
2019-11-20 15:28:11.038 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjfgrs                 : ==> Parameters: 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-01-01(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String), 2019-01-01(String), 2019-11-20(String), 43056(String), D1012400200188(String), 2019-01-01(String), 2019-11-20(String), 2019-11-20(String)
2019-11-20 15:28:11.925 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.R.yyzt3_jqrjfgrs                 : <==      Total: 1
2019-11-20 15:28:11.926 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==>  Preparing: select DATE_FORMAT(a.updated_at, '%Y-%m-%d %H:%i:%s') 加仓时间, DATE_FORMAT(a.created_at, '%Y-%m-%d %H:%i:%s') as 出库日期, k.DDI_No as 设备,k.SHOP_No 网点编号,date(k.DSI_Try) 启用时间,a.package_no as 出库包裹号,e.COUP_Title 彩票名称,e.COUP_Money*b.lottery_count*count(a.package_no) 加票额度（元） ,e.COUP_Money 票种面额（元）, b.lottery_count*count(a.package_no) as 加票张数, c.user_nickname as 姓名 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_customer_user_info c on a.delivery_id = c.user_uid left join t_customer_coupon_sub_info d on left(b.lottery_start_id,5) = d.COUPS_Prefix left join t_customer_coupon_info e on d.COUPS_CPUid = e.COUP_Uid left join t_device_device_info h on a.device_no = h.DDI_No left join study.t_device_sub_info k on h.DDI_No = k. DDI_No left join netfiance_db.t_shop_shop_info i on k.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where a.updated_at >= k.DSI_Try and (a.updated_at <= k.DSI_Withdraw or k.DSI_Withdraw is null) and k.DSI_Anti is null and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by a.package_no,e.COUP_Title order by a.created_at 
2019-11-20 15:28:11.926 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:28:11.936 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj3  : <==      Total: 2
2019-11-20 15:28:11.937 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==>  Preparing: select c.DDI_No 设备编码,c.SHOP_No 网点编码,DSL_No 机头编号,date(c.DSI_Try) 启用时间,d.COUP_Title 仓内票种,d.COUP_Money 票种金额,a.DSL_Count 实时余量 from t_device_sub_list a left join t_device_device_info b on a.DSL_DUid = b.DDI_Uid left join study.t_device_sub_info c on b.DDI_No = c.DDI_No join t_customer_coupon_info d on a.DSL_CPUid = d.COUP_Uid left join netfiance_db.t_shop_shop_info i on c.SHOP_No= i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where c.DSI_Anti is null and a.ModifyDate >= c.DSI_Try and (a.ModifyDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and b.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and b.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' order by 设备编码,DSL_No 
2019-11-20 15:28:11.937 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:28:11.948 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj4  : <==      Total: 2
2019-11-20 15:28:11.948 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==>  Preparing: select device_no as 设备,c.DSL_No 票仓,count(distinct(a.package_no)) as 加仓次数 from t_storage_checkout_packages a join t_storage_checkout_packages_detail b on a.package_no = b.package_no left join t_device_sub_list c on c.DSL_Uid = b.warehouse_id left join t_device_device_info h on a.device_no = h.DDI_No left join netfiance_db.t_shop_shop_info i on h.DDI_SPUid = i.SHOP_Uid LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) t on t.DICT_Value = i.SHOP_Class where 1 = 1 and h.DDI_No = ? and i.SHOP_No = ? and date(a.updated_at) >= ? and date(a.updated_at) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and t.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by device_no,c.DSL_No 
2019-11-20 15:28:11.948 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:28:11.958 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.rainbow.RainbowDjqdatjDao.sbwhtj5  : <==      Total: 2
2019-11-20 15:28:11.958 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 累计销售额（元）,sum(b.ODDT_Count) 累计销售票数（张）,count(distinct(a.ODER_Uid)) 累计订单数（单） from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and c.DDI_No = ? and c.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:28:11.959 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:28:11.972 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_xs      : <==      Total: 1
2019-11-20 15:28:11.973 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 累计退款订单数,sum(a.FLRF_RefundMoney) 累计退款额,count(distinct(c.ODER_USUid)) 累计退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and d.DDI_No = ? and i.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:28:11.973 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:28:11.996 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tk      : <==      Total: 1
2019-11-20 15:28:11.996 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==>  Preparing: select d.DDI_No 设备编号,d.SHOP_No 网点编号,date(d.DSI_Try) 启用时间,count(distinct(c.FLRF_Uid))/count(distinct(a.ODER_Uid)) 退款订单比率 from t_shop_order_info a left join netfiance_db.t_finance_bank_flow b on a.ODER_Note = b.FLOW_OrderId left join netfiance_db.t_finance_bank_refund c on b.FLOW_Uid = c.FLRF_FLUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info d on h.DDI_No = d.DDI_No left join netfiance_db.t_shop_shop_info i on d.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where d.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= d.DSI_Try and (a.CreateDate <= d.DSI_Withdraw or d.DSI_Withdraw is null) and d.DDI_No = ? and d.SHOP_No = ? and date(a.CreateDate) >= ? and date(a.CreateDate) <= ? #and d.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间 
2019-11-20 15:28:11.997 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : ==> Parameters: D1012400200188(String), 43056(String), 2019-01-01(String), 2019-11-20(String)
2019-11-20 15:28:12.019 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_tkddbl  : <==      Total: 1
2019-11-20 15:28:12.020 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==>  Preparing: select c.DDI_No 设备编号,c.SHOP_No 网点编号,date(c.DSI_Try) 启用时间,sum(b.ODDT_Money*b.ODDT_Count) 当日销售额（元）,sum(b.ODDT_Count) 当日销售票数（张）,count(distinct(a.ODER_Uid)) 当日订单数（单）,max(a.ODER_Money) 当日最大订单额度 from t_shop_order_info a left join t_shop_order_detail b on a.ODER_Uid = b.ODDT_ODUid left join t_device_device_info h on a.ODER_DUid = h.DDI_Uid left join study.t_device_sub_info c on c.DDI_No = h.DDI_No left join netfiance_db.t_shop_shop_info i on c.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.DSI_Anti is null and a.ODER_State = 0 and a.CreateDate >= c.DSI_Try and (a.CreateDate <= c.DSI_Withdraw or c.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and c.DDI_No = ? and c.SHOP_No = ? #and c.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间; 
2019-11-20 15:28:12.020 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:28:12.033 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drxs    : <==      Total: 1
2019-11-20 15:28:12.033 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==>  Preparing: select e.DDI_No 设备编号,e.SHOP_No 网点编号,date(e.DSI_Try) 启动时间,count(distinct(c.ODER_Uid)) 当日退款订单数,sum(a.FLRF_RefundMoney) 当日退款额,count(distinct(c.ODER_USUid)) 当日退款人数 from netfiance_db.t_finance_bank_refund a left join netfiance_db.t_finance_bank_flow b on a.FLRF_FLUid = b.FLOW_Uid left join t_shop_order_info c on b.FLOW_OrderId = c.ODER_Note left join t_device_device_info d on c.ODER_DUid = d.DDI_Uid left join study.t_device_sub_info e on d.DDI_No = e.DDI_No left join netfiance_db.t_shop_shop_info i on e.SHOP_No = i.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON i.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = i.SHOP_Class left join study.t_shop_sub_info j on i.SHOP_No = j.SHOP_No where c.ODER_State = 0 and e.DSI_Anti is null and a.CreateDate >= e.DSI_Try and (a.CreateDate <= e.DSI_Withdraw or e.DSI_Withdraw is null) and date(a.CreateDate) = curdate() and d.DDI_No = ? and i.SHOP_No = ? #and i.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and h.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启动时间 
2019-11-20 15:28:12.034 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : ==> Parameters: D1012400200188(String), 43056(String)
2019-11-20 15:28:12.047 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drtk    : <==      Total: 0
2019-11-20 15:28:12.047 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==>  Preparing: select b.DDI_No 设备编号,b.SHOP_No 网点编号,date(b.DSI_Try) 启用时间,o.COUP_Title as 票种名称,o.COUP_Money 票种单价,sum(m.ODDT_Count) 累计销售张数,sum(o.COUP_Money*m.ODDT_Count) 累计销售金额 from t_shop_order_detail m join t_shop_order_info n on n.ODER_Uid = m.ODDT_ODUid join t_customer_coupon_info o on m.ODDT_LTUid=o.COUP_Uid left join t_device_device_info a on n.ODER_DUid = a.DDI_Uid left join study.t_device_sub_info b on a.DDI_No = b.DDI_No left join netfiance_db.t_shop_shop_info e on b.SHOP_No = e.SHOP_No LEFT JOIN netfiance_db.t_shop_agent_list f ON e.SHOP_AGUid = f.AGNT_Uid LEFT JOIN netfiance_db.t_shop_agent_top g ON f.AGNT_ATUid = g.ATOP_Uid left join (select DICT_Value,DICT_Name from netfiance_db.t_sys_dictionary_info where DICT_Field = 'shop_class' ) p on p.DICT_Value = e.SHOP_Class left join study.t_shop_sub_info j on e.SHOP_No = j.SHOP_No where date(n.CreateDate) = curdate() #默认为当日 and ODER_State = 0 and b.DSI_Anti is null and n.CreateDate >= b.DSI_Try and (n.CreateDate <= b.DSI_Withdraw or b.DSI_Withdraw is null) and e.SHOP_No = ? and a.DDI_No = ? #and e.SHOP_No = '{{门店编码}}' #and g.ATOP_Title = '{{ 渠道名称 }}' #and a.DDI_Type = '{{ 设备类型 }}' #and p.DICT_Name = '{{ 网点类型 }}' #and j.SHOP_Area = '{{ 所属地区 }}' group by 设备编号,网点编号,启用时间,票种名称 
2019-11-20 15:28:12.048 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : ==> Parameters: 43056(String), D1012400200188(String)
2019-11-20 15:28:12.060 DEBUG 100696 --- [http-nio-8812-exec-8] c.i.d.r.RainbowDjqdatjDao.sbjyxx_drpzxl  : <==      Total: 2
2019-11-20 15:28:12.060  INFO 100696 --- [http-nio-8812-exec-8] c.i.a.handler.InterestLogAspect          : [com.interest.controller.rainbow.RainbowDjqdatjController|jqsxxx_detail], request param: [{"ddiNo":"D1012400200188","shopValue":"43056","startDate":"2019-01-01","endDate":"2019-11-20"}], result : ResponseWrapper{status='2000', message='success', data={yyzt3_jqhkzrs=[], yyzt3_jqrjxgcrs=[{新用户总数=10, 搜索时段内天数=2, 机器日均新购彩人数=5.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tk=[{启动时间=2019-11-19, 累计退款订单数=2, 设备编号=D1012400200188, 累计退款人数=1, 累计退款额=10.0, 网点编号=43056}], mdsxxx=[{门店类型=移动营业厅, 网点名称=东大桥营业厅, 详细地址=北京市朝阳区工体东路18号中复大厦一层, 网点编号=43056}], sbjyxx_xs=[{设备编号=D1012400200188, 累计订单数（单）=26, 累计销售额（元）=280, 累计销售票数（张）=35, 启用时间=2019-11-19, 网点编号=43056}], sbjyxx_drxs=[{设备编号=D1012400200188, 当日订单数（单）=14, 启用时间=2019-11-19, 网点编号=43056, 当日销售额（元）=165, 当日销售票数（张）=20, 当日最大订单额度=30}], yyzt1=[{所属渠道=北京移动直营, 合作类型=全自营, 设备编号=D1012400200188, 目前门店状态=运营中, 设备启用时间=2019-11-19, 网点编号=43056}], sbwhtj3=[{出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=好运十倍, 票种面额（元）=10, 设备=D1012400200188, 加票张数=150, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1500}, {出库日期=2019-11-19 10:57:00, 姓名=lost., 加仓时间=2019-11-19 11:01:03, 出库包裹号=PNe19ea3cd981b206829, 彩票名称=7乐无穷, 票种面额（元）=5, 设备=D1012400200188, 加票张数=200, 启用时间=2019-11-19, 网点编号=43056, 加票额度（元）=1000}], yyzt2=[{日均开机时长（小时）=6.3, 累计开机天数=2, 月均关机天数=0.0000, 设备累计开机时间（时）=12.5, 启用时间=2019-11-19, 累计关机天数=0, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_tkddbl=[{退款订单比率=0.0769, 设备编号=D1012400200188, 启用时间=2019-11-19, 网点编号=43056}], yyzt3_jqrjfgrs=[{搜索时段内天数=2, 复购用户总数=6, 机器日均复购人数=3.0000, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbwhtj5=[{票仓=1, 加仓次数=1, 设备=D1012400200188}, {票仓=2, 加仓次数=1, 设备=D1012400200188}], sbwhtj4=[{设备编码=D1012400200188, 机头编号=1, 实时余量=129, 仓内票种=好运十倍, 网点编码=43056, 票种金额=10, 启用时间=2019-11-19}, {设备编码=D1012400200188, 机头编号=2, 实时余量=186, 仓内票种=7乐无穷, 网点编码=43056, 票种金额=5, 启用时间=2019-11-19}], sbjyxx_drpzxl=[{累计销售张数=7, 票种单价=5, 设备编号=D1012400200188, 累计销售金额=35, 票种名称=7乐无穷, 启用时间=2019-11-19, 网点编号=43056}, {累计销售张数=13, 票种单价=10, 设备编号=D1012400200188, 累计销售金额=130, 票种名称=好运十倍, 启用时间=2019-11-19, 网点编号=43056}], jqsxxx=[{设备位置=北京市朝阳区工体东路18号中复大厦一层, 设备类型=D, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], yyzt3_jqrjgcrs=[{累计购彩人数=12, 机器日均购彩人数=6.0000, 查询时段内运营天数=2, 启用时间=2019-11-19, 机器编号=D1012400200188, 网点编号=43056}], sbjyxx_drtk=[]}}
2019-11-20 15:30:58.921  INFO 100696 --- [Thread-9] o.s.s.c.ThreadPoolTaskScheduler          : Shutting down ExecutorService 'taskScheduler'
2019-11-20 15:30:58.926  INFO 100696 --- [Thread-9] c.a.icatch.imp.TransactionServiceImp     : Transaction Service: Entering shutdown (false, 9223372036854775807)...
2019-11-20 15:30:58.942  INFO 100696 --- [Thread-9] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2019-11-20 15:30:58.946  INFO 100696 --- [Thread-9] c.a.datasource.pool.ConnectionPool       : atomikos connection pool 'rainbowDataSource': destroying pool...
2019-11-20 15:30:58.947  INFO 100696 --- [Thread-9] c.a.datasource.pool.ConnectionPool       : atomikos connection pool 'masterDataSource': destroying pool...
2019-11-20 15:31:19.070  INFO 100696 --- [restartedMain] com.interest.WhSpringBootApplication     : No active profile set, falling back to default profiles: default
2019-11-20 15:31:19.070  INFO 100696 --- [restartedMain] o.s.core.annotation.AnnotationUtils      : Failed to introspect annotations on class com.interest.WhSpringBootApplication: java.lang.ArrayStoreException: sun.reflect.annotation.TypeNotPresentExceptionProxy
2019-11-20 15:31:19.070 ERROR 100696 --- [restartedMain] o.s.boot.SpringApplication               : Application run failed

java.lang.ArrayStoreException: sun.reflect.annotation.TypeNotPresentExceptionProxy
	at sun.reflect.annotation.AnnotationParser.parseClassArray(AnnotationParser.java:724) ~[na:1.8.0_151]
	at sun.reflect.annotation.AnnotationParser.parseArray(AnnotationParser.java:531) ~[na:1.8.0_151]
	at sun.reflect.annotation.AnnotationParser.parseMemberValue(AnnotationParser.java:355) ~[na:1.8.0_151]
	at sun.reflect.annotation.AnnotationParser.parseAnnotation2(AnnotationParser.java:286) ~[na:1.8.0_151]
	at sun.reflect.annotation.AnnotationParser.parseAnnotations2(AnnotationParser.java:120) ~[na:1.8.0_151]
	at sun.reflect.annotation.AnnotationParser.parseAnnotations(AnnotationParser.java:72) ~[na:1.8.0_151]
	at java.lang.Class.createAnnotationData(Class.java:3521) ~[na:1.8.0_151]
	at java.lang.Class.annotationData(Class.java:3510) ~[na:1.8.0_151]
	at java.lang.Class.getAnnotations(Class.java:3446) ~[na:1.8.0_151]
	at org.springframework.core.type.StandardAnnotationMetadata.<init>(StandardAnnotationMetadata.java:70) ~[spring-core-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.beans.factory.annotation.AnnotatedGenericBeanDefinition.<init>(AnnotatedGenericBeanDefinition.java:58) ~[spring-beans-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.context.annotation.AnnotatedBeanDefinitionReader.doRegisterBean(AnnotatedBeanDefinitionReader.java:216) ~[spring-context-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.context.annotation.AnnotatedBeanDefinitionReader.registerBean(AnnotatedBeanDefinitionReader.java:145) ~[spring-context-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.context.annotation.AnnotatedBeanDefinitionReader.register(AnnotatedBeanDefinitionReader.java:135) ~[spring-context-5.1.2.RELEASE.jar:5.1.2.RELEASE]
	at org.springframework.boot.BeanDefinitionLoader.load(BeanDefinitionLoader.java:158) ~[spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.BeanDefinitionLoader.load(BeanDefinitionLoader.java:135) ~[spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.BeanDefinitionLoader.load(BeanDefinitionLoader.java:127) ~[spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.load(SpringApplication.java:717) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.prepareContext(SpringApplication.java:392) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:314) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1260) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1248) [spring-boot-2.1.0.RELEASE.jar:2.1.0.RELEASE]
	at com.interest.WhSpringBootApplication.main(WhSpringBootApplication.java:21) [classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_151]
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) [spring-boot-devtools-2.1.0.RELEASE.jar:2.1.0.RELEASE]

2019-11-20 15:31:29.748  INFO 100696 --- [restartedMain] com.interest.WhSpringBootApplication     : No active profile set, falling back to default profiles: default
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleCommentDao' and 'com.interest.dao.master.ArticleCommentDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'articleDao' and 'com.interest.dao.master.ArticleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'emailDao' and 'com.interest.dao.master.EmailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'interestDao' and 'com.interest.dao.master.InterestDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'menuDao' and 'com.interest.dao.master.MenuDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'msgRecordsDao' and 'com.interest.dao.master.MsgRecordsDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'postCardDao' and 'com.interest.dao.master.PostCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'relationDao' and 'com.interest.dao.master.RelationDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'replyCardDao' and 'com.interest.dao.master.ReplyCardDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'roleDao' and 'com.interest.dao.master.RoleDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDao' and 'com.interest.dao.master.UserDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userDetailDao' and 'com.interest.dao.master.UserDetailDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userGithubDao' and 'com.interest.dao.master.UserGithubDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'userQQDao' and 'com.interest.dao.master.UserQQDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowDjqdatjDao' and 'com.interest.dao.rainbow.RainbowDjqdatjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowKcqktjDao' and 'com.interest.dao.rainbow.RainbowKcqktjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowParamDao' and 'com.interest.dao.rainbow.RainbowParamDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRbbxhDao' and 'com.interest.dao.rainbow.RainbowRbbxhDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowRxstjDao' and 'com.interest.dao.rainbow.RainbowRxstjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowSrtjDao' and 'com.interest.dao.rainbow.RainbowSrtjDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.246  WARN 100696 --- [restartedMain] o.m.s.mapper.ClassPathMapperScanner      : Skipping MapperFactoryBean with name 'rainbowYjzbDao' and 'com.interest.dao.rainbow.RainbowYjzbDao' mapperInterface. Bean already defined with the same name!
2019-11-20 15:31:31.511  INFO 100696 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2019-11-20 15:31:31.511  INFO 100696 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.
2019-11-20 15:31:31.589  INFO 100696 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 78ms. Found 0 repository interfaces.
2019-11-20 15:31:31.808  INFO 100696 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ceed9656-147b-39fe-b78a-60d556f9d2a8
2019-11-20 15:31:31.870  INFO 100696 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$dcfad5a3] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:31:31.901  INFO 100696 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$f914d8a0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-11-20 15:31:32.042 ERROR 100696 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:31:32.213  INFO 100696 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8812 (http)
2019-11-20 15:31:32.213 ERROR 100696 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:31:32.213  INFO 100696 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-11-20 15:31:32.213  INFO 100696 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/9.0.12
2019-11-20 15:31:32.213 ERROR 100696 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : An incompatible version [1.1.32] of the APR based Apache Tomcat Native library is installed, while Tomcat requires version [1.2.14]
2019-11-20 15:31:32.306  INFO 100696 --- [restartedMain] o.a.c.c.C.[.[localhost].[/interest]      : Initializing Spring embedded WebApplicationContext
2019-11-20 15:31:32.306  INFO 100696 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 2558 ms
2019-11-20 15:31:32.535  WARN 100696 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'masterDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:31:32.644  WARN 100696 --- [restartedMain] c.atomikos.jdbc.AbstractDataSourceBean   : AtomikosDataSoureBean 'rainbowDataSource': poolSize equals default - this may cause performance problems!
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'webMvcMetricsFilter' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'formContentFilter' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] .s.DelegatingFilterProxyRegistrationBean : Mapping filter: 'springSecurityFilterChain' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpTraceFilter' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'corsFilter' to: [/*]
2019-11-20 15:31:32.940  INFO 100696 --- [restartedMain] o.s.b.w.servlet.ServletRegistrationBean  : Servlet dispatcherServlet mapped to [/]
2019-11-20 15:31:33.159  INFO 100696 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2019-11-20 15:31:33.767  WARN 100696 --- [restartedMain] o.s.s.o.p.t.s.JwtAccessTokenConverter    : Unable to create an RSA verifier from verifierKey (ignoreable if using MAC)
2019-11-20 15:31:34.266  INFO 100696 --- [restartedMain] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2019-11-20 15:31:34.391  INFO 100696 --- [restartedMain] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2019-11-20 15:31:34.531  INFO 100696 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: OrRequestMatcher [requestMatchers=[Ant [pattern='/oauth/token'], Ant [pattern='/oauth/token_key'], Ant [pattern='/oauth/check_token']]], [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1177625, org.springframework.security.web.context.SecurityContextPersistenceFilter@502f7bab, org.springframework.security.web.header.HeaderWriterFilter@2385408e, org.springframework.security.web.authentication.logout.LogoutFilter@94b224f, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@665bb512, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@59d509c8, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@505db34c, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@53db74be, org.springframework.security.web.session.SessionManagementFilter@346db45c, org.springframework.security.web.access.ExceptionTranslationFilter@6eece3ed, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@19f02023]
2019-11-20 15:31:34.563  INFO 100696 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfiguration$NotOAuthRequestMatcher@59e636f6, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6ce38daa, org.springframework.security.web.context.SecurityContextPersistenceFilter@4a32c38c, org.springframework.security.web.header.HeaderWriterFilter@d22b9, org.springframework.web.filter.CorsFilter@31c132c2, org.springframework.security.web.authentication.logout.LogoutFilter@6d722d27, org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter@581e86b4, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@d5d99b6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@64ac7a4e, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@16d69751, org.springframework.security.web.session.SessionManagementFilter@d308cf0, org.springframework.security.web.access.ExceptionTranslationFilter@41b0d317, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@2e0b088b]
2019-11-20 15:31:34.563  INFO 100696 --- [restartedMain] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@26082dbc, org.springframework.security.web.context.SecurityContextPersistenceFilter@517cd332, org.springframework.security.web.header.HeaderWriterFilter@44a88316, org.springframework.security.web.authentication.logout.LogoutFilter@5fa118d0, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@4f763da3, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@68f3b3bf, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@76289f53, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@38ddb4f9, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@38ed30c7, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@559ae011, org.springframework.security.web.session.SessionManagementFilter@2ddfa23f, org.springframework.security.web.access.ExceptionTranslationFilter@7ca2ad41, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@31d24877]
2019-11-20 15:31:34.812  INFO 100696 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2019-11-20 15:31:34.921  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Loaded jar:file:/C:/Users/SunTH/.m2/repository/com/atomikos/transactions/4.0.6/transactions-4.0.6.jar!/transactions-defaults.properties
2019-11-20 15:31:34.937  WARN 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Thanks for using Atomikos! Evaluate http://www.atomikos.com/Main/ExtremeTransactions for advanced features and professional support
or register at http://www.atomikos.com/Main/RegisterYourDownload to disable this message and receive FREE tips & advice
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_max_wait_time_on_shutdown = 9223372036854775807
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.allow_subtransactions = true
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.recovery_delay = 10000
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.automatic_resource_registration = true
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_max_retries = 5
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.client_demarcation = false
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.threaded_2pc = false
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.serial_jta_transactions = true
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_dir = E:\workspace\javaEE\interest\interest-server\transaction-logs
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.rmi_export_class = none
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_actives = 50
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.checkpoint_interval = 500
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.enable_logging = true
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.log_base_name = tmlog
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.max_timeout = 300000
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.trust_client_tm = false
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.factory.initial = com.sun.jndi.rmi.registry.RegistryContextFactory
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.tm_unique_name = 192.168.1.31.tm
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.forget_orphaned_log_entries_delay = 86400000
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.oltp_retry_interval = 10000
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: java.naming.provider.url = rmi://localhost:1099
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.force_shutdown_on_vm_exit = false
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : USING: com.atomikos.icatch.default_jta_timeout = 10000
2019-11-20 15:31:34.937  INFO 100696 --- [restartedMain] c.a.icatch.provider.imp.AssemblerImp     : Using default (local) logging and recovery...
2019-11-20 15:31:34.999  INFO 100696 --- [restartedMain] c.a.d.xa.XATransactionalResource         : masterDataSource: refreshed XAResource
2019-11-20 15:31:35.296  INFO 100696 --- [restartedMain] c.a.d.xa.XATransactionalResource         : rainbowDataSource: refreshed XAResource
2019-11-20 15:31:35.530  INFO 100696 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService 'taskScheduler'
2019-11-20 15:31:36.029  INFO 100696 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2019-11-20 15:31:36.029  INFO 100696 --- [restartedMain] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2019-11-20 15:31:36.045  INFO 100696 --- [restartedMain] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2019-11-20 15:31:36.091  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: getArticleUsingGET_1
2019-11-20 15:31:36.154  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadPictureUsingPOST_1
2019-11-20 15:31:36.216  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_1
2019-11-20 15:31:36.357  INFO 100696 --- [restartedMain] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: insertEntityUsingPOST_2
2019-11-20 15:31:36.419  INFO 100696 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8812 (http) with context path '/interest'
2019-11-20 15:31:36.419  INFO 100696 --- [restartedMain] com.interest.WhSpringBootApplication     : Started WhSpringBootApplication in 7.763 seconds (JVM running for 652.463)
2019-11-20 15:31:36.435  INFO 100696 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
