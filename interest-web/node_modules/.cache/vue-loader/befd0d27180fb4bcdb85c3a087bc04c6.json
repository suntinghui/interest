{"remainingRequest":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\workspace\\javaEE\\interest\\interest-web\\src\\views\\mobile\\index.vue?vue&type=style&index=0&id=2308e082&scoped=true&lang=css&","dependencies":[{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\src\\views\\mobile\\index.vue","mtime":1578533570058},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\n.mobild-layout {\r\n  border: 1px solid #d7dde4;\r\n  background: #f5f7f9;\r\n  position: relative;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n}\r\n.mobild-layout .layout-logo {\r\n  /*width: 100px;*/\r\n  /*height: 30px;*/\r\n  /*background: #5b6270;*/\r\n  /*border-radius: 3px;*/\r\n  float: left;\r\n  /*position: relative;*/\r\n  /*top: 15px;\r\n        left: 20px;*/\r\n  margin-top: 7px;\r\n}\r\n.mobild-layout .layout-search {\r\n  height: 30px;\r\n  border-radius: 3px;\r\n  float: left;\r\n  position: relative;\r\n  left: 80px;\r\n}\r\n.mobild-layout .layout-nav {\r\n  /*width: 315px;\r\n        margin: 0 auto;\r\n        margin-right: 20px;*/\r\n  height: inherit;\r\n  float: right;\r\n  font-size: 15px;\r\n  margin-right: 5%;\r\n}\r\n.dropdown-menu {\r\n  text-align: center;\r\n}\r\n.mobild-layout .layout-nav span {\r\n  font-size: 15px;\r\n  color: #c92027;\r\n}\r\n.mobild-layout .layout-footer-center {\r\n  text-align: center;\r\n}\r\n.mobild-layout .demo-spin-icon-load {\r\n  animation: ani-demo-spin 1s linear infinite;\r\n}\r\n\r\n.avatar-badge-wrapper {\r\n  position: relative;\r\n  cursor: pointer;\r\n}\r\n\r\n.avatar-badge-wrapper .msg-num {\r\n  position: absolute;\r\n  top: 9px;\r\n  right: -12px;\r\n  color: #fff !important;\r\n  background-color: #2db7f5;\r\n  border-radius: 50%;\r\n  padding: 2px 5px;\r\n  line-height: 1;\r\n}\r\n\r\n@keyframes ani-demo-spin {\r\n  from {\r\n    transform: rotate(0deg);\r\n  }\r\n  50% {\r\n    transform: rotate(180deg);\r\n  }\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n.layout-title {\r\n  font-size: 20px;\r\n  font-weight: 400;\r\n  position: relative;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  color: rebeccapurple;\r\n  left: 41%;\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/mobile","sourcesContent":["<style scoped>\r\n.mobild-layout {\r\n  border: 1px solid #d7dde4;\r\n  background: #f5f7f9;\r\n  position: relative;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n}\r\n.mobild-layout .layout-logo {\r\n  /*width: 100px;*/\r\n  /*height: 30px;*/\r\n  /*background: #5b6270;*/\r\n  /*border-radius: 3px;*/\r\n  float: left;\r\n  /*position: relative;*/\r\n  /*top: 15px;\r\n        left: 20px;*/\r\n  margin-top: 7px;\r\n}\r\n.mobild-layout .layout-search {\r\n  height: 30px;\r\n  border-radius: 3px;\r\n  float: left;\r\n  position: relative;\r\n  left: 80px;\r\n}\r\n.mobild-layout .layout-nav {\r\n  /*width: 315px;\r\n        margin: 0 auto;\r\n        margin-right: 20px;*/\r\n  height: inherit;\r\n  float: right;\r\n  font-size: 15px;\r\n  margin-right: 5%;\r\n}\r\n.dropdown-menu {\r\n  text-align: center;\r\n}\r\n.mobild-layout .layout-nav span {\r\n  font-size: 15px;\r\n  color: #c92027;\r\n}\r\n.mobild-layout .layout-footer-center {\r\n  text-align: center;\r\n}\r\n.mobild-layout .demo-spin-icon-load {\r\n  animation: ani-demo-spin 1s linear infinite;\r\n}\r\n\r\n.avatar-badge-wrapper {\r\n  position: relative;\r\n  cursor: pointer;\r\n}\r\n\r\n.avatar-badge-wrapper .msg-num {\r\n  position: absolute;\r\n  top: 9px;\r\n  right: -12px;\r\n  color: #fff !important;\r\n  background-color: #2db7f5;\r\n  border-radius: 50%;\r\n  padding: 2px 5px;\r\n  line-height: 1;\r\n}\r\n\r\n@keyframes ani-demo-spin {\r\n  from {\r\n    transform: rotate(0deg);\r\n  }\r\n  50% {\r\n    transform: rotate(180deg);\r\n  }\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n.layout-title {\r\n  font-size: 20px;\r\n  font-weight: 400;\r\n  position: relative;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  color: rebeccapurple;\r\n  left: 41%;\r\n}\r\n</style>\r\n<template>\r\n    <div class=\"mobild-layout\">\r\n    \t<Layout>\r\n            <Header style=\"position: fixed;width: 100%;background:#fff;padding:0 0;z-index: 1000; line-height:0;\">\r\n            \t<div style=\"width: 95%;margin: 0 auto\">\r\n                    <div class=\"layout-logo\">\r\n                        <a @click=\"backHome()\">\r\n                            <img src=\"../../images/logo.jpg\" style=\"width: 50px;height: 50px;\" align=\"absmiddle\" />\r\n                        </a>\r\n                    </div>\r\n                    <!-- <div style=\"height: 64px;float: left;\">\r\n                        <span class=\"layout-title\">interest</span>\r\n                    </div> -->\r\n                    <Dropdown v-if=\"loginFlag\" trigger=\"click\" class=\"layout-nav\" @on-click=\"m=>{dropdownClick(m)}\">\r\n                        <div  type=\"success\" class=\"avatar-badge-wrapper\">\r\n\r\n                            <img style=\"width: 40px;height: 40px; margin-top: 12px;border-radius: 100%;\" :src=\"user.headimg\" />\r\n\r\n                            <span v-if=\"unreadMsgCount > 0\"  class=\"msg-num\">{{unreadMsgCount}}</span>\r\n\r\n                        </div>\r\n\r\n                        <DropdownMenu class=\"dropdown-menu\" slot=\"list\">\r\n                        \t<DropdownItem name=\"name\">\r\n                            \t<Icon type=\"ios-person\"></Icon>\r\n                               \t{{user.name}}\r\n                            </DropdownItem>\r\n                            <DropdownItem name=\"email\" divided>\r\n                            \t<Icon type=\"ios-mail\"></Icon>\r\n                                邮件\r\n                            </DropdownItem>\r\n\r\n                            <DropdownItem name=\"messages\" divided>\r\n                                <Icon type=\"md-chatboxes\"></Icon>\r\n                                消息\r\n                            </DropdownItem>\r\n\r\n                            <DropdownItem name=\"loginOut\" divided>\r\n                            \t<Icon type=\"md-log-out\"></Icon>\r\n                            \t退出\r\n                            </DropdownItem>\r\n                        </DropdownMenu>\r\n                    </Dropdown>\r\n                    <div v-if=\"!loginFlag\" class=\"layout-nav\" style=\"margin-top: 14px;\">\r\n                        <Button shape=\"circle\" @click=\"toLogin()\">\r\n                        \t<span>登录</span>\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </Header>\r\n            <Content :style=\"{margin: '80px 0 0 0', background: '#fff'}\">\r\n                <router-view></router-view>\r\n            </Content>\r\n            <Footer class=\"layout-footer-center\">\r\n                <div>\r\n                    <a href=\"https://github.com/smallsnail-wh\" target=\"_blank\">\r\n                        <Icon  style=\"color: rebeccapurple;\" size=\"40\" type=\"logo-github\"></Icon>\r\n                    </a>\r\n                </div>\r\n                <p>2018-2020 &copy; smallsail-wh</p>\r\n            </Footer>\r\n        </Layout>\r\n\r\n        <Modal :mask-closable=\"false\" :visible.sync=\"emailModal\" :loading = \"loading\" v-model=\"emailModal\" title=\"联系管理员\" @on-ok=\"emailOk('email')\" @on-cancel=\"cancel()\">\r\n             <Form ref=\"email\" :rules=\"emailRule\" :model=\"email\"  :label-width=\"80\" >\r\n                <FormItem label=\"标题\" prop=\"title\">\r\n                    <Input v-model=\"email.title\" placeholder=\"请输入标题\" />\r\n                </FormItem>\r\n                <FormItem label=\"email\" prop=\"email\">\r\n                    <Input v-model=\"email.email\" placeholder=\"请输入email\" />\r\n                </FormItem>\r\n                <FormItem label=\"姓名\" prop=\"name\">\r\n                    <Input v-model=\"email.name\" placeholder=\"请输入姓名\" />\r\n                </FormItem>\r\n                <FormItem label=\"内容\" prop=\"content\">\r\n                    <Input v-model=\"email.content\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\" placeholder=\"Enter something...\" />\r\n                </FormItem>\r\n            </Form>\r\n        </Modal>\r\n    </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      loginFlag: false,\r\n      consoleFlag: false,\r\n      loading: true,\r\n      searchValue: \"\",\r\n      //用户未读消息个数\r\n      unreadMsgCount: 0,\r\n      emailModal: false,\r\n      email: {\r\n        title: \"\",\r\n        email: \"\",\r\n        name: \"\",\r\n        content: \"\"\r\n      },\r\n      user: {\r\n        loginName: \"\",\r\n        email: \"\",\r\n        headimg: \"\",\r\n        name: \"\"\r\n      },\r\n      emailRule: {\r\n        title: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"请输入密码\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        email: [\r\n          { required: true, message: \"输入邮箱\", trigger: \"blur\" },\r\n          { type: \"email\", message: \"输入正确的邮箱格式\", trigger: \"blur\" }\r\n        ],\r\n        passwordAgain: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"请输入再次输入密码\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        name: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"请输入姓名\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        content: [{ required: true, message: \"请输入内容\", trigger: \"blur\" }]\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    if (!this.$store.getters._isMobile) {\r\n      this.$router.replace(\"/\");\r\n    }\r\n    var code = this.$route.query.code;\r\n    var state = this.$route.query.state;\r\n    this.login(code, state);\r\n  },\r\n  methods: {\r\n    dropdownClick(m) {\r\n      if (m == \"email\") {\r\n        this.emailModal = true;\r\n      } else if (m == \"loginOut\") {\r\n        this.$store.dispatch(\"users/loginOUt\", { router: this.$router });\r\n      } else if (m == \"messages\") {\r\n        this.$router.push({ path: \"/mobile/messages\" });\r\n      }\r\n    },\r\n    toLogin() {\r\n      this.$router.push(\"/mlogin\");\r\n    },\r\n    userGet() {\r\n      let _this = this;\r\n      this.axios({\r\n        method: \"get\",\r\n        url: \"/public/user\"\r\n      })\r\n        .then(\r\n          function(response) {\r\n            if (response.data.data != null && response.data.data != \"\") {\r\n              this.loginFlag = true;\r\n              this.userSet(response.data.data);\r\n              if (response.data.data.usertype == 1) {\r\n                this.consoleFlag = true;\r\n              }\r\n\r\n              return this.axios({\r\n                method: \"get\",\r\n                url: \"/msgrecords/unreadnum\"\r\n              });\r\n            } else {\r\n              return Promise.resolve(0);\r\n            }\r\n          }.bind(this)\r\n        )\r\n        .then(function(response) {\r\n          if (response === 0) {\r\n            _this.unreadMsgCount = response;\r\n          } else {\r\n            _this.unreadMsgCount = response.data.data;\r\n          }\r\n        })\r\n        .catch(\r\n          function(error) {\r\n            this.$Message.error(\"无权限\");\r\n          }.bind(this)\r\n        );\r\n    },\r\n    userSet(e) {\r\n      this.user.loginName = e.loginName;\r\n      this.user.email = e.email;\r\n      this.user.headimg = e.headimg;\r\n      this.user.name = e.name;\r\n    },\r\n    search() {\r\n      if (this.searchValue != null && this.searchValue != \"\") {\r\n        this.$router.push(\"/page/home/\" + this.searchValue);\r\n      }\r\n    },\r\n    menuSelect(e) {\r\n      if (e == 1) {\r\n      } else if (e == 2) {\r\n        this.emailModal = true;\r\n      } else if (e == 3) {\r\n        this.$store.dispatch(\"users/loginOUt\", { router: this.$router });\r\n      } else if (e == 4) {\r\n        this.$router.push(\"/base\");\r\n      } else if (e == 5) {\r\n        this.$router.push(\"/login\");\r\n      }\r\n    },\r\n    backHome() {\r\n      this.$router.push(\"/page/home\");\r\n    },\r\n    cancel() {\r\n      //this.$Message.info(\"点击了取消\");\r\n    },\r\n    emailOk(email) {\r\n      this.$refs[email].validate(valid => {\r\n        if (valid) {\r\n          this.axios({\r\n            method: \"post\",\r\n            url: \"/email\",\r\n            data: this.email\r\n          })\r\n            .then(\r\n              function(response) {\r\n                this.$Message.info(\"发送成功\");\r\n              }.bind(this)\r\n            )\r\n            .catch(function(error) {\r\n              alert(error);\r\n            });\r\n          this.emailModal = false;\r\n        } else {\r\n          this.$Message.error(\"表单验证失败!\");\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n            this.$nextTick(() => {\r\n              this.loading = true;\r\n            });\r\n          }, 1000);\r\n        }\r\n      });\r\n    },\r\n    /*登录*/\r\n    login(code, state) {\r\n      if (code != null && code != \"\" && state != null && state != \"\") {\r\n        this.$Spin.show({\r\n          render: h => {\r\n            return h(\"div\", [\r\n              h(\"Icon\", {\r\n                style: {\r\n                  animation: \"ani-demo-spin 1s linear infinite\"\r\n                },\r\n                props: {\r\n                  type: \"load-c\",\r\n                  size: 18\r\n                }\r\n              }),\r\n              h(\"div\", \"正在登录，请等待...\")\r\n            ]);\r\n          }\r\n        });\r\n        setTimeout(() => {\r\n          this.$Spin.hide();\r\n        }, 10000);\r\n        if (state == \"github\") {\r\n          this.githubLogin(code);\r\n        } else if (state == \"qq\") {\r\n          this.qqLogin(code);\r\n        } else {\r\n          this.$router.push({ path: \"/\" });\r\n          location.reload();\r\n        }\r\n      } else {\r\n        this.userGet();\r\n      }\r\n    },\r\n    /*github登录*/\r\n    githubLogin(code) {\r\n      this.axios({\r\n        method: \"post\",\r\n        url: \"/authentication/github\",\r\n        params: {\r\n          code: code\r\n        },\r\n        auth: {\r\n          username: \"client\",\r\n          password: \"secret\"\r\n        }\r\n      })\r\n        .then(\r\n          function(response) {\r\n            localStorage.setItem(\r\n              \"currentUser_token\",\r\n              response.data.access_token\r\n            );\r\n            localStorage.setItem(\r\n              \"currentUser_refresh_token\",\r\n              response.data.refresh_token\r\n            );\r\n            this.axios.defaults.headers.common[\"Authorization\"] =\r\n              \"bearer \" + localStorage.getItem(\"currentUser_token\");\r\n            this.$router.push({ path: \"/\" });\r\n            location.reload();\r\n          }.bind(this)\r\n        )\r\n        .catch(\r\n          function(error) {\r\n            this.$Message.error(\"登陆失败\");\r\n          }.bind(this)\r\n        );\r\n    },\r\n    /*qq登录*/\r\n    qqLogin(code) {\r\n      this.axios({\r\n        method: \"post\",\r\n        url: \"/authentication/qq\",\r\n        params: {\r\n          code: code\r\n        },\r\n        auth: {\r\n          username: \"client\",\r\n          password: \"secret\"\r\n        }\r\n      })\r\n        .then(\r\n          function(response) {\r\n            localStorage.setItem(\r\n              \"currentUser_token\",\r\n              response.data.access_token\r\n            );\r\n            localStorage.setItem(\r\n              \"currentUser_refresh_token\",\r\n              response.data.refresh_token\r\n            );\r\n            this.axios.defaults.headers.common[\"Authorization\"] =\r\n              \"bearer \" + localStorage.getItem(\"currentUser_token\");\r\n            this.$router.push({ path: \"/\" });\r\n            location.reload();\r\n          }.bind(this)\r\n        )\r\n        .catch(\r\n          function(error) {\r\n            this.$Message.error(\"登陆失败\");\r\n          }.bind(this)\r\n        );\r\n    },\r\n\r\n    toMessages() {\r\n      //console.log('to messages page');\r\n      this.$router.push({ path: \"/page/messages\" });\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}