{"remainingRequest":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\workspace\\javaEE\\interest\\interest-web\\src\\views\\sys\\role.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\src\\views\\sys\\role.vue","mtime":1574831227603},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      /*选择的数量*/\r\n      count: null,\r\n      /*选中的组数据*/\r\n      groupId: null,\r\n      /*新建modal的显示参数*/\r\n      newModal: false,\r\n      /*修改modal的显示参数*/\r\n      modifyModal: false,\r\n      /*权限modal的显示参数*/\r\n      settingModal: false,\r\n      /*分页total属性绑定值*/\r\n      total: 0,\r\n      /*loading*/\r\n      loading: true,\r\n      /*pageInfo实体*/\r\n      pageInfo: {\r\n        page: 0,\r\n        pageSize: 10\r\n      },\r\n      /*role实体*/\r\n      role: {\r\n        id: null,\r\n        role: null,\r\n        name: null,\r\n        modules: null,\r\n        describe: null\r\n      },\r\n      /*用于添加的role实体*/\r\n      roleNew: {\r\n        id: null,\r\n        role: null,\r\n        name: null,\r\n        modules: null,\r\n        describe: null\r\n      },\r\n      /*用于修改的role实体*/\r\n      roleModify: {\r\n        id: null,\r\n        role: null,\r\n        name: null,\r\n        modules: null,\r\n        describe: null\r\n      },\r\n      /*新建验证*/\r\n      ruleNew: {\r\n        role: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        name: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色名\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      },\r\n      /*修改验证*/\r\n      ruleModify: {\r\n        role: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        name: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色名\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      },\r\n      /*表显示字段*/\r\n      columns1: [\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\"\r\n        },\r\n        {\r\n          title: \"角色\",\r\n          key: \"role\"\r\n        },\r\n        {\r\n          title: \"角色名\",\r\n          key: \"name\"\r\n        },\r\n        {\r\n          title: \"描述\",\r\n          key: \"describe\"\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          key: \"action\",\r\n          width: 180,\r\n          align: \"center\",\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\"Button\", {\r\n                props: { icon: \"md-cog\" },\r\n                style: { border: \"none\", background: \"none\" },\r\n                on: {\r\n                  click: () => {\r\n                    this.setting(params.row);\r\n                  }\r\n                }\r\n              })\r\n            ]);\r\n          }\r\n        }\r\n      ],\r\n      /*表数据*/\r\n      data1: [],\r\n      /*表显示字段*/\r\n      columns2: [\r\n        {\r\n          title: \"权限\",\r\n          key: \"name\"\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          align: \"center\",\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\"i-switch\", {\r\n                attrs: {\r\n                  value: params.row.value\r\n                },\r\n                on: {\r\n                  \"on-change\": val => {\r\n                    var i = this.moduleArr.indexOf(params.row.id + \"\");\r\n                    if (val) {\r\n                      if (i == -1) {\r\n                        this.moduleArr.push(params.row.id + \"\");\r\n                      }\r\n                    } else {\r\n                      if (i != -1) {\r\n                        this.moduleArr.splice(i, 1);\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              })\r\n            ]);\r\n          }\r\n        }\r\n      ],\r\n      /*表数据*/\r\n      data2: [],\r\n      /*临时存储权限的数组*/\r\n      moduleArr: [],\r\n      /*二级菜单列表*/\r\n      submenusList: []\r\n    };\r\n  },\r\n  mounted() {\r\n    /*页面初始化调用方法*/\r\n    this.getTable({\r\n      pageInfo: this.pageInfo\r\n    });\r\n    this.axios({\r\n      method: \"get\",\r\n      url: \"/menus/submenus\"\r\n    })\r\n      .then(\r\n        function(response) {\r\n          this.submenusList = response.data.data;\r\n        }.bind(this)\r\n      )\r\n      .catch(function(error) {\r\n        alert(error);\r\n      });\r\n  },\r\n  methods: {\r\n    /*pageInfo实体初始化*/\r\n    initPageInfo() {\r\n      this.pageInfo.page = 0;\r\n      this.pageInfo.pageSize = 10;\r\n    },\r\n    /*role实体初始化*/\r\n    initRole() {\r\n      this.role.id = null;\r\n      this.role.role = null;\r\n      this.role.name = null;\r\n      this.role.modules = null;\r\n      this.role.describe = null;\r\n    },\r\n    /*roleNew实体初始化*/\r\n    initRoleNew() {\r\n      this.roleNew.id = null;\r\n      this.roleNew.role = null;\r\n      this.roleNew.name = null;\r\n      this.roleNew.modules = null;\r\n      this.roleNew.describe = null;\r\n    },\r\n    /*roleModify实体初始化*/\r\n    initRoleModify() {\r\n      this.roleModify.id = null;\r\n      this.roleModify.role = null;\r\n      this.roleModify.name = null;\r\n      this.roleModify.modules = null;\r\n      this.roleModify.describe = null;\r\n    },\r\n    /*roleNew设置*/\r\n    roleSet(e) {\r\n      this.role.id = e.id;\r\n      this.role.role = e.role;\r\n      this.role.name = e.name;\r\n      this.role.modules = e.modules;\r\n      this.role.describe = e.describe;\r\n    },\r\n    /*roleNew设置*/\r\n    roleNewSet(e) {\r\n      this.roleNew.id = e.id;\r\n      this.roleNew.role = e.role;\r\n      this.roleNew.name = e.name;\r\n      this.roleNew.modules = e.modules;\r\n      this.roleNew.describe = e.describe;\r\n    },\r\n    /*roleModify设置*/\r\n    roleModifySet(e) {\r\n      this.roleModify.id = e.id;\r\n      this.roleModify.role = e.role;\r\n      this.roleModify.name = e.name;\r\n      this.roleModify.modules = e.modules;\r\n      this.roleModify.describe = e.describe;\r\n    },\r\n    /*得到表数据*/\r\n    getTable(e) {\r\n      this.axios({\r\n        method: \"get\",\r\n        url: \"/roles\",\r\n        params: {\r\n          page: e.pageInfo.page,\r\n          pageSize: e.pageInfo.pageSize\r\n        }\r\n      })\r\n        .then(\r\n          function(response) {\r\n            this.data1 = response.data.data.data;\r\n            this.total = response.data.data.totalCount;\r\n          }.bind(this)\r\n        )\r\n        .catch(function(error) {\r\n          alert(error);\r\n        });\r\n    },\r\n    /*分页点击事件*/\r\n    pageSearch(e) {\r\n      this.pageInfo.page = e - 1;\r\n      this.getTable({\r\n        pageInfo: this.pageInfo\r\n      });\r\n    },\r\n    /*新建点击触发事件*/\r\n    openNewModal() {\r\n      this.newModal = true;\r\n      this.initRoleNew();\r\n      this.data1.sort();\r\n      this.count = 0;\r\n      this.groupId = null;\r\n    },\r\n    /*新建modal的newOk点击事件*/\r\n    newOk(roleNew) {\r\n      this.$refs[roleNew].validate(valid => {\r\n        if (valid) {\r\n          this.initRole();\r\n          this.roleSet(this.roleNew);\r\n          this.axios({\r\n            method: \"post\",\r\n            url: \"/roles/role\",\r\n            data: this.role\r\n          })\r\n            .then(\r\n              function(response) {\r\n                this.initRoleNew();\r\n                this.getTable({\r\n                  pageInfo: this.pageInfo\r\n                });\r\n                this.$Message.info(\"新建成功\");\r\n              }.bind(this)\r\n            )\r\n            .catch(function(error) {\r\n              alert(error);\r\n            });\r\n          this.newModal = false;\r\n        } else {\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n            this.$nextTick(() => {\r\n              this.loading = true;\r\n            });\r\n          }, 1000);\r\n        }\r\n      });\r\n    },\r\n    /*点击修改时判断是否只选择一个*/\r\n    openModifyModal() {\r\n      if (this.count > 1 || this.count < 1) {\r\n        this.modifyModal = false;\r\n        this.$Message.warning(\"请至少选择一项(且只能选择一项)\");\r\n      } else {\r\n        this.modifyModal = true;\r\n      }\r\n    },\r\n    /*修改modal的modifyOk点击事件*/\r\n    modifyOk(roleModify) {\r\n      this.$refs[roleModify].validate(valid => {\r\n        if (valid) {\r\n          this.initRole();\r\n          this.roleSet(this.roleModify);\r\n          this.axios({\r\n            method: \"put\",\r\n            url: \"/roles/\" + this.role.id,\r\n            data: this.role\r\n          })\r\n            .then(\r\n              function(response) {\r\n                this.initRoleModify();\r\n                this.getTable({\r\n                  pageInfo: this.pageInfo\r\n                });\r\n                this.$Message.info(\"修改成功\");\r\n              }.bind(this)\r\n            )\r\n            .catch(function(error) {\r\n              alert(error);\r\n            });\r\n          this.modifyModal = false;\r\n        } else {\r\n          this.$Message.error(\"表单验证失败!\");\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n            this.$nextTick(() => {\r\n              this.loading = true;\r\n            });\r\n          }, 1000);\r\n        }\r\n      });\r\n    },\r\n    /*表格中按钮点击事件*/\r\n    setting(e) {\r\n      this.data1.sort();\r\n      this.settingModal = true;\r\n      this.roleModifySet(e);\r\n      if (e.modules == null || e.modules == \"\") {\r\n        this.moduleArr = [];\r\n      } else {\r\n        this.moduleArr = e.modules.split(\";\");\r\n      }\r\n      var data2Temp = [];\r\n      for (var i = 0; i < this.submenusList.length; i++) {\r\n        if (this.moduleArr.indexOf(this.submenusList[i].id + \"\") == -1) {\r\n          data2Temp.push({\r\n            id: this.submenusList[i].id,\r\n            name: this.submenusList[i].name,\r\n            value: false\r\n          });\r\n        } else {\r\n          data2Temp.push({\r\n            id: this.submenusList[i].id,\r\n            name: this.submenusList[i].name,\r\n            value: true\r\n          });\r\n        }\r\n      }\r\n      this.data2 = data2Temp;\r\n    },\r\n    /*配置权限的settingOk点击事件*/\r\n    settingOk() {\r\n      var temp = \"\";\r\n      for (var i in this.moduleArr) {\r\n        if (this.moduleArr[i] != \"\" && this.moduleArr != null) {\r\n          temp = temp + this.moduleArr[i] + \";\";\r\n        }\r\n      }\r\n      this.roleModify.modules = temp;\r\n      this.initRole();\r\n      this.roleSet(this.roleModify);\r\n      this.axios({\r\n        method: \"put\",\r\n        url: \"/roles/\" + this.role.id,\r\n        data: this.role\r\n      })\r\n        .then(\r\n          function(response) {\r\n            this.initRoleModify();\r\n            this.getTable({\r\n              pageInfo: this.pageInfo\r\n            });\r\n            this.$Message.info(\"配置成功\");\r\n          }.bind(this)\r\n        )\r\n        .catch(function(error) {\r\n          alert(error);\r\n        });\r\n    },\r\n    /*modal的cancel点击事件*/\r\n    cancel() {\r\n      this.$Message.info(\"点击了取消\");\r\n    },\r\n    /*table选择后触发事件*/\r\n    change(e) {\r\n      if (e.length == 1) {\r\n        this.roleModifySet(e[\"0\"]);\r\n      }\r\n      this.setGroupId(e);\r\n    },\r\n    /*通过选中的行设置groupId的值*/\r\n    setGroupId(e) {\r\n      this.groupId = [];\r\n      this.count = e.length;\r\n      for (var i = 0; i <= e.length - 1; i++) {\r\n        this.groupId.push(e[i].id);\r\n      }\r\n    },\r\n    /*删除table中选中的数据*/\r\n    del() {\r\n      if (this.groupId != null && this.groupId != \"\") {\r\n        this.axios({\r\n          method: \"delete\",\r\n          url: \"/roles\",\r\n          data: this.groupId\r\n        })\r\n          .then(\r\n            function(response) {\r\n              this.getTable({\r\n                pageInfo: this.pageInfo\r\n              });\r\n              this.groupId = null;\r\n              this.count = 0;\r\n              this.$Message.info(\"删除成功\");\r\n            }.bind(this)\r\n          )\r\n          .catch(function(error) {\r\n            alert(error);\r\n          });\r\n      }\r\n    },\r\n    /*表格中双击事件*/\r\n    dblclick(e) {\r\n      this.roleModifySet(e);\r\n      this.modifyModal = true;\r\n      this.data1.sort();\r\n    }\r\n  }\r\n};\r\n",{"version":3,"sources":["role.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"role.vue","sourceRoot":"src/views/sys","sourcesContent":["<style scoped>\r\n  .operation-button{\r\n    margin-right: 3px;\r\n  }\r\n</style>\r\n<template>\r\n    <div style=\"margin: 20px;\">\r\n        <div>\r\n            <ul style=\"list-style-type: none;\">\r\n                <li>\r\n                    <Button class=\"operation-button\" type=\"primary\" icon=\"md-add\" @click=\"openNewModal()\">新建</Button>\r\n                    <Button class=\"operation-button\" type=\"success\" icon=\"md-build\" @click=\"openModifyModal()\">修改</Button>\r\n                    <Button type=\"error\" icon=\"md-trash\" @click=\"del()\">删除</Button>\r\n                </li>\r\n                <li>\r\n                    <div style=\"padding: 10px 0;\">\r\n                        <Table border :columns=\"columns1\" :data=\"data1\" :height=\"400\" @on-selection-change=\"s=>{change(s)}\" @on-row-dblclick=\"s=>{dblclick(s)}\"></Table>\r\n                    </div> \r\n                </li>\r\n                <li>\r\n                    <div style=\"text-align: right;\">\r\n                        <Page :total=\"total\" :page-size=\"pageInfo.pageSize\" show-elevator show-total @on-change=\"e=>{pageSearch(e)}\"></Page>\r\n                    </div>  \r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <!--添加modal-->  \r\n        <Modal :mask-closable=\"false\" :visible.sync=\"newModal\" :loading = \"loading\" v-model=\"newModal\" width=\"600\" title=\"新建\" @on-ok=\"newOk('roleNew')\" @on-cancel=\"cancel()\">\r\n            <Form ref=\"roleNew\" :model=\"roleNew\" :rules=\"ruleNew\" :label-width=\"80\" >\r\n                <Row>\r\n                    <Col span=\"12\">\r\n                      <Form-item label=\"角色:\" prop=\"role\">\r\n                          <Input v-model=\"roleNew.role\" style=\"width: 204px\"/>\r\n                      </Form-item>\r\n                    </Col>\r\n                    <Col span=\"12\">\r\n                         <Form-item label=\"角色名:\" prop=\"name\">\r\n                            <Input v-model=\"roleNew.name\" style=\"width: 204px\"/>\r\n                        </Form-item>\r\n                    </Col>\r\n                </Row>\r\n               \r\n                <Form-item label=\"描述:\" prop=\"describe\">\r\n                     <Input v-model=\"roleNew.describe\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"></Input>\r\n                </Form-item>\r\n            </Form>\r\n        </Modal>\r\n        <!--修改modal-->  \r\n        <Modal :mask-closable=\"false\" :visible.sync=\"modifyModal\" :loading = \"loading\" v-model=\"modifyModal\" width=\"600\" title=\"修改\" @on-ok=\"modifyOk('roleModify')\" @on-cancel=\"cancel()\">\r\n            <Form ref=\"roleModify\" :model=\"roleModify\" :rules=\"ruleModify\" :label-width=\"80\" >\r\n                <Row>\r\n                    <Col span=\"12\">\r\n                        <Form-item label=\"角色:\" prop=\"role\">\r\n                            <Input v-model=\"roleModify.role\" style=\"width: 204px\"/>\r\n                        </Form-item>\r\n                    </Col>\r\n                    <Col span=\"12\">\r\n                         <Form-item label=\"角色名:\" prop=\"name\">\r\n                            <Input v-model=\"roleModify.name\" style=\"width: 204px\"/>\r\n                        </Form-item>\r\n                    </Col>\r\n                </Row>\r\n                <!-- <Form-item label=\"角色名:\" prop=\"name\">\r\n                            <Input v-model=\"roleModify.name\" style=\"width: 204px\"/>\r\n                        </Form-item> -->\r\n                <Form-item label=\"描述:\" prop=\"describe\">\r\n                     <Input v-model=\"roleModify.describe\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"></Input>\r\n                </Form-item>\r\n            </Form>\r\n        </Modal>\r\n        <!-- 配置权限 -->\r\n        <Modal v-model=\"settingModal\"  width=\"400\" title=\"配置权限\" @on-ok=\"settingOk()\" @on-cancel=\"cancel()\" :mask-closable=\"false\">\r\n            <Row>\r\n                <Col span=\"24\"><Table border :columns=\"columns2\" :data=\"data2\"></Table></Col>\r\n            </Row>\r\n        </Modal>\r\n    </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      /*选择的数量*/\r\n      count: null,\r\n      /*选中的组数据*/\r\n      groupId: null,\r\n      /*新建modal的显示参数*/\r\n      newModal: false,\r\n      /*修改modal的显示参数*/\r\n      modifyModal: false,\r\n      /*权限modal的显示参数*/\r\n      settingModal: false,\r\n      /*分页total属性绑定值*/\r\n      total: 0,\r\n      /*loading*/\r\n      loading: true,\r\n      /*pageInfo实体*/\r\n      pageInfo: {\r\n        page: 0,\r\n        pageSize: 10\r\n      },\r\n      /*role实体*/\r\n      role: {\r\n        id: null,\r\n        role: null,\r\n        name: null,\r\n        modules: null,\r\n        describe: null\r\n      },\r\n      /*用于添加的role实体*/\r\n      roleNew: {\r\n        id: null,\r\n        role: null,\r\n        name: null,\r\n        modules: null,\r\n        describe: null\r\n      },\r\n      /*用于修改的role实体*/\r\n      roleModify: {\r\n        id: null,\r\n        role: null,\r\n        name: null,\r\n        modules: null,\r\n        describe: null\r\n      },\r\n      /*新建验证*/\r\n      ruleNew: {\r\n        role: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        name: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色名\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      },\r\n      /*修改验证*/\r\n      ruleModify: {\r\n        role: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        name: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"输入角色名\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      },\r\n      /*表显示字段*/\r\n      columns1: [\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\"\r\n        },\r\n        {\r\n          title: \"角色\",\r\n          key: \"role\"\r\n        },\r\n        {\r\n          title: \"角色名\",\r\n          key: \"name\"\r\n        },\r\n        {\r\n          title: \"描述\",\r\n          key: \"describe\"\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          key: \"action\",\r\n          width: 180,\r\n          align: \"center\",\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\"Button\", {\r\n                props: { icon: \"md-cog\" },\r\n                style: { border: \"none\", background: \"none\" },\r\n                on: {\r\n                  click: () => {\r\n                    this.setting(params.row);\r\n                  }\r\n                }\r\n              })\r\n            ]);\r\n          }\r\n        }\r\n      ],\r\n      /*表数据*/\r\n      data1: [],\r\n      /*表显示字段*/\r\n      columns2: [\r\n        {\r\n          title: \"权限\",\r\n          key: \"name\"\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          align: \"center\",\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\"i-switch\", {\r\n                attrs: {\r\n                  value: params.row.value\r\n                },\r\n                on: {\r\n                  \"on-change\": val => {\r\n                    var i = this.moduleArr.indexOf(params.row.id + \"\");\r\n                    if (val) {\r\n                      if (i == -1) {\r\n                        this.moduleArr.push(params.row.id + \"\");\r\n                      }\r\n                    } else {\r\n                      if (i != -1) {\r\n                        this.moduleArr.splice(i, 1);\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              })\r\n            ]);\r\n          }\r\n        }\r\n      ],\r\n      /*表数据*/\r\n      data2: [],\r\n      /*临时存储权限的数组*/\r\n      moduleArr: [],\r\n      /*二级菜单列表*/\r\n      submenusList: []\r\n    };\r\n  },\r\n  mounted() {\r\n    /*页面初始化调用方法*/\r\n    this.getTable({\r\n      pageInfo: this.pageInfo\r\n    });\r\n    this.axios({\r\n      method: \"get\",\r\n      url: \"/menus/submenus\"\r\n    })\r\n      .then(\r\n        function(response) {\r\n          this.submenusList = response.data.data;\r\n        }.bind(this)\r\n      )\r\n      .catch(function(error) {\r\n        alert(error);\r\n      });\r\n  },\r\n  methods: {\r\n    /*pageInfo实体初始化*/\r\n    initPageInfo() {\r\n      this.pageInfo.page = 0;\r\n      this.pageInfo.pageSize = 10;\r\n    },\r\n    /*role实体初始化*/\r\n    initRole() {\r\n      this.role.id = null;\r\n      this.role.role = null;\r\n      this.role.name = null;\r\n      this.role.modules = null;\r\n      this.role.describe = null;\r\n    },\r\n    /*roleNew实体初始化*/\r\n    initRoleNew() {\r\n      this.roleNew.id = null;\r\n      this.roleNew.role = null;\r\n      this.roleNew.name = null;\r\n      this.roleNew.modules = null;\r\n      this.roleNew.describe = null;\r\n    },\r\n    /*roleModify实体初始化*/\r\n    initRoleModify() {\r\n      this.roleModify.id = null;\r\n      this.roleModify.role = null;\r\n      this.roleModify.name = null;\r\n      this.roleModify.modules = null;\r\n      this.roleModify.describe = null;\r\n    },\r\n    /*roleNew设置*/\r\n    roleSet(e) {\r\n      this.role.id = e.id;\r\n      this.role.role = e.role;\r\n      this.role.name = e.name;\r\n      this.role.modules = e.modules;\r\n      this.role.describe = e.describe;\r\n    },\r\n    /*roleNew设置*/\r\n    roleNewSet(e) {\r\n      this.roleNew.id = e.id;\r\n      this.roleNew.role = e.role;\r\n      this.roleNew.name = e.name;\r\n      this.roleNew.modules = e.modules;\r\n      this.roleNew.describe = e.describe;\r\n    },\r\n    /*roleModify设置*/\r\n    roleModifySet(e) {\r\n      this.roleModify.id = e.id;\r\n      this.roleModify.role = e.role;\r\n      this.roleModify.name = e.name;\r\n      this.roleModify.modules = e.modules;\r\n      this.roleModify.describe = e.describe;\r\n    },\r\n    /*得到表数据*/\r\n    getTable(e) {\r\n      this.axios({\r\n        method: \"get\",\r\n        url: \"/roles\",\r\n        params: {\r\n          page: e.pageInfo.page,\r\n          pageSize: e.pageInfo.pageSize\r\n        }\r\n      })\r\n        .then(\r\n          function(response) {\r\n            this.data1 = response.data.data.data;\r\n            this.total = response.data.data.totalCount;\r\n          }.bind(this)\r\n        )\r\n        .catch(function(error) {\r\n          alert(error);\r\n        });\r\n    },\r\n    /*分页点击事件*/\r\n    pageSearch(e) {\r\n      this.pageInfo.page = e - 1;\r\n      this.getTable({\r\n        pageInfo: this.pageInfo\r\n      });\r\n    },\r\n    /*新建点击触发事件*/\r\n    openNewModal() {\r\n      this.newModal = true;\r\n      this.initRoleNew();\r\n      this.data1.sort();\r\n      this.count = 0;\r\n      this.groupId = null;\r\n    },\r\n    /*新建modal的newOk点击事件*/\r\n    newOk(roleNew) {\r\n      this.$refs[roleNew].validate(valid => {\r\n        if (valid) {\r\n          this.initRole();\r\n          this.roleSet(this.roleNew);\r\n          this.axios({\r\n            method: \"post\",\r\n            url: \"/roles/role\",\r\n            data: this.role\r\n          })\r\n            .then(\r\n              function(response) {\r\n                this.initRoleNew();\r\n                this.getTable({\r\n                  pageInfo: this.pageInfo\r\n                });\r\n                this.$Message.info(\"新建成功\");\r\n              }.bind(this)\r\n            )\r\n            .catch(function(error) {\r\n              alert(error);\r\n            });\r\n          this.newModal = false;\r\n        } else {\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n            this.$nextTick(() => {\r\n              this.loading = true;\r\n            });\r\n          }, 1000);\r\n        }\r\n      });\r\n    },\r\n    /*点击修改时判断是否只选择一个*/\r\n    openModifyModal() {\r\n      if (this.count > 1 || this.count < 1) {\r\n        this.modifyModal = false;\r\n        this.$Message.warning(\"请至少选择一项(且只能选择一项)\");\r\n      } else {\r\n        this.modifyModal = true;\r\n      }\r\n    },\r\n    /*修改modal的modifyOk点击事件*/\r\n    modifyOk(roleModify) {\r\n      this.$refs[roleModify].validate(valid => {\r\n        if (valid) {\r\n          this.initRole();\r\n          this.roleSet(this.roleModify);\r\n          this.axios({\r\n            method: \"put\",\r\n            url: \"/roles/\" + this.role.id,\r\n            data: this.role\r\n          })\r\n            .then(\r\n              function(response) {\r\n                this.initRoleModify();\r\n                this.getTable({\r\n                  pageInfo: this.pageInfo\r\n                });\r\n                this.$Message.info(\"修改成功\");\r\n              }.bind(this)\r\n            )\r\n            .catch(function(error) {\r\n              alert(error);\r\n            });\r\n          this.modifyModal = false;\r\n        } else {\r\n          this.$Message.error(\"表单验证失败!\");\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n            this.$nextTick(() => {\r\n              this.loading = true;\r\n            });\r\n          }, 1000);\r\n        }\r\n      });\r\n    },\r\n    /*表格中按钮点击事件*/\r\n    setting(e) {\r\n      this.data1.sort();\r\n      this.settingModal = true;\r\n      this.roleModifySet(e);\r\n      if (e.modules == null || e.modules == \"\") {\r\n        this.moduleArr = [];\r\n      } else {\r\n        this.moduleArr = e.modules.split(\";\");\r\n      }\r\n      var data2Temp = [];\r\n      for (var i = 0; i < this.submenusList.length; i++) {\r\n        if (this.moduleArr.indexOf(this.submenusList[i].id + \"\") == -1) {\r\n          data2Temp.push({\r\n            id: this.submenusList[i].id,\r\n            name: this.submenusList[i].name,\r\n            value: false\r\n          });\r\n        } else {\r\n          data2Temp.push({\r\n            id: this.submenusList[i].id,\r\n            name: this.submenusList[i].name,\r\n            value: true\r\n          });\r\n        }\r\n      }\r\n      this.data2 = data2Temp;\r\n    },\r\n    /*配置权限的settingOk点击事件*/\r\n    settingOk() {\r\n      var temp = \"\";\r\n      for (var i in this.moduleArr) {\r\n        if (this.moduleArr[i] != \"\" && this.moduleArr != null) {\r\n          temp = temp + this.moduleArr[i] + \";\";\r\n        }\r\n      }\r\n      this.roleModify.modules = temp;\r\n      this.initRole();\r\n      this.roleSet(this.roleModify);\r\n      this.axios({\r\n        method: \"put\",\r\n        url: \"/roles/\" + this.role.id,\r\n        data: this.role\r\n      })\r\n        .then(\r\n          function(response) {\r\n            this.initRoleModify();\r\n            this.getTable({\r\n              pageInfo: this.pageInfo\r\n            });\r\n            this.$Message.info(\"配置成功\");\r\n          }.bind(this)\r\n        )\r\n        .catch(function(error) {\r\n          alert(error);\r\n        });\r\n    },\r\n    /*modal的cancel点击事件*/\r\n    cancel() {\r\n      this.$Message.info(\"点击了取消\");\r\n    },\r\n    /*table选择后触发事件*/\r\n    change(e) {\r\n      if (e.length == 1) {\r\n        this.roleModifySet(e[\"0\"]);\r\n      }\r\n      this.setGroupId(e);\r\n    },\r\n    /*通过选中的行设置groupId的值*/\r\n    setGroupId(e) {\r\n      this.groupId = [];\r\n      this.count = e.length;\r\n      for (var i = 0; i <= e.length - 1; i++) {\r\n        this.groupId.push(e[i].id);\r\n      }\r\n    },\r\n    /*删除table中选中的数据*/\r\n    del() {\r\n      if (this.groupId != null && this.groupId != \"\") {\r\n        this.axios({\r\n          method: \"delete\",\r\n          url: \"/roles\",\r\n          data: this.groupId\r\n        })\r\n          .then(\r\n            function(response) {\r\n              this.getTable({\r\n                pageInfo: this.pageInfo\r\n              });\r\n              this.groupId = null;\r\n              this.count = 0;\r\n              this.$Message.info(\"删除成功\");\r\n            }.bind(this)\r\n          )\r\n          .catch(function(error) {\r\n            alert(error);\r\n          });\r\n      }\r\n    },\r\n    /*表格中双击事件*/\r\n    dblclick(e) {\r\n      this.roleModifySet(e);\r\n      this.modifyModal = true;\r\n      this.data1.sort();\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}