{"remainingRequest":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\thread-loader\\dist\\cjs.js!E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\babel-loader\\lib\\index.js!E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\workspace\\javaEE\\interest\\interest-web\\src\\views\\template\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\src\\views\\template\\index.vue","mtime":1568861049963},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\workspace\\javaEE\\interest\\interest-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      loginFlag: false,\n      consoleFlag: false,\n      loading: true,\n      searchValue: \"\",\n      emailModal: false,\n      //用户未读消息个数\n      unreadMsgCount: 0,\n      email: {\n        title: \"\",\n        email: \"\",\n        name: \"\",\n        content: \"\"\n      },\n      user: {\n        loginName: \"\",\n        email: \"\",\n        headimg: \"\",\n        name: \"\"\n      },\n      emailRule: {\n        title: [{\n          type: \"string\",\n          required: true,\n          message: \"请输入密码\",\n          trigger: \"blur\"\n        }],\n        email: [{\n          required: true,\n          message: \"输入邮箱\",\n          trigger: \"blur\"\n        }, {\n          type: \"email\",\n          message: \"输入正确的邮箱格式\",\n          trigger: \"blur\"\n        }],\n        passwordAgain: [{\n          type: \"string\",\n          required: true,\n          message: \"请输入再次输入密码\",\n          trigger: \"blur\"\n        }],\n        name: [{\n          type: \"string\",\n          required: true,\n          message: \"请输入姓名\",\n          trigger: \"blur\"\n        }],\n        content: [{\n          required: true,\n          message: \"请输入内容\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  created: function created() {\n    var code = this.$route.query.code;\n    var state = this.$route.query.state;\n\n    if (this.$store.getters._isMobile) {\n      if (code != null && code != \"\" && state != null && state != \"\") {\n        this.$router.replace(\"/mobile\" + \"?code=\" + code + \"&state=\" + state);\n        return;\n      } else {\n        this.$router.replace(\"/mobile\");\n        return;\n      }\n    }\n\n    this.login(code, state);\n  },\n  methods: {\n    userGet: function userGet() {\n      var _this = this;\n\n      this.axios({\n        method: \"get\",\n        url: \"/public/user\"\n      }).then(function (response) {\n        if (response.data.data != null && response.data.data != \"\") {\n          this.loginFlag = true;\n          this.userSet(response.data.data);\n\n          if (response.data.data.usertype == 1) {\n            this.consoleFlag = true;\n          }\n\n          return this.axios({\n            method: \"get\",\n            url: \"/msgrecords/unreadnum\"\n          });\n        } else {\n          return Promise.resolve(0);\n        }\n      }.bind(this)).then(function (response) {\n        if (response === 0) {\n          _this.unreadMsgCount = response;\n        } else {\n          _this.unreadMsgCount = response.data.data;\n        }\n      }).catch(function (error) {\n        this.$Message.error(\"无权限\");\n      }.bind(this));\n    },\n    userSet: function userSet(e) {\n      this.user.loginName = e.loginName;\n      this.user.email = e.email;\n      this.user.headimg = e.headimg;\n      this.user.name = e.name;\n    },\n    search: function search() {\n      if (this.$route.name == \"home\" || this.$route.name == \"page-home-title\" || this.$route.name == \"page-home\") {\n        this.$router.push(\"/page/home/\" + this.searchValue);\n      } else if (this.$route.name == \"article-home\") {\n        this.$router.push(\"/article\" + \"?searchValue=\" + this.searchValue);\n      }\n    },\n    menuSelect: function menuSelect(e) {\n      if (e == 1) {\n        this.$router.push(\"/page/user\");\n      } else if (e == 2) {\n        this.emailModal = true;\n      } else if (e == 31) {\n        this.$router.push(\"/article/create\");\n      } else if (e == 32) {\n        this.$router.push(\"/article/user\");\n      } else if (e == 4) {\n        this.$store.dispatch(\"users/loginOUt\", {\n          router: this.$router\n        });\n      } else if (e == 5) {\n        this.$router.push(\"/base\");\n      } else if (e == 6) {\n        this.$router.push(\"/login\");\n      } else if (e == \"interest\") {\n        this.$router.push(\"/\");\n      } else if (e == \"article\") {\n        this.$router.push(\"/article\");\n      }\n    },\n    backHome: function backHome() {\n      this.$router.push(\"/page/home\");\n    },\n    cancel: function cancel() {\n      this.$Message.info(\"点击了取消\");\n    },\n    emailOk: function emailOk(email) {\n      var _this2 = this;\n\n      this.$refs[email].validate(function (valid) {\n        if (valid) {\n          _this2.axios({\n            method: \"post\",\n            url: \"/email\",\n            data: _this2.email\n          }).then(function (response) {\n            this.$Message.info(\"发送成功\");\n          }.bind(_this2)).catch(function (error) {\n            alert(error);\n          });\n\n          _this2.emailModal = false;\n        } else {\n          _this2.$Message.error(\"表单验证失败!\");\n\n          setTimeout(function () {\n            _this2.loading = false;\n\n            _this2.$nextTick(function () {\n              _this2.loading = true;\n            });\n          }, 1000);\n        }\n      });\n    },\n\n    /*登录*/\n    login: function login(code, state) {\n      var _this3 = this;\n\n      if (code != null && code != \"\" && state != null && state != \"\") {\n        this.$Spin.show({\n          render: function render(h) {\n            return h(\"div\", [h(\"Icon\", {\n              style: {\n                animation: \"ani-demo-spin 1s linear infinite\"\n              },\n              props: {\n                type: \"load-c\",\n                size: 18\n              }\n            }), h(\"div\", \"正在登录，请等待...\")]);\n          }\n        });\n        setTimeout(function () {\n          _this3.$Spin.hide();\n        }, 10000);\n\n        if (state == \"github\") {\n          this.githubLogin(code);\n        } else if (state == \"qq\") {\n          this.qqLogin(code);\n        } else {\n          this.$router.push({\n            path: \"/\"\n          });\n          location.reload();\n        }\n      } else {\n        this.userGet();\n      }\n    },\n\n    /*github登录*/\n    githubLogin: function githubLogin(code) {\n      this.axios({\n        method: \"post\",\n        url: \"/authentication/github\",\n        params: {\n          code: code\n        },\n        auth: {\n          username: \"client\",\n          password: \"secret\"\n        }\n      }).then(function (response) {\n        localStorage.setItem(\"currentUser_token\", response.data.access_token);\n        localStorage.setItem(\"currentUser_refresh_token\", response.data.refresh_token);\n        this.axios.defaults.headers.common[\"Authorization\"] = \"bearer \" + localStorage.getItem(\"currentUser_token\");\n        this.$router.push({\n          path: \"/\"\n        });\n        location.reload();\n      }.bind(this)).catch(function (error) {\n        this.$Message.error(\"登陆失败\");\n      }.bind(this));\n    },\n\n    /*qq登录*/\n    qqLogin: function qqLogin(code) {\n      this.axios({\n        method: \"post\",\n        url: \"/authentication/qq\",\n        params: {\n          code: code\n        },\n        auth: {\n          username: \"client\",\n          password: \"secret\"\n        }\n      }).then(function (response) {\n        localStorage.setItem(\"currentUser_token\", response.data.access_token);\n        localStorage.setItem(\"currentUser_refresh_token\", response.data.refresh_token);\n        this.axios.defaults.headers.common[\"Authorization\"] = \"bearer \" + localStorage.getItem(\"currentUser_token\");\n        this.$router.push({\n          path: \"/qq\"\n        });\n        this.$router.push({\n          path: \"/\"\n        });\n        location.reload();\n      }.bind(this)).catch(function (error) {\n        this.$Message.error(\"登陆失败\");\n      }.bind(this));\n    },\n    toMessages: function toMessages() {\n      console.log(\"to messages page\");\n      this.$router.push({\n        path: \"/page/messages\"\n      });\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<style scoped>\r\n.layout {\r\n  border: 1px solid #d7dde4;\r\n  background: #f5f7f9;\r\n  position: relative;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n  min-width: 1000px;\r\n}\r\n\r\n.layout-logo {\r\n  float: left;\r\n}\r\n\r\n.layout-search {\r\n  height: 30px;\r\n  border-radius: 3px;\r\n  float: left;\r\n  position: relative;\r\n  left: 30px;\r\n}\r\n\r\n.layout-title {\r\n  margin-left: 30px;\r\n  height: inherit;\r\n  float: left;\r\n}\r\n\r\n.layout-title .home-text{\r\n  color: rebeccapurple;\r\n  font-weight: bold;\r\n}\r\n\r\n.layout-title .home-text:hover{\r\n  color: #2d8cf0;\r\n}\r\n\r\n.menu-layout {\r\n  height:65px;\r\n  width:100%;\r\n}\r\n.layout-nav {\r\n  height: inherit;\r\n  float: right;\r\n}\r\n\r\n.layout-footer-center {\r\n  text-align: center;\r\n  background: #fff;\r\n}\r\n\r\n.demo-spin-icon-load {\r\n  animation: ani-demo-spin 1s linear infinite;\r\n}\r\n\r\n.avatar-badge-wrapper {\r\n  position: relative;\r\n  float: right;\r\n  cursor: pointer;\r\n}\r\n\r\n.avatar-badge-wrapper .msg-num {\r\n  position: absolute;\r\n  top: 9px;\r\n  right: -12px;\r\n  color: #fff;\r\n  background-color: #2db7f5;\r\n  border-radius: 50%;\r\n  padding: 2px 5px;\r\n  line-height: 1;\r\n}\r\n\r\n@keyframes ani-demo-spin {\r\n  from {\r\n    transform: rotate(0deg);\r\n  }\r\n  50% {\r\n    transform: rotate(180deg);\r\n  }\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n</style>\r\n<template>\r\n    <div class=\"layout\">\r\n        <Layout>\r\n            <Header style=\"position: absolute;width: 100%;background:#fff;padding:0 0;z-index: 1000; \">\r\n              <Menu mode=\"horizontal\" theme=\"light\" class=\"menu-layout\" active-name=\"interest\"\r\n                    @on-select=\"m=>{menuSelect(m)}\">\r\n                  <div style=\"width: 95%;margin: 0 auto\">\r\n                      <div class=\"layout-logo\">\r\n                          <a @click=\"backHome()\">\r\n                              <img src=\"../../images/logo.jpg\" style=\"width: 50px;height: 50px;\" align=\"absmiddle\" />\r\n                          </a>\r\n                      </div>\r\n                      <div class=\"layout-title\">\r\n                          <MenuItem name=\"interest\">\r\n                            <span class=\"home-text\">\r\n                              主页\r\n                            </span>\r\n                          </MenuItem>\r\n                          <MenuItem name=\"article\">\r\n                            <span class=\"home-text\">\r\n                              文章\r\n                            </span>\r\n                          </MenuItem>\r\n                      </div>\r\n                      <div class=\"layout-search\">\r\n                          <Input v-model=\"searchValue\" icon=\"android-search\" placeholder=\"Enter something...\"\r\n                                 @on-enter=\"search()\" />\r\n                      </div>\r\n                      <div v-if=\"loginFlag\" class=\"layout-nav\">\r\n                          <MenuItem name=\"1\">\r\n                              {{user.name}}\r\n                          </MenuItem>\r\n                          <MenuItem name=\"2\">\r\n                              <Icon type=\"ios-mail\"></Icon>\r\n                              邮件\r\n                          </MenuItem>\r\n                          <Submenu name=\"3\">\r\n                            <template slot=\"title\">\r\n                                <Icon type=\"md-list-box\" />\r\n                                文章\r\n                            </template>\r\n                            <MenuItem name=\"31\">\r\n                              <Icon type=\"md-create\" />\r\n                              写文章\r\n                            </MenuItem>\r\n                            <MenuItem name=\"32\">\r\n                              <Icon type=\"md-list\" />\r\n                              我的文章\r\n                            </MenuItem>\r\n                        </Submenu>\r\n                          <MenuItem name=\"4\">\r\n                              <Icon type=\"md-log-out\"></Icon>\r\n                              退出\r\n                          </MenuItem>\r\n                          <MenuItem name=\"5\" v-if=\"consoleFlag\">\r\n                              <Icon type=\"md-settings\"></Icon>\r\n                              控制台\r\n                          </MenuItem>\r\n                      </div>\r\n                      <div  type=\"success\" class=\"avatar-badge-wrapper\" @click=\"toMessages\">\r\n\r\n                          <img v-if=\"loginFlag\"\r\n                               style=\"width: 30px;height: 30px; margin-top: 16px;border-radius: 100%;\"\r\n                               :src=\"user.headimg\" />\r\n\r\n                          <span v-if=\"unreadMsgCount > 0\"  class=\"msg-num\">{{unreadMsgCount}}</span>\r\n\r\n                      </div>\r\n\r\n                      <div v-if=\"!loginFlag\" class=\"layout-nav\">\r\n                          <MenuItem name=\"6\">\r\n                              <Icon type=\"md-log-in\"></Icon>\r\n                              登录\r\n                          </MenuItem>\r\n                      </div>\r\n                  </div>\r\n              </Menu>\r\n            </Header>\r\n            <Content :style=\"{margin: '80px 0 40px 0'}\">\r\n                <router-view></router-view>\r\n            </Content>\r\n            <Footer class=\"layout-footer-center\">\r\n                <div>\r\n                    <a href=\"https://github.com/smallsnail-wh\" target=\"_blank\">\r\n                        <Icon style=\"color: rebeccapurple;\" size=\"40\" type=\"logo-github\"></Icon>\r\n                    </a>\r\n                </div>\r\n                <p>2018-2020 &copy; smallsail-wh</p>\r\n            </Footer>\r\n        </Layout>\r\n\r\n        <Modal :mask-closable=\"false\" :visible.sync=\"emailModal\" :loading=\"loading\" v-model=\"emailModal\" width=\"600\"\r\n               title=\"联系管理员\" @on-ok=\"emailOk('email')\" @on-cancel=\"cancel()\">\r\n            <Form ref=\"email\" :rules=\"emailRule\" :model=\"email\" :label-width=\"80\">\r\n                <FormItem label=\"标题\" prop=\"title\">\r\n                    <Input v-model=\"email.title\" placeholder=\"请输入标题\" />\r\n                </FormItem>\r\n                <FormItem label=\"email\" prop=\"email\">\r\n                    <Input v-model=\"email.email\" placeholder=\"请输入email\" />\r\n                </FormItem>\r\n                <FormItem label=\"姓名\" prop=\"name\">\r\n                    <Input v-model=\"email.name\" placeholder=\"请输入姓名\" />\r\n                </FormItem>\r\n                <FormItem label=\"内容\" prop=\"content\">\r\n                    <Input v-model=\"email.content\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"placeholder=\"Enter something...\" />\r\n                </FormItem>\r\n            </Form>\r\n        </Modal>\r\n    </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      loginFlag: false,\r\n      consoleFlag: false,\r\n      loading: true,\r\n      searchValue: \"\",\r\n      emailModal: false,\r\n      //用户未读消息个数\r\n      unreadMsgCount: 0,\r\n      email: {\r\n        title: \"\",\r\n        email: \"\",\r\n        name: \"\",\r\n        content: \"\"\r\n      },\r\n      user: {\r\n        loginName: \"\",\r\n        email: \"\",\r\n        headimg: \"\",\r\n        name: \"\"\r\n      },\r\n      emailRule: {\r\n        title: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"请输入密码\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        email: [\r\n          { required: true, message: \"输入邮箱\", trigger: \"blur\" },\r\n          { type: \"email\", message: \"输入正确的邮箱格式\", trigger: \"blur\" }\r\n        ],\r\n        passwordAgain: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"请输入再次输入密码\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        name: [\r\n          {\r\n            type: \"string\",\r\n            required: true,\r\n            message: \"请输入姓名\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        content: [{ required: true, message: \"请输入内容\", trigger: \"blur\" }]\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    var code = this.$route.query.code;\r\n    var state = this.$route.query.state;\r\n    if (this.$store.getters._isMobile) {\r\n      if (code != null && code != \"\" && state != null && state != \"\") {\r\n        this.$router.replace(\"/mobile\" + \"?code=\" + code + \"&state=\" + state);\r\n        return;\r\n      } else {\r\n        this.$router.replace(\"/mobile\");\r\n        return;\r\n      }\r\n    }\r\n    this.login(code, state);\r\n  },\r\n  methods: {\r\n    userGet() {\r\n      let _this = this;\r\n      this.axios({\r\n        method: \"get\",\r\n        url: \"/public/user\"\r\n      })\r\n        .then(\r\n          function(response) {\r\n            if (response.data.data != null && response.data.data != \"\") {\r\n              this.loginFlag = true;\r\n              this.userSet(response.data.data);\r\n              if (response.data.data.usertype == 1) {\r\n                this.consoleFlag = true;\r\n              }\r\n\r\n              return this.axios({\r\n                method: \"get\",\r\n                url: \"/msgrecords/unreadnum\"\r\n              });\r\n            } else {\r\n              return Promise.resolve(0);\r\n            }\r\n          }.bind(this)\r\n        )\r\n        .then(function(response) {\r\n          if (response === 0) {\r\n            _this.unreadMsgCount = response;\r\n          } else {\r\n            _this.unreadMsgCount = response.data.data;\r\n          }\r\n        })\r\n        .catch(\r\n          function(error) {\r\n            this.$Message.error(\"无权限\");\r\n          }.bind(this)\r\n        );\r\n    },\r\n    userSet(e) {\r\n      this.user.loginName = e.loginName;\r\n      this.user.email = e.email;\r\n      this.user.headimg = e.headimg;\r\n      this.user.name = e.name;\r\n    },\r\n    search() {\r\n      if(this.$route.name == \"home\" || this.$route.name == \"page-home-title\"|| this.$route.name == \"page-home\"){\r\n        this.$router.push(\"/page/home/\" + this.searchValue);\r\n      }else if(this.$route.name == \"article-home\"){\r\n        this.$router.push(\"/article\" + \"?searchValue=\" + this.searchValue);\r\n      }\r\n    },\r\n    menuSelect(e) {\r\n      if (e == 1) {\r\n        this.$router.push(\"/page/user\");\r\n      } else if (e == 2) {\r\n        this.emailModal = true;\r\n      } else if (e == 31) {\r\n        this.$router.push(\"/article/create\");\r\n      } else if (e == 32) {\r\n        this.$router.push(\"/article/user\");\r\n      } else if (e == 4) {\r\n        this.$store.dispatch(\"users/loginOUt\", { router: this.$router });\r\n      } else if (e == 5) {\r\n        this.$router.push(\"/base\");\r\n      } else if (e == 6) {\r\n        this.$router.push(\"/login\");\r\n      } else if (e == \"interest\") {\r\n        this.$router.push(\"/\");\r\n      } else if (e == \"article\") {\r\n        this.$router.push(\"/article\");\r\n      }\r\n    },\r\n    backHome() {\r\n      this.$router.push(\"/page/home\");\r\n    },\r\n    cancel() {\r\n      this.$Message.info(\"点击了取消\");\r\n    },\r\n    emailOk(email) {\r\n      this.$refs[email].validate(valid => {\r\n        if (valid) {\r\n          this.axios({\r\n            method: \"post\",\r\n            url: \"/email\",\r\n            data: this.email\r\n          })\r\n            .then(\r\n              function(response) {\r\n                this.$Message.info(\"发送成功\");\r\n              }.bind(this)\r\n            )\r\n            .catch(function(error) {\r\n              alert(error);\r\n            });\r\n          this.emailModal = false;\r\n        } else {\r\n          this.$Message.error(\"表单验证失败!\");\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n            this.$nextTick(() => {\r\n              this.loading = true;\r\n            });\r\n          }, 1000);\r\n        }\r\n      });\r\n    },\r\n    /*登录*/\r\n    login(code, state) {\r\n      if (code != null && code != \"\" && state != null && state != \"\") {\r\n        this.$Spin.show({\r\n          render: h => {\r\n            return h(\"div\", [\r\n              h(\"Icon\", {\r\n                style: {\r\n                  animation: \"ani-demo-spin 1s linear infinite\"\r\n                },\r\n                props: {\r\n                  type: \"load-c\",\r\n                  size: 18\r\n                }\r\n              }),\r\n              h(\"div\", \"正在登录，请等待...\")\r\n            ]);\r\n          }\r\n        });\r\n        setTimeout(() => {\r\n          this.$Spin.hide();\r\n        }, 10000);\r\n        if (state == \"github\") {\r\n          this.githubLogin(code);\r\n        } else if (state == \"qq\") {\r\n          this.qqLogin(code);\r\n        } else {\r\n          this.$router.push({ path: \"/\" });\r\n          location.reload();\r\n        }\r\n      } else {\r\n        this.userGet();\r\n      }\r\n    },\r\n    /*github登录*/\r\n    githubLogin(code) {\r\n      this.axios({\r\n        method: \"post\",\r\n        url: \"/authentication/github\",\r\n        params: {\r\n          code: code\r\n        },\r\n        auth: {\r\n          username: \"client\",\r\n          password: \"secret\"\r\n        }\r\n      })\r\n        .then(\r\n          function(response) {\r\n            localStorage.setItem(\r\n              \"currentUser_token\",\r\n              response.data.access_token\r\n            );\r\n            localStorage.setItem(\r\n              \"currentUser_refresh_token\",\r\n              response.data.refresh_token\r\n            );\r\n            this.axios.defaults.headers.common[\"Authorization\"] =\r\n              \"bearer \" + localStorage.getItem(\"currentUser_token\");\r\n            this.$router.push({ path: \"/\" });\r\n            location.reload();\r\n          }.bind(this)\r\n        )\r\n        .catch(\r\n          function(error) {\r\n            this.$Message.error(\"登陆失败\");\r\n          }.bind(this)\r\n        );\r\n    },\r\n    /*qq登录*/\r\n    qqLogin(code) {\r\n      this.axios({\r\n        method: \"post\",\r\n        url: \"/authentication/qq\",\r\n        params: {\r\n          code: code\r\n        },\r\n        auth: {\r\n          username: \"client\",\r\n          password: \"secret\"\r\n        }\r\n      })\r\n        .then(\r\n          function(response) {\r\n            localStorage.setItem(\r\n              \"currentUser_token\",\r\n              response.data.access_token\r\n            );\r\n            localStorage.setItem(\r\n              \"currentUser_refresh_token\",\r\n              response.data.refresh_token\r\n            );\r\n            this.axios.defaults.headers.common[\"Authorization\"] =\r\n              \"bearer \" + localStorage.getItem(\"currentUser_token\");\r\n            this.$router.push({ path: \"/qq\" });\r\n            this.$router.push({ path: \"/\" });\r\n            location.reload();\r\n          }.bind(this)\r\n        )\r\n        .catch(\r\n          function(error) {\r\n            this.$Message.error(\"登陆失败\");\r\n          }.bind(this)\r\n        );\r\n    },\r\n\r\n    toMessages() {\r\n      console.log(\"to messages page\");\r\n      this.$router.push({ path: \"/page/messages\" });\r\n    }\r\n  }\r\n};\r\n</script>\r\n"],"sourceRoot":"src/views/template"}]}