(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cd57aa8"],{"72b0":function(e,t,i){"use strict";var s=i("cc81"),a=i.n(s);a.a},cc81:function(e,t,i){},e7ed:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{margin:"20px"}},[i("div",[i("Row",{staticStyle:{"margin-bottom":"25px"}},[i("Col",{attrs:{span:"8"}},[e._v("用户名：\n\t\t\t"),i("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入..."},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),i("Col",{attrs:{span:"8"}},[i("Button",{attrs:{type:"primary",shape:"circle",icon:"ios-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")])],1)],1)],1),i("div",[i("ul",{staticStyle:{"list-style-type":"none"}},[i("li",[i("Button",{staticClass:"operation-button",attrs:{type:"success",icon:"md-build"},on:{click:function(t){return e.openNewModal()}}},[e._v("新增")]),i("Button",{staticClass:"operation-button",staticStyle:{"margin-left":"0.9375rem"},attrs:{type:"warning",icon:"md-build"},on:{click:function(t){return e.openModifyModal()}}},[e._v("修改")]),i("Button",{staticStyle:{"margin-left":"0.9375rem"},attrs:{type:"error",icon:"md-trash"},on:{click:function(t){return e.del()}}},[e._v("删除")])],1),i("li",[i("div",{staticStyle:{padding:"10px 0"}},[i("Table",{attrs:{border:"",columns:e.columns1,data:e.data1,height:400},on:{"on-selection-change":function(t){e.change(t)},"on-row-dblclick":function(t){e.dblclick(t)}}})],1)]),i("li",[i("div",{staticStyle:{"text-align":"right"}},[i("Page",{attrs:{total:e.total,"page-size":e.pageInfo.pageSize,"show-elevator":"","show-total":""},on:{"on-change":function(t){e.pageSearch(t)}}})],1)])])]),i("Modal",{attrs:{"mask-closable":!1,visible:e.newModal,width:"600",title:"新建"},on:{"update:visible":function(t){e.newModal=t}},model:{value:e.newModal,callback:function(t){e.newModal=t},expression:"newModal"}},[i("Form",{attrs:{"label-width":80}},[i("Row",[i("Col",{attrs:{span:"12"}},[i("Form-item",{attrs:{label:"用户名:"}},[i("Input",{staticStyle:{width:"204px"},model:{value:e.userNew.name,callback:function(t){e.$set(e.userNew,"name","string"===typeof t?t.trim():t)},expression:"userNew.name"}})],1)],1)],1),i("Row",[i("Col",{attrs:{span:"12"}},[i("Form-item",{attrs:{label:"密码:"}},[i("Input",{staticStyle:{width:"204px"},attrs:{placeholder:"请牢记密码"},model:{value:e.userNew.password,callback:function(t){e.$set(e.userNew,"password","string"===typeof t?t.trim():t)},expression:"userNew.password"}})],1)],1)],1),i("Row",[i("Col",{attrs:{span:"12"}},[i("Form-item",{attrs:{label:"邮箱:"}},[i("Input",{staticStyle:{width:"204px"},attrs:{type:"email"},model:{value:e.userNew.email,callback:function(t){e.$set(e.userNew,"email","string"===typeof t?t.trim():t)},expression:"userNew.email"}})],1)],1)],1),i("Row",{staticStyle:{display:"none"}},[i("Col",{attrs:{span:"12"}},[i("Form-item",{attrs:{label:"用户类型:"}},[i("Select",{staticStyle:{width:"200px"},model:{value:e.userNew.usertype,callback:function(t){e.$set(e.userNew,"usertype",t)},expression:"userNew.usertype"}},[i("Option",{attrs:{value:0}},[e._v("普通用户")]),i("Option",{attrs:{value:1}},[e._v("管理员")])],1)],1)],1)],1)],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"text",size:"large"},on:{click:function(t){return e.cancel()}}},[e._v("取消")]),i("Button",{attrs:{type:"primary",size:"large"},on:{click:function(t){return e.newOk()}}},[e._v("确定")])],1)],1),i("Modal",{attrs:{"mask-closable":!1,visible:e.modifyModal,width:"600",title:"修改"},on:{"update:visible":function(t){e.modifyModal=t},"on-ok":function(t){return e.modifyOk()},"on-cancel":function(t){return e.cancel()}},model:{value:e.modifyModal,callback:function(t){e.modifyModal=t},expression:"modifyModal"}},[i("Form",{attrs:{"label-width":80}},[i("Row",[i("Col",{attrs:{span:"12"}},[i("Form-item",{attrs:{label:"登录名:"}},[i("Input",{staticStyle:{width:"204px"},attrs:{disabled:"disabled"},model:{value:e.userModify.name,callback:function(t){e.$set(e.userModify,"name",t)},expression:"userModify.name"}})],1)],1)],1),i("Row",[i("Col",{attrs:{span:"12"}},[i("Form-item",{attrs:{label:"用户类型:"}},[i("Select",{staticStyle:{width:"200px"},model:{value:e.userModify.usertype,callback:function(t){e.$set(e.userModify,"usertype",t)},expression:"userModify.usertype"}},[i("Option",{attrs:{value:0}},[e._v("普通用户")]),i("Option",{attrs:{value:1}},[e._v("管理员")])],1)],1)],1)],1)],1)],1),i("Modal",{attrs:{width:"500",title:"角色配置"},on:{"on-ok":function(t){return e.roleOk()},"on-cancel":function(t){return e.cancel()}},model:{value:e.roleModal,callback:function(t){e.roleModal=t},expression:"roleModal"}},[i("div",[i("Table",{attrs:{border:"",columns:e.columns2,data:e.data2,height:260},on:{"on-selection-change":function(t){e.change2(t)}}})],1)])],1)},a=[],n={data:function(){var e=this;return{name:null,count:null,groupId:null,newModal:!1,modifyModal:!1,roleModal:!1,total:0,loading:!0,pageInfo:{page:0,pageSize:10},user:{id:null,name:null,loginName:null,password:null,passwordAgain:null,email:null},userNew:{id:null,name:null,loginName:null,password:null,passwordAgain:null,email:null,usertype:0},userModify:{id:null,name:null,usertype:null},ruleNew:{name:[{type:"string",required:!0,message:"输入用户名",trigger:"blur"}],loginName:[{type:"string",required:!0,message:"输入登录名",trigger:"blur"}],password:[{type:"string",required:!0,message:"输入密码",trigger:"blur"}],passwordAgain:[{type:"string",required:!0,message:"输入再次密码",trigger:"blur"}],email:[{required:!0,message:"输入邮箱",trigger:"blur"},{type:"email",message:"输入正确的邮箱格式",trigger:"blur"}]},ruleModify:{name:[{type:"string",required:!0,message:"输入用户名",trigger:"blur"}],password:[{type:"string",required:!0,message:"输入密码",trigger:"blur"}],email:[{required:!0,message:"输入邮箱",trigger:"blur"},{type:"email",message:"输入正确的邮箱格式",trigger:"blur"}]},columns1:[{type:"selection",width:60,align:"center"},{title:"用户名",key:"name"},{title:"邮箱",key:"email"},{title:"用户类型",align:"center",key:"usertype",render:function(e,t){return 0==t.row.usertype?e("div",[e("strong",null,"普通用户")]):1==t.row.usertype?e("div",[e("strong",null,"管理员")]):void 0}},{title:"注册时间",align:"center",key:"createTime"},{title:"操作",align:"center",key:"action",render:function(t,i){return t("div",[t("Button",{props:{type:"info"},on:{click:function(){e.relationSet(i.row)}}},"配置角色")])}}],data1:[],columns2:[{type:"selection",width:60,align:"center"},{title:"角色名称",width:120,key:"name"},{title:"描述",key:"describe"}],data2:[],data2Temp:[],relationList:null}},mounted:function(){this.getTable({pageInfo:this.pageInfo,name:this.name}),this.axios({method:"get",url:"/roles/all"}).then(function(e){this.data2Temp=e.data.data}.bind(this)).catch((function(e){alert(e)}))},methods:{initPageInfo:function(){this.pageInfo.page=0,this.pageInfo.pageSize=10},initUser:function(){this.user.id=null,this.user.name=null,this.user.loginName=null,this.user.password=null,this.user.email=null},initUserNew:function(){this.userNew.id=null,this.userNew.name=null,this.userNew.loginName=null,this.userNew.password=null,this.userNew.passwordAgain=null,this.userNew.email=null},initUserModify:function(){this.userModify.id=null,this.userModify.name=null,this.userModify.loginName=null,this.userModify.password=null,this.userModify.email=null},userSet:function(e){this.user.id=e.id,this.user.name=e.name,this.user.loginName=e.loginName,this.user.password=e.password,this.user.email=e.email,this.user.usertype=e.usertype,this.user.createTime=e.createTime},userNewSet:function(e){this.userNew.id=e.id,this.userNew.name=e.name,this.userNew.loginName=e.loginName,this.userNew.password=e.password,this.userNew.passwordAgain=e.password,this.userNew.email=e.email},userModifySet:function(e){this.userModify.id=e.id,this.userModify.name=e.name,this.userModify.usertype=e.usertype},dateGet:function(e){var t=new Date(parseInt(e));return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()},listDateSet:function(e){for(var t=e.length-1;t>=0;t--)e[t].createTime=this.dateGet(e[t].createTime)},getTable:function(e){this.axios({method:"get",url:"/users",params:{page:e.pageInfo.page,pageSize:e.pageInfo.pageSize,name:e.name}}).then(function(e){this.data1=e.data.data.data,this.listDateSet(this.data1),this.total=e.data.data.totalCount}.bind(this)).catch((function(e){console.log(e)}))},search:function(){this.initPageInfo(),this.getTable({pageInfo:this.pageInfo,name:this.name})},pageSearch:function(e){this.pageInfo.page=e-1,this.getTable({pageInfo:this.pageInfo,name:this.name})},openNewModal:function(){this.newModal=!0,this.initUserNew(),this.data1.sort(),this.count=0,this.groupId=null},newOk:function(){""!=this.userNew.name&&null!=this.userNew.name?""!=this.userNew.password&&null!=this.userNew.password?(this.userNew.loginName=this.userNew.name,this.userNew.createTime=(new Date).getTime(),console.log("====="+JSON.stringify(this.userNew)),this.userSet(this.userNew),this.axios({method:"post",url:"/users/user",data:this.user}).then(function(e){console.log(JSON.stringify(e)),"2000"==e.data.status?(this.initUserNew(),this.getTable({pageInfo:this.pageInfo,name:this.name}),this.newModal=!1,this.$Message.info("新建成功")):this.$Modal.error({title:"提示",content:"创建用户失败"})}.bind(this)).catch((function(e){alert(e)}))):this.$Message.warning("请输入密码"):this.$Message.warning("请输入用户名")},openModifyModal:function(){this.count>1||this.count<1?(this.modifyModal=!1,this.$Message.warning("请至少选择一项(且只能选择一项)")):this.modifyModal=!0},modifyOk:function(){this.axios({method:"put",url:"/users/user",data:{name:this.userModify.name,usertype:this.userModify.usertype,id:this.userModify.id}}).then(function(e){this.initUserNew(),this.getTable({pageInfo:this.pageInfo,name:this.name}),this.$Message.info("修改成功")}.bind(this)).catch((function(e){alert(e)})),this.modifyModal=!1},cancel:function(){this.newModal=!1,this.modifyModal=!1},change:function(e){1==e.length&&this.userModifySet(e["0"]),this.setGroupId(e)},setGroupId:function(e){this.groupId=[],this.count=e.length;for(var t=0;t<=e.length-1;t++)this.groupId.push(e[t].id)},del:function(){null!=this.groupId&&""!=this.groupId&&this.axios({method:"delete",url:"/users",data:this.groupId}).then(function(e){this.getTable({pageInfo:this.pageInfo,name:this.name}),this.groupId=null,this.count=0,this.$Message.info("删除成功")}.bind(this)).catch((function(e){alert(e)}))},dblclick:function(e){this.userModifySet(e),this.modifyModal=!0,this.data1.sort()},relationSet:function(e){this.roleModal=!0,this.data2=[],this.axios({method:"get",url:"/relations/"+e.id}).then(function(t){var i=[];for(var s in t.data.data)i.push(t.data.data[s].roleId);for(var s in this.data2Temp)-1==i.indexOf(this.data2Temp[s].id)?this.data2.push({id:this.data2Temp[s].id,name:this.data2Temp[s].name,describe:this.data2Temp[s].describe,userId:e.id,_checked:!1}):this.data2.push({id:this.data2Temp[s].id,name:this.data2Temp[s].name,describe:this.data2Temp[s].describe,userId:e.id,_checked:!0})}.bind(this)).catch((function(e){alert(e)}))},roleOk:function(){null!=this.relationList&&(this.axios({method:"post",url:"/relations",data:this.relationList}).then(function(e){this.$Message.info("配置成功")}.bind(this)).catch((function(e){alert(e)})),this.relationList=null)},change2:function(e){for(var t in this.relationList=[],0==e.length&&this.relationList.push({userId:this.data2[0].userId}),e)this.relationList.push({userId:e[t].userId,roleId:e[t].id})}}},o=n,r=(i("72b0"),i("2877")),l=Object(r["a"])(o,s,a,!1,null,"868e9644",null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-5cd57aa8.629c7339.js.map